---
title: "开发与使用手册"
date: "2026-01-14"
description: "本博客系统的详细介绍"
tags: ["React", "Next.js"]
status: "published" # published | draft
---

# 个人博客与交互实验室 · 开发与使用手册

**项目名**：personal-blog\
**版本**：v2.0\
**适用对象**：开发者 / 内容创作者 / 未来维护者\
**核心架构**：Next.js App Router + TypeScript + Tailwind CSS +
NextAuth + GitHub API + Vercel\
**更新机制**：GitHub 写入 → 自动部署（无数据库架构）

------------------------------------------------------------------------

## 一、项目设计目标

本项目并非传统博客，而是一个 **以 GitHub
为唯一数据源的个人创作系统**，支持：

-   📘 Markdown 驱动的技术文章（Notes）
-   🧪 React 驱动的交互实验（Labs）
-   🛠 带权限的 Admin 内容生产后台
-   🚀 无数据库、零运维、可版本回溯的发布链路

设计核心原则：

-   **内容即代码**
-   **Git 即数据库**
-   **Registry 控制可见性**
-   **部署即发布**

------------------------------------------------------------------------

## 二、目录结构总览

    personal-blog/
    ├─ app/                    # Next.js App Router（页面与 API）
    │  ├─ page.tsx             # 首页
    │  ├─ notes/               # Notes 页面
    │  ├─ labs/                # Labs 页面
    │  ├─ admin/               # 管理后台
    │  └─ api/                 # API Route Handlers
    │
    ├─ content/                # Markdown 内容库
    │  ├─ notes/               # 博客文章
    │  └─ labs/                # Labs 文档说明
    │
    ├─ labs/                   # Labs React 代码库
    │  ├─ _registry.ts         # 实验注册表（核心）
    │  └─ [slug]/index.tsx     # 单个 Lab 的 React 组件
    │
    ├─ components/             # 通用 UI 组件
    ├─ lib/                    # 工具库（Auth / GitHub 等）
    └─ public/                 # 静态资源

------------------------------------------------------------------------

## 三、Notes（标准笔记）使用指南

### 3.1 Notes 的定位

Notes 用于：

-   技术文章
-   学习笔记
-   经验总结
-   理论性 / 阅读型内容

它是 **阅读优先** 的内容形态。

------------------------------------------------------------------------

### 3.2 文件位置

所有笔记必须放在：

    content/notes/

-   支持多级子目录
-   目录结构会映射为 URL 与标签

示例：

    content/notes/ai/llm.md
    → /notes/ai/llm

------------------------------------------------------------------------

### 3.3 Frontmatter 规范（必填）

``` yaml
---
title: "文章标题"
date: "2026-01-14"
description: "一句话摘要，用于列表与 SEO"
tags: ["React", "Next.js"]
status: "published" # published | draft
---
```

-   `draft` 状态不会出现在前台
-   日期格式必须为 `YYYY-MM-DD`

------------------------------------------------------------------------

### 3.4 Markdown 增强支持

#### 数学公式（LaTeX）

-   行内：$E = mc^2$
-   块级：

    $$
    \sum_{i=0}^n i^2 = \frac{(n^2+n)(2n+1)}{6}
    $$

#### Obsidian Callout

> [!info]
> 提示内容

> [!warning]
> 注意事项

#### 图片

推荐使用标准 Markdown：

``` md
![alt](/images/example.png)
```

------------------------------------------------------------------------

## 四、Labs（交互实验）系统【重点】

### 4.1 Labs 的核心定位

Labs 是本项目的核心特色，用于：

-   算法与数据结构可视化
-   交互式工具
-   原型验证
-   沉浸式前端应用

Labs = **React 组件 +（可选）Markdown 文档**


### 4.2 Labs 的三件套

| 文件                       | 是否必须 | 作用       |
| ------------------------ | ---- | -------- |
| labs/\_registry.ts       | 必须   | 注册与元数据   |
| labs/\[slug\]/index.tsx  | 必须   | React 组件 |
| content/labs/\[slug\].md | 可选   | 文档说明     |

## 五、LAB 代码开发规范与注意事项（详细）

### 5.1 路径与加载机制（硬性）

-   Lab 组件路径 **必须是**：

```{=html}
<!-- -->
```
    labs/<slug>/index.tsx

-   前台通过动态导入：

``` ts
dynamic(() => import(`@/labs/${slug}/index`), { ssr: false })
```

路径或导出错误将导致 **Component not found**。

------------------------------------------------------------------------

### 5.2 导出与 Client Component 规范（硬性）

#### 必须是默认导出

``` tsx
export default function MyLab() {}
```

#### 必须包含 Client 指令

``` tsx
"use client";
```

原因：

-   Labs 全部运行在浏览器端
-   依赖 hooks / DOM / 交互
-   不支持 Server Component

------------------------------------------------------------------------

### 5.3 混合模式 vs 全屏模式

#### 混合模式（默认）

-   组件在舞台区域展示
-   下方渲染 Markdown 文档

推荐结构：

``` tsx
<div className="w-full flex justify-center">
  <div className="max-w-3xl w-full">
    {/* UI */}
  </div>
</div>
```

#### 全屏模式（fullScreen: true）

-   注册表中设置 `fullScreen: true`
-   组件根节点必须 `w-full h-full`

``` tsx
<div className="w-full h-full">
  {/* App */}
</div>
```

常见错误：

-   只给内部元素 `h-full`
-   使用 `min-h-screen` 破坏舞台布局

------------------------------------------------------------------------

### 5.4 代码风格与工程约定

-   TypeScript 优先，避免 `any`
-   组件使用 PascalCase
-   hooks 使用 `useXxx`
-   Tailwind 使用 neutral 系列
-   dark 模式必须同步支持

------------------------------------------------------------------------

### 5.5 禁止事项（非常重要）

Labs 组件 **禁止引入**：

-   fs / path
-   process / server-only
-   后端私密 token

否则会导致 build 或运行失败。

------------------------------------------------------------------------

### 5.6 浏览器 API 使用建议

-   window / document / localStorage
-   建议放在 `useEffect` 中
-   避免首次渲染不一致

------------------------------------------------------------------------

### 5.7 性能与体积建议

-   重型库建议懒加载
-   使用 `useMemo` / `useCallback`
-   避免首屏阻塞计算

------------------------------------------------------------------------

### 5.8 发布前自检清单

-   [ ] labs/`<slug>`{=html}/index.tsx 存在
-   [ ] 文件顶部包含 `"use client";`
-   [ ] 默认导出组件
-   [ ] 全屏模式使用 `w-full h-full`
-   [ ] 未引入 server-only 模块
-   [ ] 无敏感信息
-   [ ] `npm run build` 通过

------------------------------------------------------------------------

### 5.9 最小模板

#### 混合模式

``` tsx
"use client";

export default function Lab() {
  return (
    <div className="w-full flex justify-center">
      <div className="max-w-3xl w-full p-6 border rounded-xl">
        Hello Lab
      </div>
    </div>
  );
}
```

#### 全屏模式

``` tsx
"use client";

export default function Lab() {
  return (
    <div className="w-full h-full p-6">
      Full Screen Lab
    </div>
  );
}
```

------------------------------------------------------------------------

## 六、Admin 管理后台

### 6.1 权限模型

-   NextAuth + GitHub OAuth
-   登录后校验 GitHub 用户名
-   未授权用户无法访问 `/admin/*`

------------------------------------------------------------------------

### 6.2 Labs 发布流程

1.  访问 `/admin/labs`
2.  填写元信息（title / slug / tags）
3.  选择模式（混合 / 全屏）
4.  编写组件代码（默认空）
5.  可选填写 Markdown 文档
6.  发布 → GitHub Commit → Vercel 自动部署

------------------------------------------------------------------------

## 七、GitHub 写入与部署机制

-   所有发布通过 GitHub API 写入仓库
-   每次发布对应一次 commit
-   Vercel 自动监听并重新部署
-   无数据库、天然版本控制

------------------------------------------------------------------------

## 八、环境变量（Vercel）

``` env
NEXTAUTH_SECRET=xxxx
GITHUB_CLIENT_ID=xxxx
GITHUB_CLIENT_SECRET=xxxx
ADMIN_GITHUB_USER=你的GitHub用户名

GITHUB_ACCESS_TOKEN=xxxx
GITHUB_REPO_OWNER=ERICPAULQWE
GITHUB_REPO_NAME=personal-blog
GITHUB_BRANCH=main
```

------------------------------------------------------------------------

## 九、设计理念总结

-   内容即代码
-   Git 即数据库
-   Admin 是内容生产工具
-   Labs 是长期演进的实验平台

------------------------------------------------------------------------
