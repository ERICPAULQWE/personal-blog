### 模拟信号数字编码的基本概念
**定义**：将模拟信号转变为某种二进制数字码组的过程。
**主要过程**：
1.  **抽样 (Sampling)**：把连续时间模拟信号转换成时间离散、幅度连续的抽样信号。
2.  **量化 (Quantization)**：把时间离散、幅度连续的抽样信号转换成时间离散、幅度也离散的数字信号。
3.  **编码 (Coding)**：将量化后的信号（离散幅度值）映射成一个特定的二进制码组。

---

# 3.1 抽样定理 (Sampling Theorem)

### 模拟信号的抽样过程
抽样是通过原始模拟信号 $x(t)$ 与一个周期性的抽样脉冲序列 $s_p(t)$ 相乘，得到抽样后信号 $x_s(t)$。
$$
x_s(t) = x(t) \cdot s_p(t) = x(t) \sum_{n=-\infty}^{+\infty} p_T(t-nT_s)
$$
![[Screenshot_20251011_142035.jpg|450]]
[image:模拟信号抽样过程框图 页码:6]

### 低通信号的理想抽样
理想抽样使用狄拉克δ函数（冲激）序列作为抽样脉冲。抽样后信号的时域表达式为：
$$
x_s(t) = \sum_{n=-\infty}^{\infty}x(nT_s)\delta(t-nT_s)
$$
其频域表达式为原始信号频谱的周期性延拓：
$$
X_s(\omega) = \frac{1}{T_s}\sum_{k=-\infty}^{\infty}X(\omega-k\omega_s)
$$
![[Screenshot_20251011_142224.jpg|400]]
[image:理想抽样过程的时域与频域示意图 页码:9]

- **频域表达式推导**
    - 1.  抽样过程在频域上表现为原始信号频谱 $X(\omega)$ 与抽样脉冲序列频谱 $S_\delta(\omega)$ 的卷积。
        $$
        X_s(\omega) = \frac{1}{2\pi}[X(\omega) * S_\delta(\omega)]
        $$
    - 2.  理想冲激序列 $s_\delta(t) = \sum_{n=-\infty}^{\infty}\delta(t-nT_s)$ 的傅里叶变换为：
        $$
        S_\delta(\omega) = \omega_s \sum_{k=-\infty}^{\infty}\delta(\omega-k\omega_s) \quad (\text{其中 } \omega_s = 2\pi/T_s)
        $$
    - 3.  将 $S_\delta(\omega)$ 代入卷积公式，并利用冲激函数的卷积性质，得到最终结果：
        $$
        X_s(\omega) = \frac{\omega_s}{2\pi}\sum_{k=-\infty}^{\infty}X(\omega-k\omega_s) = \frac{1}{T_s}\sum_{k=-\infty}^{\infty}X(\omega-k\omega_s)
        $$

### 低通采样定理 (Nyquist-Shannon Theorem)
**定理内容**：若一个频带被限制在 $f_M$ 赫兹内的信号，以大于等于 $2f_M$ 的频率 $f_s$ 进行等间隔抽样，则该信号可以由其采样值唯一确定。
$$
f_s \ge 2f_M \quad \text{或} \quad T_s \le \frac{1}{2f_M}
$$
**奈奎斯特频率**：最低的无失真抽样频率 $f_s = 2f_M$。

### 频谱混叠 (Aliasing)
**定义**：当抽样频率不满足采样定理，即 $f_s < 2f_M$ 时，抽样信号频谱中周期性延拓的各频谱分量会发生重叠，导致高频部分被误认为低频部分，这种现象称为混叠失真。
[image:频谱无混叠与混叠的对比图 页码:13]
发生混叠后，原始信号将无法通过低通滤波器无失真地恢复。

**避免方法**：在抽样前，让信号先通过一个**抗混叠滤波器**（低通滤波器），滤除高于 $f_s/2$ 的频率成分。

### 信号重建 (Signal Reconstruction)
当满足抽样定理 ($f_s \ge 2f_M$) 时，可以通过一个理想低通滤波器从抽样信号 $x_s(t)$ 中无失真地恢复原始信号 $x(t)$。时域上的重建公式为：
$$
x(t) = \sum_{k=-\infty}^{\infty}x(kT_s) \cdot \frac{\omega_H}{\pi} \text{sinc}(\omega_H(t-kT_s))
$$
![[Screenshot_20251011_142501.jpg|400]]
[image:信号时域重建示意图 页码:17]

- **重建公式推导**
    - 1.  在频域中，用一个理想低通滤波器 $F_L(\omega)$ 乘以抽样信号的频谱 $X_s(\omega)$，即可得到原始频谱 $X(\omega)$。
    - 2.  该操作在时域上等价于时域信号的卷积：$x(t) = \mathfrak{F}^{-1}\{F_L(\omega)\} * x_s(t)$。
    - 3.  理想低通滤波器的时域冲激响应是一个sinc函数。
    - 4.  将 $x_s(t) = \sum_{k=-\infty}^{\infty}x(kT_s)\delta(t-kT_s)$ 代入卷积，利用卷积性质得到最终的内插公式。

### 带通信号的抽样定理
**目的**：对于中心频率很高的带通信号，使用带通抽样定理可以大大降低抽样率，避免使用极高频率的器件。
**定理**：对于带宽为 $B=f_H-f_L$ 的带通信号，其最小无混叠抽样频率 $f_s$ 的取值范围被限定在 $2B \sim 4B$ 之间。一个可行的最小抽样频率 $f_s$ 为：
$$
f_s = 2B\left(1 + \frac{M}{N}\right)
$$
其中 $N = \lfloor f_H/B \rfloor$(向下取整)，$M = f_H/B - N$。

- **定理证明**
    - 1.  抽样后信号频谱为 $X_S(f) = (1/T_S)\sum_{n}X_B(f-nf_S)$。
    - 2.  为避免混叠，各频谱分量 $X_B(f-nf_S)$ 不能重叠。观察频谱图，不发生混叠需要满足：
        - $N f_s \ge 2 f_H$
        - $(N-1)f_s + B < 2f_H - B$
        - ![[Screenshot_20251011_144750.jpg|350]]
        - [image:带通抽样频谱不混叠条件示意图 页码:21]
    - 3.  取满足第一个条件的最小值 $f_s = 2f_H/N = 2(B+MB/N)$。
    - 4.  将此 $f_s$ 代入第二个条件验证，可证明该条件成立，因此该 $f_s$ 是一个有效的无失真抽样频率。

---

# 3.2 模拟信号的量化 (Quantization)

### 量化基本概念
**定义**：将抽样后信号的无限多种可能取值的连续幅度，变换成只有有限种取值的离散数字信号的过程。量化本质上是一种有损的、不可逆的压缩过程。

**标量量化**：对抽样序列的每个样值独立地进行量化操作。
- **均匀量化**：所有量化阶距 $\Delta_k$ 均为常数。
- **非均匀量化**：量化阶距随输入信号幅度变化，通常小信号区域阶距小，大信号区域阶距大。

### 量化噪声与信噪比
**量化噪声**：量化误差的统计平均功率，其公式为：
$$
\sigma_q^2 = E[(x-Q(x))^2] = \sum_{k=1}^{M}\int_{x_{k-1}}^{x_{k}}(y_{k}-x)^{2}p_{x}(x)dx
$$
$y_k$为量化电平，$x$为实际值
**量化信噪比 (SNRq)**：信号的平均功率 $S_x$ 与总的量化噪声功率的比值。
$$
SNR_q = \frac{S_x}{\sigma_q^2 + \sigma_o^2}
$$
其中 $\sigma_o^2$ 是过载噪声功率。

### 均匀量化分析
**量化阶距**：量化阶距是一个常数 $\Delta_k=x_k-x_{k-1}=\Delta,\quad k=1,2,3,\dots,M$ $M$为量化电平数
	若$x_{min}=-V_p\le x\le x_{max}=+V_p$
	则有$$\Delta=\frac{V_p-(-V_p)}{M}=\frac{2V_p}{M}=\frac{2V_p}{2^N},\,N为量化比特数$$
**量化电平**：一般取 $y_k=\frac{x_k-x_{k-1}}{2},\quad k=1,2,3,\dots$
**量化噪声**：当M足够大且无过载时，均匀量化的噪声功率为：
	$$
\sigma_q^2 =\sum_{k=1}^M \int_{x_{k-1}}^{x_k}(y_k-x)^2p_x(x)dx \approx \sum_{k=1}^M p_x(y_k)\int_{x_k-1}^{x_k}(y_k-x)^2dx \approx \frac{\Delta^2}{12}
$$
$$\sigma_q^2\approx\frac{\Delta^2}{12}=\frac{1}{12}\left(\frac{2V_p}{M}\right)^2=\frac{1}{12}\left(\frac{2V_p}{2^N}\right)^2=\frac{1}{12}(2V_p)^22^{-2N}$$
	可见量化噪声的大小仅与量化阶距有关
- 公式详细推导过程
	这个推导基于两个核心假设：
	 - **量化阶距** ($\Delta$) **足够小**：这意味着量化电平数 $M$ 足够大。 
	 - **量化区间内信号概率密度函数** ($p_x(x)$) **近似为常数**：在任一量化区间 $[x_{k-1}, x_k]$ 内，$p_x(x) \approx p_x(y_k)$，其中 $y_k$ 是该区间的量化电平。
	推导步骤
	- **第一步：基础公式与近似**：量化噪声功率的定义是噪声误差的均方值，其求和形式如下：
    $$
    \sigma_q^2 = \sum_{k=1}^M \int_{x_{k-1}}^{x_k}(y_k-x)^2p_x(x)dx
    $$
    基于**假设2**，我们将 $p_x(x)$ 视为常数 $p_x(y_k)$ 并从积分中提取：
    $$
    \sigma_q^2 \approx \sum_{k=1}^M p_x(y_k)\int_{x_{k-1}}^{x_k}(y_k-x)^2dx
    $$
	- **第二步：计算积分部分**：我们关注每个区间的积分项 $\int_{x_{k-1}}^{x_k}(y_k-x)^2dx$。
	进行变量替换：令 $u = y_k-x$。则 $du = -dx$。
    - 当 $x = x_{k-1}$ 时，$u = \frac{\Delta}{2}$。
    - 当 $x = x_{k}$ 时，$u = -\frac{\Delta}{2}$。
    代入积分：
    $$
    \int_{x_{k-1}}^{x_k}(y_k-x)^2dx = \int_{\Delta/2}^{-\Delta/2} u^2(-du) = \int_{-\Delta/2}^{\Delta/2} u^2du
    $$
    这是一个简单的定积分，结果为：
    $$
    \left[ \frac{u^3}{3} \right]_{-\Delta/2}^{\Delta/2} = \frac{(\Delta/2)^3}{3} - \frac{(-\Delta/2)^3}{3} = \frac{\Delta^3}{12}
    $$
	- **第三步：将积分结果代回求和**：将上一步得到的 $\frac{\Delta^3}{12}$ 代入到 $\sigma_q^2$ 的近似公式中。由于 $\Delta$ 是常数，可以提到求和符号外面：
    $$
    \sigma_q^2 \approx \frac{\Delta^3}{12} \sum_{k=1}^M p_x(y_k)
    $$
	- **第四步：利用概率密度函数的性质**：信号的概率密度函数在整个定义域上的积分必须等于1：$\int_{-\infty}^{\infty}p_x(x)dx = 1$。
    当 $\Delta$ 足够小时，求和可以近似于积分：
    $$
    \int_{x_{min}}^{x_{max}} p_x(x)dx \approx \sum_{k=1}^M p_x(y_k)\Delta \approx 1
    $$
    由此我们可以得到：
    $$
    \sum_{k=1}^M p_x(y_k) \approx \frac{1}{\Delta}
    $$
	- **第五步：最终结果**：将 $\sum_{k=1}^M p_x(y_k)$ 的近似值 $\frac{1}{\Delta}$ 代入第三步的公式：
    $$
    \sigma_q^2 \approx \frac{\Delta^3}{12} \cdot \frac{1}{\Delta} = \frac{\Delta^2}{12}
    $$
    至此，我们就得到了均匀量化噪声功率的常用近似公式。它直观地告诉我们，量化阶距 $\Delta$ 越小，量化噪声就越低。
**量化信噪比**：$SNR_{q,dB}=10\lg{\frac{S_x}{\sigma_q^2}}=10\lg{2^{2N}}\approx6.02N(dB)$
	**6dB法则**：这表明，量化比特数每增加1位，量化信噪比提升约6dB。
- 6dB法则推导
    - 1.  对于动态范围为 $[-V_p, V_p]$ 的信号，均匀量化阶距 $\Delta = \frac{2V_p}{M} = \frac{2V_p}{2^N}$。
    - 2.  将 $\Delta$ 代入噪声公式 $\sigma_q^2 \approx \frac{\Delta^2}{12}$，得到 $\sigma_q^2 = \frac{1}{12}\frac{(2V_p)^2}{2^{2N}} = \frac{(V_p)^2}{3 \cdot 2^{2N}}$。
    - 3.  假设信号在 $[-V_p, V_p]$ 范围内均匀分布，其平均功率为 $S_x = \frac{V_p^2}{3}$。
    - 4.  计算信噪比：$SNR_q = \frac{S_x}{\sigma_q^2} = 2^{2N}$。
    - 5.  转换为dB值：$SNR_{q,dB} = 10 \log_{10}(2^{2N}) = 2N \cdot 10 \log_{10}(2) \approx 6.02N \text{ (dB)}$。

### 非均匀量化与压扩 (Companding)
**目的**：改善对小信号量化时的信噪比，使信噪比在很大的信号动态范围内保持相对恒定。
**实现方法**：**压扩 (Companding)**，即先压缩 (Compressing)，再均匀量化，最后在解码端扩张 (Expanding)。
![[Screenshot_20251011_155918.jpg|400]]
[image:压扩变换、均匀量化、扩张变换流程图 页码:46]
**非均匀量化抑制量化噪声的原理**：信号经历了变换和反变换，信号幅度不会受到影响。而量化噪声值只经历过反变换，在小信号区域的噪声受到抑制。
#### 最佳非均匀量化
##### 1. 基本思想

非均匀量化的核心思想是通过一个非线性的压缩变换 $y = C(x)$，将非均匀分布的输入信号 $x$ 转换为近似均匀分布的信号 $y$，然后再对 $y$ 进行均匀量化。 

- **关键关系**: 压缩曲线的斜率 $\frac{dy}{dx}$ 反映了量化区间的疏密程度。
- 在信号幅度小（概率密度大）的区域，斜率较大，对应的输入量化间隔 $\Delta x$ 较小，实现精细量化。
- 在信号幅度大（概率密度小）的区域，斜率较小，对应的输入量化间隔 $\Delta x$ 较大，实现粗略量化。
设量化前的（压缩）变换特性诶：$y=C(x)$，如下图所示
![[Screenshot_20251011_161638.jpg|250]]

数学上，当变换后的量化间隔 $\Delta y = q$ (一个固定的量化阶矩) 时，输入与输出的关系可以表示为：
$$
\frac{dy}{dx} = \dot{C}(x) \approx \frac{\Delta y}{\Delta x} = \frac{q}{\Delta x}
$$
##### 2. 量化噪声功率

对于一个在 $(-V_p, V_p)$ 范围内变化的信号，如上图所示，有：
$$\frac{\Delta Y}{\Delta X}=\frac{dY}{dX}=\dot{C}(X)\quad \Delta X=\frac{\Delta Y}{\dot{C}(X)}$$
变换后的均匀量化间隔数为$L$，当$L \gg1$时，一般地有
$$\sigma_q^2\approx \frac{1}{12}\sum_{k=1}^Lp_X(Y_k){\Delta X}^3\approx\frac{1}{12}\sum_{k=1}^Lp_X(X_k){\Delta X}^3\approx\frac{1}{12}\int_{-V}^{+V}(\Delta X)^2p_X(X)dX
$$
将 $\Delta X = \frac{\Delta Y}{\dot{C}(X)}$ 和变换后均匀量化的间隔 $\Delta Y = q$ 代入上式，可得：
$$
\sigma_{q}^{2} \approx \frac{1}{12}\int_{-V}^{+V}\left(\frac{\Delta Y}{\dot{C}(X)}\right)^2p_X(X)dX= \frac{q^{2}}{12}\int_{-V_p}^{V_p}\frac{p_{X}(X)}{(\dot{C}(X))^{2}}dX
$$
我们的目标是寻找一个最佳的压缩函数 $C(x)$，使得在给定的量化级数下，$\sigma_q^2$ 最小。
##### 3. 最佳压缩变换特性

通过变分法可以求得，能使量化噪声功率最小的最佳压缩变换特性 $f(x)$ 为：
$$
f(x) = \int_{-\infty}^xf'(x)dx=K\int_{-\infty}^{x}(p_{x}(x))^{1/3}dx
$$

其中，常数 $K$ 由信号的峰值电压 $V_p$ 决定：
$$
K = \frac{V_{p}}{\int_{0}^{+V_{p}}(p_{X}(x))^{\frac{1}{3}}dx}
$$
###### 应用实例
1.  **均匀分布信号**:
    如果输入信号 $x$ 服从均匀分布，即 $p_x(x)$ 为常数，那么最佳的量化方式就是**均匀量化**。 此时：$f(x) = x$
2.  **拉普拉斯分布信号 (语音信号)**:
    语音信号的幅度通常近似服从拉普拉斯分布 ，$p_{x}(x)=\frac{1}{\sqrt{2}\sigma_{x}}e^{-\frac{\sqrt{2}|x|}{\sigma_{x}}}$。
    在这种情况下，最佳的变换特性是一个复杂的指数函数。 
##### 4. 实际应用中的问题

尽管最优非均匀量化在理论上很优越，但在实际应用中面临挑战：
* **实现复杂**: 最佳量化特性的实现过程复杂，通常只具有理论指导意义。 
* **概率密度未知**: 在实际应用中，信号的概率密度函数 $p(x)$ 很难精确得知，而且可能是变化的。 
* **方差失配**: 量化器的性能对输入信号的方差 $\sigma_x^2$ 非常敏感。如下图所示，当信号的实际方差偏离量化器设计时所依据的理想值时，量化信噪比 ($SNR_q$) 会急剧下降。 
![[Screenshot_20251011_163611.jpg|150]]
[imge: 方差适配对量化信噪比影响鹅示意图]
#### 最佳量化器 (Lloyd-Max 算法思想)

最佳量化器的设计目标是：在给定输入信号概率密度和量化电平数的条件下，直接寻找一组**最佳分层电平** (决策电平, $x_k$) 和**最佳量化电平** (重建电平, $y_k$)，以使量化噪声的平均功率最小化。 
##### 1. 最佳量化器的必要条件

量化噪声功率为 $\sigma_{q}^{2}=\sum_{k=1}^{M}\int_{x_{k-1}}^{x_{k}}(x-y_{k})^{2}p_{x}(x)dx$。 
为使其最小，必须满足以下两个必要条件：

1.  **最佳分层电平 ($x_{k,opt}$)**: 应该处于相邻两个最佳量化电平的**中点**。 
    $$
    x_{k,opt}=\frac{y_{k,opt}+y_{k+1,opt}}{2}
    $$
2.  **最佳量化电平 ($y_{k,opt}$)**: 应该等于其对应量化区间内信号的概率密度函数的**质心** (重心)。 
    $$
    y_{k,opt}=\frac{\int_{x_{k-1,opt}}^{x_{k,opt}}xp_{X}(x)dx}{\int_{x_{k-1,opt}}^{x_{k,opt}}p_{X}(x)dx}
    $$
这两个条件表明，最佳分层电平和量化电平相互依赖，需要通过迭代算法求解。
##### 2. 大量化级数下的近似

当满足量化级别数 $M >> 1$，且每个量化区间都足够小时，可以进行近似处理。 

* 此时，区间内的概率密度 $p_X(x)$ 可视为常数，**质心**约等于区间的**中点**。 
    $$
    y_{k,opt} \approx \frac{x_{k,opt}+x_{k-1,opt}}{2}
    $$
* 结合上述两个条件，可以推导出：
    $$
    x_{k,opt}-x_{k-1,opt} \approx y_{k+1,opt}-y_{k,opt}
    $$
    这意味着，当 $M$ 很大时，量化间隔和量化电平之间的距离都趋于均匀。因此，在这种情况下，**可以用均匀量化来近似替代复杂的最佳量化器**。
### 对数量化
语音信号服从拉普拉斯分布，大量信号成分集中在小信号区域。
![[Screenshot_20251011_164041.jpg|150]]
[image: 拉普拉斯分布]
对数量化是一种量化信噪比与输入信号幅度大小无关，量化信噪比保持恒定鹅非线性量化方法。
相对均匀量化，对数量化牺牲了赋分大信号时的信噪比，换取了小信号时的信噪比性能提升。
#### 对数量化的性能分析：
已知经函数 $f(x)$ 变换后，量化信噪比为$SNR_{q}=\frac{S_{\kappa}}{\sigma_{q}^{2}}=\frac{\int_{-V_{p}}^{V_{p}}x^{2}p_{X}(x)dx}{\frac{\Delta^{2}}{12}\int_{-V_{p}}^{+V_{p}}(f^{\prime}(x))^{-2}p_{X}(x)dx}$
若取$f^{\prime}(x)=\frac{1}{Bx} \rightarrow f(x)=\frac{1}{B}ln~x$ (其中B为常数)
则可得 $SNR_{q}=\frac{S_{\chi}}{\sigma_{q}^{2}}=\frac{12}{B^{2}\Delta^{2}}=\frac{12}{B^{2}(2V_{p}/M)^{2}}=\frac{3M^{2}}{B^{2}V_{p}^{2}}$(信噪比为常数)
#### 理想的对数量化变换特性

$f(x)=\begin{cases} \frac{1}{B}ln~x, & x > 0 \\ sgn(x)\frac{1}{B}ln(-x), & x < 0 \end{cases}$

当 $|x| \rightarrow 0$ 时，$\frac{1}{B}ln|x| \rightarrow \infty$，故理想的对数量化变换物理上无法实现。
#### 实际系统中
采用修正的对数变换特性：
(a) 对数变换特性
![[Screenshot_20251011_165012.jpg|150]]
(b) 修正的对数变换特性
![[Screenshot_20251011_165035.jpg|150]]
### 两种修正对数变换特性

**A率 (A-law) 和 µ率 (µ-law)** 是国际电信联盟(ITU)推荐的两种对数压扩标准，主要用于数字电话系统。
- **µ率压缩 (µ-law)**: 北美和日本等采用的标准。表达式为：
	$$
f(x) = \frac{\ln(1+\mu x)}{\ln(1+\mu)},\quad 0\le x\le1 \quad 在实际标准中取\,\mu=255$$
	在小信号区域的$\mu$率变换：$f'(0)=\left.\frac{\mu}{\ln(1+\mu)}\frac{1}{1+\mu x}\right|_{x=0}=\frac{255}{\ln(1+255)}\approx 46$
	相对于均匀量化，小信号的信噪比改善：$20\lg\frac{f'(0)}{f'_{Uni}(0)}=20\lg{\frac{46}{1}}\approx 33(dB)$
- **A率压缩 (A-law)**: 中国和欧洲等采用的标准。其表达式为分段函数：
	$$
f(x) = \begin{cases} \frac{Ax}{1+\ln A} & 0 \le x \le \frac{1}{A} \\ \frac{1+\ln(Ax)}{1+\ln A} & \frac{1}{A} \le x \le 1 \end{cases}
$$
	在实际标准中取$A=87.56$
	在小信号区域的$A$率变换：$f'(x)=\frac{d}{dx}\left.\left(\frac{Ax}{1+\ln A}\right)\right|_{A=87.56}=\frac{87.56}{1+\ln87.56}=16$
	相对于均匀量化，小信号的信噪比改善：$20\lg{\frac{f'(x)}{f'_{Uni}(x)}}=20\lg{\frac{16}{1}}=24(dB)$
- **折线近似法**
    - 在工程上，为了便于数字化实现，平滑的对数曲线通常用多段折线来近似。例如，A率采用**十三折线法**，而$\mu$率采用**十五折线法**。
    - **十三折线法原理**：将信号的Y轴正半轴和正半轴$[0,1]$与$[-1,0]$分别分为8个等长的段落，将横坐标$[0,1]$以两倍宽度递增的方法从小到大也分为8个子区间(负半轴同理)：$[0,1/128),[1/128,1/64),[1/64,1/32),[1/32,1/16),[1/16,1/8),[1/8,1/4),[1/4,1/2),[1/2,1]$然后把每段的对角线连起来构成一条折线，一共是13段曲线(正负半轴的第一段曲线和第二段曲率相同合为一条)。这样，小信号区域的折线斜率大，等效量化阶距小；大信号区域斜率小，等效量化阶距大，从而近似实现了对数压扩的效果。
    - **十五折线法原理**：与A率相似但是不同的地方是区间边界为$\frac{1+2^{n-1}}{255}$，且前两段曲线斜率不一样无法合并所以共计15条曲线
    - [image:A率十三折线法近似示意图 页码:64]

# 3.3 脉冲编码调制 (Pulse Code Modulation, PCM)

### PCM 基本原理
脉冲编码调制 (PCM) 是将模拟信号变换成二进制信号的最基本和最常用的方法，它严格遵循**抽样、量化、编码**三个过程。
![[Screenshot_20251013_213641.jpg|250]]
[image:PCM编解码系统框图 页码:72]

### 编码
**定义**：将经过量化后的离散电平值，变换成二进制码组的过程。

**常用PCM编码方法**
- **1. 自然二进制码 (Natural Binary Code, NBC)**：将十进制数直接转换为其二进制表示。优点是简单直观，但多位同时跳变的特性可能在误码时导致较大误差。
- **2. 格雷码 (Gray Code)**：相邻两个码组之间只有一位二进制数不同。优点是抗干扰能力强，单个比特错误只会导致一个量化阶距的误差。
- **3. 折叠二进制码 (Folded Binary Code)**：适用于小信号取值概率大的信号（如语音），具有较好的抗干扰性。PCM通信中通常采用此种编码。
![[Screenshot_20251013_213845.jpg|450]]
[image:三种编码方式对照表 页码:77]

### A率对数压缩PCM的编码规则
A率PCM是语音通信中广泛使用的标准，它采用8位编码，通过十三折线法近似实现对数压缩。
![[Screenshot_20251013_214505.jpg|450]]
[image:A率正输入编码表(量化间隔默认为2时)]
![[Screenshot_20251013_215028.jpg|450]]
[image:μ率正输入编码表]
**8位码组结构**：`M1 M2 M3 M4 M5 M6 M7 M8`
- **M1 (极性码)**：1位，`1`代表正极性，`0`代表负极性。
- **M2 M3 M4 (段落码)**：3位，表示信号幅度绝对值所在的段落 (`000`~`111`)。
- **M5 M6 M7 M8 (段内码)**：4位，表示信号在对应段落内的16个均匀量化电平值 (`0000`~`1111`)。

**最小量化间隔**：高频**易错点**，一般情况下默认最小量化间隔为2，此时最大分层电平值为4096，这是因为第一段里$\frac{32(第一段长度)}{16(段内量化级数)}=2$。但是有些题目会标明最小量化间隔为1，此时最大分层电平为2048，所有段的最大分层电平值比默认值$\div 2$，这是很容易错的地方！

- **A率PCM编码与译码示例**
    - **编码示例**: 对输入信号值 $x = -0.74V$ 进行编码，设动态范围为 $[-2V, 2V]$。
        - 1. **确定极性码**：信号为负，所以 $M_1 = 0$。
        - 2. **归一化量值**：编码器最大输入电平对应4096个单位，转换输入电压：
           $$
           y_n = \frac{|x|}{V_p} (归一化)\times 4096(最大分层电平) = \frac{|-0.74|}{2} \times 4096 = 1515.52
           $$
        - 3. **确定段落码**：查A率PCM编码表，$1024 \le 1515.52 < 2048$，信号处于第6段，段落码为`110` ($M_2M_3M_4 = 110$)。
        - 4. **确定段内码**：计算信号值超出该段起始电平的量化阶距数：
           $$
           m = \lfloor\frac{y_n - V_k}{\Delta_k}\rfloor = \lfloor\frac{1515.52 - 1024}{64}\rfloor = \lfloor 7.68 \rfloor = 7
           $$
           $m=7$ 对应的4位二进制码为`0111` ($M_5M_6M_7M_8 = 0111$)。
        - **最终编码输出**: `0 110 0111`
    - **译码示例**: 对接收到的码组 `0 110 0111` 进行译码。
        - 1. **确定极性**：$M_1=0$，信号为负。
        - 2. **确定段落和参数**：$M_2M_3M_4 = 110$，为第6段。查表得该段起始值 $V_6=1024$，量化阶距 $\Delta_6=64$。
        - 3. **确定段内值**：$M_5M_6M_7M_8=0111$，十进制为 $m=7$。
        - 4. **计算输出电压**：译码时在重建电平上增加半个量化阶距以使误差中心化。
           $$
           \hat{x} = (\pm 1) \frac{1}{4096} (V_k + m\Delta_k + \frac{\Delta_k}{2}) \cdot V_p = (-1) \frac{1}{4096} (1024 + 7 \times 64 + \frac{64}{2}) \times 2 = -0.734375 V
           $$

---

# 3.4 差分脉冲编码调制 (Differential PCM, DPCM)

### DPCM基本原理
**核心思想**：利用信号样点间的相关性（冗余），不直接对采样值编码，而是对**当前采样值**与**对当前值的预测值**之间的**差值**进行量化和编码。由于差值信号的动态范围通常远小于原始信号，因此可以用更少的比特数来传输，从而实现数据压缩。
![[Screenshot_20251013_215527.jpg|500]]
[image:DPCM编解码器原理框图 页码:98]

- **DPCM工作流程详解**
    - **预测器 (Predictor)**：根据一个或多个**过去的重建值** $x_r(k-1), x_r(k-2), \dots$ 来生成对当前值 $x(k)$ 的预测值 $x_e(k)$。**预测必须基于重建值** $x_r$ 而非原始值 $x$，因为解码端无法获得原始值，这样才能保证编解码两端的预测器状态同步。
    - **差值与量化**：计算差值信号 $d(k) = x(k) - x_e(k)$，并对该差值进行量化得到 $d_q(k)$。
    - **重建与反馈**：在编码器内部，通过 $x_r(k) = x_e(k) + d_q(k)$ 构建本地的重建信号，并将其反馈给预测器，用于下一次预测。
    - **解码**：解码器结构与编码器中的反馈回路完全相同。它接收量化差值 $d_q(k)$，与本地预测器生成的预测值 $x_e(k)$ 相加，得到重建信号 $x_r(k)$。
记重建信号为$x_r(k)$，则译码后的误差为：$e(k)=x(k)-x_r(k)=(x_e(k)+d(k))-(x_e(k)+d_q(k))=d(k)-d_q(k)$
$d_q(k)$是$d(k)$的量化值，即误差只与量化误差有关。
相同的量化信噪比，DPCM只需要差值信号，若保持量化间距不变，编码输出所需的位数n可减少，传输信号所需的速率降低。
若DPCM与PCM采取相同编码比特数，DPCM量化间距可以取更小使得量化信噪比更高
### DPCM的性能
信号$x(k)$功率的统计平均值记为：$S_x=e[x^2(k)]$
DPCM编码产生的误差的统计平均值为：$N_e=E[e^2(k)]$
DPCM编码的信噪比：$SNR=\frac{S_x}{N_e}=\frac{E[x^2(k)]}{E[e^2(k)]}=\frac{E[x^2(k)]}{E[d^2(k)]}\frac{E[d^2(k)]}{E[e^2(k)]}$
DPCM相对于PCM的性能改善，可以用**预测增益 $G_p$** 来衡量。

$$
G_p = \frac{E[x^2(k)]}{E[d^2(k)]} = \frac{信号平均功率}{预测误差平均功率}
$$
**量化信噪比**：$SNR_q=\frac{E[d^2(k)]}{E[e^2(k)]}$
则有**信噪比**：$SNR=G_pSNR_q$
DPCM系统的信噪比与PCM系统的信噪比（采用相同的量化器）关系为：$SNR_{DPCM} = G_p \cdot SNR_q$。预测越准确，$G_p$ 越大，DPCM性能越好。

### 信号预测的基本方法
#### 极点预测法
若取**过去的重建值**对当前值进行预测：$x_e(k)=\sum_{i=1}^Na_ix_r(k-i)$式中$a_i,i=1,2,\dots,N$是预测系数。则可得：$d_q(k)\approx d(k)=x(k)-x_e(k)\approx x_r(k)-\sum^N_{i=1}a_ix_r(k-i)$
取Z变换：$d_q(k)\iff D_q(Z),x_r(k)\iff X_r(Z)$
可得**传递函数**：$H(Z)=\frac{X_r(Z)}{D_q(Z)}=\frac{1}{1-\sum_{i=1}^Na_iZ^{-i}}$
传递函数只有极点，故称之为极点预测法。
#### 零点预测法
若取**过去的差值**对当前值进行预测：$x_e(k)=\sum_{i=1}^Mb_id_q(k-i)$ 式中$b_i,i=1,2,\dots,M$是预测系数。
则可得：$x_r(k)=x_e(k)+d_q(k)=\sum_{i=1}^Mb_id_q(k-i)+d_q(k)$
取Z变换：$X_r(D)=\sum_{i=1}^Mb_iZ^{-i}D_q(Z)+D_q(Z)$
可得**传递函数**：$H(Z)=\frac{X_r(Z)}{D_q(Z)}=1+\sum_{i=1}^Mb_iZ^{-i}$
传递函数只有零点，故称之为零点预测法。
#### 零极点预测法
若**同时取过去的重建值和差值**对当前值进行预测：$x_e(k)=\sum_{i=1}^Na_ix_r(k-i)+\sum^M_{i=1}b_id_q(k-i)$
则可得：$x_r(k)=x_e(k)+d_q(k)=\sum_{i=1}^Na_ix_r(k-i)+\sum_{i=1}^Mb_id_q(k-i)+d_q(k)$
取Z变换：$X_r(Z)=\sum_{i=1}^Na_iZ^{-i}+\sum_{i=1}^Mb_iZ^{-i}D_q(Z)+D_q(Z)$
可得**传递函数**：$H(Z)=\frac{X_r(Z)}{D_q(Z)}=\frac{1+\sum_{i=1}^Mb_iZ^{-i}}{1-\sum_{i=1}^Na_iZ^{-i}}$
传递函数包含零点和极点，故称之为零极点预测法。
### 自适应差分脉冲编码调制 (ADPCM)
**原理**：对于语音等非平稳信号，其统计特性随时间变化。ADPCM通过**自适应预测**（动态调整预测器系数）和**自适应量化**（动态调整量化阶距），来适应信号的变化，从而获得比DPCM更好的压缩效果。
[image:ADPCM编解码器原理框-图 页码:113]

---

# 3.5 增量调制 (Delta Modulation, ΔM)

### ΔM基本原理
**定义**：增量调制是DPCM的最简化形式，其预测器为一阶（直接使用前一个值做预测），量化器仅有2个电平（1比特量化）。
**工作原理**：用一个阶梯波 $x_l(t)$ 来逼近输入信号 $x(t)$。在每个抽样时刻，比较输入信号与阶梯波的当前值。若输入信号更大，则输出`1`，阶梯波向上走一个阶距 $\Delta$；反之则输出`0`，阶梯波向下走一个阶距 $\Delta$。
![[Screenshot_20251014_205218.jpg|400]]
[image:增量调制原理框图 页码:120]
### ΔM的具体工作原理
**差值运算**：$d(t)=x(t)-x_l(t)$
**编码输出**：$C(n) = \begin{cases} 1, & d(t) \ge 0 \\0, & d(t) < 0 \end{cases}$
重建信号：$x_l(t)=\int_{-\infty}^tS_p(t)d\tau$
	其中$S_p(t)=\sum_{k=-\infty}^{\infty}p(t-kT_s)E\,sgn(d(t-kT_s))$
	$p(t)=u(t)-u(t-T_s)$
	本地的重建信号作用相当于DPCM的预测信号；接收端的重建信号经低通滤波后作为译码输出。
### 过载失真 (Slope Overload)**
**原因**：当输入信号的斜率超过了阶梯波所能跟踪的最大斜率（即 $\Delta/T_s$）时，重建信号将跟不上原始信号的变化。
	重建信号的最大变化率：$\left| \frac{dx_1(t)}{dt} \right|=\frac{\Delta}{T_s}$
	若输入信号变化率：$\left| \frac{dx(t)}{dt}\right| \le \left| \frac{dx_l(t)}{dt}\right|=\frac{\Delta}{T_s}$ 则重建信号可跟踪输入的变化。相应地接收端的重建信号可以恢复原信号的基本波形。
	若输入信号的变化率：$\left| \frac{dx(t)}{dt}\right| \le \left| \frac{dx_l(t)}{dt}\right|=\frac{\Delta}{T_s}$ 则重建信号无法跟踪输入的变化，相应地在接收端也将产生严重的失真。这就是所谓的△M的过载问题。
**不过载条件**：$\max\left|\frac{dx(t)}{dt}\right| \le \frac{\Delta}{T_s} = \Delta \cdot f_s$
![[Screenshot_20251014_210202.jpg|400]]
[image:增量调制的过载失真与颗粒噪声示意图 页码:127]
### 量化噪声和过载噪声**
- **噪声分析**：
	由：$e(t)=x(t)-x_l(t)$，在无过载的情况下，可认为$e(t)$在$(-\Delta,+\Delta)$内均匀分布
	**量化噪声**：$\sigma_q^2=\int_{-\Delta}^{+\Delta}e^2\frac{1}{2\Delta}de=\frac{\Delta^2}{3}$
	若将$e(t)$近似看做一个功率均匀分布在$0～f_s$频带内的信号，则**功率密度谱**为：$\frac{\sigma_q^2}{f_s}=\frac{\Delta^2}{3f_s}$
	设接收端低通滤波器的带宽为：$f_B$，则接收端收到的**总的噪声功率**为：$\sigma'^2_q=\frac{\Delta^2}{3f_s}f_B$
- **正弦信号临界过载时的$SNR_{max}$**：
	由临界过载条件：$f_s\Delta=A_{max}\omega$，**正弦信号功率**：$S=\frac{A^2_{max}}{2}=\frac{\Delta^2f_s^2}{2\omega^2}=\frac{\Delta_2f_S^2}{8\pi^2f^2}$
	**信噪比**：$$SNR_{max}=\frac{\Delta^2f_S^2/8\pi^2f^2}{\Delta^2f_B/3f_S}=0.038\frac{f_S^3}{f^2f_B}=30\lg f_S+20\lg f-10\lg f_B -14$$
	- 结论：因为$30\lg2＝9$，所以抽样频率每提高一倍，$SNR_{max}$提高 $9dB$；
		$20\lg2＝6$，所以信号频率$f$每提高一倍，$SNR_{max}$减少$6dB$。
		对语音信号，$f_S$通常要比PCM情况下的采样频率高几倍。
### ΔM的改进
- **1. 增量总和调制 (Δ-Σ Modulation)**
    - **原理**：在编码器输入端对信号**先积分**，再进行ΔM调制。在解码端对输出信号**再微分**来恢复。
    - **效果**：使不过载条件主要只与信号的幅度有关，而与频率无关，大大降低了过载的可能性。
- **2. 自适应增量调制 (Adaptive ΔM, ADM)**
    - **原理**：使量化阶距 $\Delta$ 能够自适应地变化。当检测到连续的`1`或`0`输出时（可能过载），则增大 $\Delta$；当检测到`1`和`0`交替输出时（颗粒噪声为主），则减小 $\Delta$。

---
# 3.6 不同编码调制方式的误码性能分析

在数字信号的传输过程中，信道噪声可能会导致码元错误（例如`1`被错判为`0`），这会在接收端译码时引入额外的噪声，从而降低信号质量。本节主要分析和比较增量调制(ΔM)和线性PCM在有传输误码时的性能。
## 增量调制编码的误码性能分析

### 1. 误码的表示

$\Delta$ 调制编码正确译码的输出可表示为：
$$x_{l}(n)=\sum_{k=-\infty}^{n}\Delta~sgn(d(k))$$
若传输过程出现的干扰导致出现误码，则输出可表示为：
$$\hat{x}_{l}(n)=\sum_{k=-\infty}^{n}\Delta(sgn(d(k))+2e(k))$$
其中 $e(k)$ 定义为：
$$e(k)=\{\begin{matrix}0, & \text{当时刻没有出现误码} \\ -sgn(d(k)), & \text{当时刻出现误码} \end{matrix}$$
### 2. 误码的等效干扰
根据课件第2页的图示，出现误码的位置等效于在 $2\Delta e(k)$ 波形上受到一个“等效干扰脉冲”的干扰。
课件（第3页）指出，干扰脉冲的幅度为 $-2E$ 或者 $+2E$。
### 3. 干扰脉冲功率分析
* 因为干扰脉冲的幅度为 $-2E$ 或者 $+2E$，因此干扰脉冲的功率为：
    $$(2E)^{2}$$
* 若传输过程的误比特率为 $P_{b}$，则干扰脉冲的平均功率为：
    $$\sigma_{t}^{2}=(2E)^{2}P_{b}=4E^{2}P_{b}$$
* 假定噪声功率均匀分布在频谱区域 $(0,f_{s}/2)$，则噪声功率密度谱为：
    $$P_{e}(f)=\frac{\sigma_{t}^{2}}{f_{s}/2}=\frac{8E^{2}P_{b}}{f_{s}}$$
### 4. 输出噪声功率分析

#### 误码对应的噪声功率
* 若译码器中的积分器对应的传递函数为：
    $$|I(f)|=|\frac{f_{1}}{\sqrt{f^{2}+f_{1}^{2}}}|\approx\frac{f_{1}}{f}=\frac{1}{2\pi RCf}$$
* 则输出的噪声功率密度谱为：
    $$P_{e}^{\prime}(f)=|I(f)|^{2}P_{e}(f)=(\frac{1}{2\pi RCf})^{2}\frac{8E^{2}P_{b}}{f_{S}}=\frac{2E^{2}P_{b}}{\pi^{2}R^{2}C^{2}f^{2}f_{S}}$$
* 假定输出滤波器的通带范围为 $(f_{L},f_{H})$，则误码对应的噪声功率为：
    $$\sigma_{t}^{\prime2}=\int_{f_{L}}^{f_{H}}P_{e}^{\prime}(f)df\approx\frac{2E^{2}P_{b}}{\pi^{2}R^{2}C^{2}f_{S}f_{L}}=\frac{2\Delta^{2}P_{b}}{\pi^{2}T_{S}f_{L}}$$
    （注：此处课件原文将 $E$ 替换为 $\Delta$）
#### 量化噪声功率
* 另外，若截止频率为 $f_{H}$，通过输出滤波器后的量化噪声功率为：
    $$\sigma_{q}^{\prime2}=\frac{\sigma_{q}^{2}}{f_{S}}f_{H}=\frac{\Delta^{2}/3}{f_{S}}f_{H}=\frac{\Delta^{2}f_{H}}{3f_{S}}$$
## 5. 总噪声功率分析

增量调制编码系统总的噪声功率分析如下：

* **前提**：因为量化误差 $e_{q}$ 与误码引起的译码误差 $e_{t}$ 是统计独立的，因此其概率密度函数满足如下关系：
    $$p(e_{q}e_{t})=p(e_{q})p(e_{t})$$
* **假设**：一般地有 $E(e_{q}) = 0$ 和 $E(e_{t})=0$。
* **推导**：总的噪声功率为：
    $$\begin{aligned}
    \sigma_{n}^{2}&=E[(e_{q}+e_{t})^{2}]\\
    &=\int_{-\infty}^{\infty}\int_{-\infty}^{-\infty}(e_{q}+e_{t})^{2}p(e_{q}e_{t})de_{q}de_{t} \\
    &=\int_{-\infty}^{-\infty}\int_{-\infty}^{\infty}(e_{q}^{2}+2e_{q}e_{t}+e_{t}^{2})p(e_{q})p(e_{t})de_{q}de_{t} \\
    &=\int_{-\infty}^{\infty}e_{q}^{2}p(e_{q})de_{q}+2\int_{-\infty}^{\infty}e_{q}p(e_{q})de_{q}\int_{-\infty}^{\infty}e_{t}p(e_{t})de_{t}+\int_{-\infty}^{\infty}e_{t}^{2}p(e_{t})de_{t} \\
    &=\int_{-\infty}^{\infty}e_{q}^{2}p(e_{q})de_{q}+2E(e_{q})E(e_{t})+\int_{-\infty}^{\infty}e_{t}^{2}p(e_{t})de_{t}\\
    &=\sigma_{t}^{\prime2}+\sigma_{q}^{\prime2}
    \end{aligned}
    $$
* **结论**：总噪声功率是误码噪声功率与量化噪声功率之和。
    $$\sigma_{n}^{2} = \sigma_{t}^{\prime2}+\sigma_{q}^{\prime2}$$
## 6. 总信噪比 (SNR) 分析

* **总噪声功率**：利用前面的分析结果，总的噪声功率为：
	$$\sigma_{n}^{2}=\sigma_{t}^{\prime2}+\sigma_{q}^{\prime2}=\frac{2\Delta^{2}P_{b}}{\pi^{2}T_{s}f_{L}}+\frac{\Delta^{2}f_{H}}{3f_{s}}$$

* **信号功率**：若输入是处于临界不过载的正弦波信号，则信号功率为：
    $$S_{max}=\frac{A_{max}^{2}}{2}=\frac{\Delta^{2}f_{s}^{2}}{2\omega^{2}}=\frac{\Delta^{2}f_{s}^{2}}{8\pi^{2}f^{2}}$$

* **量化信噪比**：
    $$SNR_{q,max}=\frac{S_{max}}{\sigma_{q}^{\prime2}}=\frac{\Delta^{2}f_{S}^{2}}{8\pi^{2}f^{2}}/\frac{\Delta^{2}f_{H}}{3f_{S}}=\frac{3f_{S}^{3}}{8\pi^{2}f^{2}f_{H}}$$
* **总信噪比**：
    $$SNR_{max}=\frac{S_{max}}{\sigma_{q}^{\prime2}+\sigma_{t}^{\prime2}}=\frac{S_{max}/\sigma_{q}^{\prime2}}{1+\sigma_{t}^{\prime2}/\sigma_{q}^{\prime2}}=\frac{SNR_{q.max}}{1+\sigma_{t}^{\prime2}/\sigma_{q}^{\prime2}}=\frac{SNR_{q.max}}{1+6P_{b}f_{s}^{2}/\pi^{2}f_{H}f_{L}}$$
## 线性PCM编码的误码性能分析与比较
### 一、线性PCM编码的误码性能分析

#### 1. 误码导致的等效噪声功率
对于线性PCM编码（均匀量化编码），假设量化电平为 $y_k, k=1,2,...,M$。
设编码输出的概率为 $P(y_k)$。若传输过程中出错，导致 $y_i \rightarrow y_j$（其中 $y_i, y_j$ 均为可能的量化电平），其概率为 $P(y_j / y_i)$。
则由传输错误所导致的**等效噪声功率**为：
$$\sigma_{t}^{2} = E(e_{t}^{2}) = E[(y_{i}-y_{j})^{2}] = \sum_{j=1}^{M}\sum_{i=1}^{M}(y_{i}-y_{j})^{2}P(y_{j}/y_{i})P(y_{i})
$$
**分析作出如下假定：**
1.  传输过程中，每个码组中2位或2位以上的误码可以忽略，则误比特率 $P_b$ 近似等于码组出错的概率，即 $P_b \approx P(y_j / y_i)$。
2.  输入信号为均匀分布，则每个量化电平的输出概率相等，即 $P(y_k) = 1/M$。
#### 2. 平均噪声功率的推导
当某一位（第k位）发生误码时，导致的等效噪声功率为 $(y_i - y_j)^2 = (2^{k-1}\Delta)^2$。
由此可得，由误码导致的平均噪声功率为：
$$
\begin{aligned}
\sigma_{t}^{2} &= \sum_{i=1}^{M}\sum_{k=1}^{\log_{2}M}(2^{k-1}\Delta)^{2}P_{b}P(y_{i}) \\
&= \sum_{i=1}^{M}\sum_{k=1}^{\log_{2}M}(2^{k-1}\Delta)^{2}P_{b}\frac{1}{M} \\
&= \sum_{i=1}^{M}\frac{1}{M}P_{b}\sum_{k=1}^{\log_{2}M}(2^{k-1}\Delta)^{2} \\
&= P_{b}\Delta^{2}\sum_{k=1}^{\log_{2}M}4^{k-1} \\
&= P_{b}\Delta^{2}\frac{1-4^{\log_{2}M}}{1-4} \\
&= \frac{M^{2}-1}{3}P_{b}\Delta^{2}
\end{aligned}
$$
#### 3. 总噪声功率与信噪比
**总的噪声功率**是量化噪声功率 $\sigma_q^2$ 与误码导致的噪声功率 $\sigma_t^2$ 之和：
$$\sigma_{n}^{2} = \sigma_{q}^{2} + \sigma_{t}^{2} = \frac{\Delta^{2}}{12} + \frac{M^{2}-1}{3}P_{b}\Delta^{2}$$

对于均匀分布的输入信号，其平均功率为：
$$S_{max} = \int_{-\infty}^{\infty}x^{2}p(x)dx = \int_{-V_{p}}^{+V_{p}}x^{2}\frac{1}{2V_{p}}dx = \frac{M^{2}\Delta^{2}}{12}$$

**最大量化信噪比**可表示为：
$$SNR_{q,max} = \frac{S_{max}}{\sigma_{q}^{2}} = \frac{M^{2}\Delta^{2}/12}{\Delta^{2}/12} = M^{2}
$$
因此，考虑误码后的**总信噪比**为：
$$SNR_{max} = \frac{S_{max}}{\sigma_{n}^{2}} = \frac{S_{max}/\sigma_{q}^{2}}{1+\sigma_{t}^{2}/\sigma_{q}^{2}} = \frac{SNR_{q,max}}{1+\sigma_{t}^{2}/\sigma_{q}^{2}}$$
## 二、两种编码的抗误码性能比较

**分析前提**：比较增量调制（ΔM）编码与线性PCM编码，当总信噪比下降不大于量化信噪比最大值的1/2时，对误比特率 $P_b$ 的要求。

即分析 $SNR_{max} \ge \frac{SNR_{q,max}}{2}$ 的情况。
### 1. 线性PCM编码

由 $SNR_{max} = \frac{SNR_{q,max}}{2}$ 可得：
$$1 + \sigma_{t}^{2}/\sigma_{q}^{2} = 2 \implies \sigma_{t}^{2} = \sigma_{q}^{2}$$
代入各自的表达式：
$$\frac{M^{2}-1}{3}P_{b}\Delta^{2} = \frac{\Delta^{2}}{12}$$
可解得对**误比特率**的要求：
$$P_{b} = \frac{1}{4(M^{2}-1)}$$
若取 $M = 2^8 = 256$，则：
$$P_{b} = \frac{1}{4(256^{2}-1)} \approx 3.816 \times 10^{-6}$$
### 2. ΔM 调制编码

同样由 $SNR_{max} \ge \frac{SNR_{q,max}}{2}$ 的条件可得：
$$\sigma_{t}^{\prime2} = \sigma_{q}^{\prime2}$$
其中 $\sigma_{t}^{\prime2}$ 和 $\sigma_{q}^{\prime2}$ 分别是ΔM编码的误码噪声和量化噪声。

代入ΔM编码的噪声功率表达式：
$$\frac{2\Delta^{2}P_{b}}{\pi^{2}T_{s}f_{L}} = \frac{\Delta^{2}f_{H}}{3f_{s}}$$
进而有：
$$P_{b} = \frac{\pi^{2}f_{H}f_{L}}{6f_{S}^{2}}$$
根据电话系统的基本参数，$f_L = 300Hz$，$f_H = 3100Hz$。并考虑与线性PCM编码（8位量化，8kHz抽样）同样的输出数据率（64kbps），取ΔM的抽样频率 $f_s = 64kHz$。
可得对**误比特率**的要求：
$$P_{b} = \frac{\pi^{2}f_{H}f_{L}}{6f_{S}^{2}} = \frac{\pi^{2} \times 3100 \times 300}{6 \times (64 \times 10^{3})^2} \approx 3.735 \times 10^{-4}$$
## 三、结论

若要保证总的信噪比不小于量化信噪比的1/2：
* **对线性PCM编码**，要求误比特率 $P_{b} \le 3.816 \times 10^{-6}$。
* **对ΔM调制编码**，要求误比特率 $P_{b} \le 3.735 \times 10^{-4}$。

因此，从上述意义上来说，ΔM调制编码能容忍更高的误比特率，具有更好的抗误码性能。

---

# 本章小结

本章系统学习了将模拟信号转换为数字信号的全过程，核心知识点包括：

* **PCM的基本概念**：掌握了模拟信号数字化的三个基本步骤：抽样、量化和编码。
* **抽样定理**：理解了低通和带通信号的奈奎斯特抽样定理，以及不满足条件时产生的混叠现象。
* **量化**：学习了均匀量化和非均匀量化（A率/µ率压扩）的原理，并掌握了量化信噪比的核心公式（每比特6dB法则）。
* **编码**：了解了将量化电平映射为二进制码组的几种方法。
* **DPCM**：理解了利用信号相关性进行预测编码来提高压缩效率的基本思想。
* **ΔM**：掌握了作为DPCM简化形式的增量调制的工作原理、主要失真类型及其改进方法。