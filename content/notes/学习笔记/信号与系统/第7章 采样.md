## 本章主要内容：

1.  如何用连续时间信号的离散时间样本来表示连续时间信号——采样定理。
2.  如何从采样所得到的样本重建连续时间信号。
3.  欠采样导致的后果——频谱混叠。
4.  连续时间信号的离散时间处理。
5.  离散时间信号的采样、抽取及内插。
6.  频域采样。

## 7.0 引言 (Introduction)

在日常生活中，常可以看到用离散时间信号表示连续时间信号的例子。例如照片、电视屏幕的画面、电影胶片等等，这些都表明连续时间信号与离散时间信号之间存在着密切的联系。在一定条件下，可以用离散时间信号代替连续时间信号而并不丢失原来信号所包含的信息。

**补充知识点：** 信号是信息的载体，可以分为连续时间信号和离散时间信号。连续时间信号是指在连续的时间轴上都有定义的信号，例如声音信号。离散时间信号是指仅在离散的时间点上有定义的信号，例如数字音频信号。

研究连续时间信号与离散时间信号之间的关系主要包括：

1.  在什么条件下，一个连续时间信号可以用它的离散时间样本来代替而不致丢失原有的信息。
2.  如何从连续时间信号的离散时间样本不失真地恢复成原来的连续时间信号。
3.  如何对一个连续时间信号进行离散时间处理。
4.  对离散时间信号如何进行采样、抽取及内插。

## 7.1 用样本表示连续时间信号：采样定理 (Theorem of Sampling)

### 一. 采样 (Sampling)

在某些离散的时间点上提取连续时间信号值的过程称为采样。
是否任何信号都可以由它的任意离散时间样本来表示？
对一维连续时间信号采样的例子：
[Image 三条不同频率的曲线在相同采样点有相同的值 10]
![[第7章_20250516_092720_1.png|300]]
$x_1(t)$, $x_2(t)$, $x_3(t)$ 在采样点 $-3T, -2T, -T, 0, T, 2T$ 处的值可能相同，但它们是不同的信号。

在没有任何条件限制的情况下，从连续时间信号采样所得到的样本序列不能唯一地代表原来的连续时间信号。此外，对同一个连续时间信号，（采用不同的采样方式或参数）同时也会得到不同的样本序列。

### 二. 采样的数学模型

采样过程可以看作是将连续信号 $x(t)$ 与一个冲激串 $p(t)$ 相乘。
在时域：
$$x_p(t) = x(t) \cdot p(t)$$
在频域（傅里叶变换）：
$$X_p(j\omega) = \frac{1}{2\pi} X(j\omega) * P(j\omega)$$
其中 $*$ 表示卷积运算。

### 三. 冲激串采样 (理想采样)

冲激串 $p(t)$ 定义为：
$$p(t) = \sum_{n=-\infty}^{\infty} \delta(t - nT)$$
其中 $T$ 为采样间隔（采样周期）。
采样后的信号 $x_p(t)$ 为：
$$x_p(t) = x(t)p(t) = \sum_{n=-\infty}^{\infty} x(nT)\delta(t - nT)$$
这表示 $x_p(t)$ 是一个在各采样时刻 $nT$ 具有幅度 $x(nT)$ 的冲激序列。

[Image 理想采样过程示意图 12]
![[Screenshot_20250516_092843.jpg|300]]
图示了原始信号 $x(t)$，冲激串 $p(t)$，以及采样后的信号 $x_p(t)$。

在频域，冲激串 $p(t)$ 的傅里叶变换 $P(j\omega)$ 为：
$$P(j\omega) = \frac{2\pi}{T} \sum_{k=-\infty}^{\infty} \delta(\omega - k\omega_s)$$
其中 $\omega_s = \frac{2\pi}{T}$ 是采样角频率。
所以，采样后信号的频谱 $X_p(j\omega)$ 为：
$$X_p(j\omega) = \frac{1}{2\pi} X(j\omega) * P(j\omega) = \frac{1}{2\pi} X(j\omega) * \left(\frac{2\pi}{T} \sum_{k=-\infty}^{\infty} \delta(\omega - k\omega_s)\right)$$
$$X_p(j\omega) = \frac{1}{T} \sum_{k=-\infty}^{\infty} X(j(\omega - k\omega_s))$$

可见，在时域对连续时间信号进行理想采样，就相当于在频域将连续时间信号的频谱 $X(j\omega)$ 以 $\omega_s$ 为周期进行周期性延拓，并且幅度乘以 $1/T$。

[Image 理想采样在时域和频域的表示 14]
![[Screenshot_20250516_092931.jpg|450]]
图示了原始信号频谱 $X(j\omega)$，冲激串频谱 $P(j\omega)$，以及采样后信号频谱 $X_p(j\omega)$。 $X_p(j\omega)$ 是 $X(j\omega)$ 以 $\omega_s$ 为周期延拓并叠加的结果。

要想使采样后的信号样本能完全代表原来的信号，就意味着要能够从 $X_p(j\omega)$ 中不失真地分离出 $X(j\omega)$。这就要求 $X(j\omega)$ 在周期性延拓时不能发生频谱的**混叠** (aliasing)。为此必须要求：

1.  $x(t)$ 必须是带限的，即其频谱在某一最高频率 $\omega_M$ 之外为零。 ($|X(j\omega)| = 0$ for $|\omega| > \omega_M$)
2.  采样间隔（周期）$T$ 不能是任意的，必须保证采样频率 $\omega_s \ge 2\omega_M$。其中 $\omega_s = 2\pi/T$ 为采样角频率。$2\omega_M$ 通常被称为**奈奎斯特频率** (Nyquist rate)。

在满足上述要求时，可以通过一个理想低通滤波器从 $X_p(j\omega)$ 中不失真地分离出 $X(j\omega)$。

[Image 采样后信号频谱与理想低通滤波器 16]
![[Screenshot_20250516_093018.jpg|300]]
图示了采样后信号的频谱 $X_p(j\omega)$。如果 $\omega_s - \omega_M > \omega_M$，即 $\omega_s > 2\omega_M$，则各周期频谱不发生重叠。可以通过一个截止频率 $\omega_c$ 满足 $\omega_M < \omega_c < \omega_s - \omega_M$ 的理想低通滤波器恢复原始频谱。

**Nyquist 采样定理：**
对带限于最高频率 $\omega_M$ 的连续时间信号 $x(t)$，如果以 $\omega_s \ge 2\omega_M$ 的频率进行理想采样，则 $x(t)$ 可以唯一地由其样本 $x(nT)$ 来确定。

**信号重建：**
从采样信号 $x_p(t)$ 重建原始信号 $x_r(t)$ (理想情况下 $x_r(t) = x(t)$)，可以通过一个理想低通滤波器 $H(j\omega)$ 实现。
$$H(j\omega) = \begin{cases} T, & |\omega| < \omega_c \\ 0, & |\omega| > \omega_c \end{cases}$$
其中 $\omega_M < \omega_c < \omega_s - \omega_M$。滤波器的增益为 $T$ 是为了抵消采样过程中频谱幅度乘以 $1/T$ 的影响。
在工程实际应用中，理想滤波器是不可能实现的。而非理想滤波器一定有过渡带，因此，实际采样时，$\omega_s$ 必须大于 $2\omega_M$。

[Image 信号采样与重建系统框图及频谱变化 17]
![[Screenshot_20250516_093105.jpg|400]]
![[Screenshot_20250516_093131.jpg|200]]
图示了采样系统 $x(t) \rightarrow x_p(t)$，重建滤波器 $H(j\omega)$，以及恢复信号 $x_r(t)$。同时展示了各个阶段信号的频谱图。

低通滤波器的截止频率必须满足：
$$\omega_M < \omega_c < (\omega_s - \omega_M)$$

为了补偿采样时频谱幅度的减小，滤波器应具有 $T$ 倍的通带增益。

### 三. 零阶保持采样 (Zero-Order Hold)

在实际应用中，理想冲激采样难以实现。一种更实际的采样方式是零阶保持采样。
零阶保持系统是一个其单位冲激响应 $h_0(t)$ 为矩形脉冲的系统。
$$h_0(t) = \begin{cases} 1, & 0 \le t < T \\ 0, & \text{otherwise} \end{cases}$$
[Image 零阶保持系统及其单位冲激响应 18]
![[Screenshot_20250516_093204.jpg|300]]
图示了零阶保持系统的框图和其单位冲激响应 $h_0(t)$。

1.  **零阶保持系统：** 是一个 $h_0(t)$ 为矩形脉冲的系统。
2.  **零阶保持：** 信号的样本（理想采样后的冲激序列）经零阶保持后，所得到的信号 $x_0(t)$ 是一个阶梯形信号，每个采样值保持一个采样周期的宽度。

[Image 零阶保持采样过程和信号波形 19]
![[Screenshot_20250516_093235.jpg|300]]
图示了原始信号 $x(t)$，理想采样后的冲激序列 $x_p(t)$，经过零阶保持器 $h_0(t)$ 后得到的阶梯形信号 $x_0(t)$。
零阶保持采样相当于理想采样后，再级联一个零阶保持系统。

为了能从 $x_0(t)$ 恢复 $x(t)$，就要求零阶保持后再级联一个补偿系统 $H_r(j\omega)$，使得：
$$H_0(j\omega)H_r(j\omega) = H(j\omega) = \begin{cases} T, & |\omega| < \omega_c \\ 0, & |\omega| > \omega_c \end{cases}$$
其中 $\omega_M < \omega_c < \omega_s - \omega_M$。
零阶保持器的频率响应 $H_0(j\omega)$ 为：
$$H_0(j\omega) = \mathcal{F}\{h_0(t)\} = \int_0^T e^{-j\omega t} dt = \frac{1 - e^{-j\omega T}}{j\omega} = T \frac{\sin(\omega T/2)}{\omega T/2} e^{-j\omega T/2}$$
通常也写作：
$$H_0(j\omega) = \frac{2\sin(\omega T/2)}{\omega} e^{-j\frac{\omega T}{2}}$$

所以补偿滤波器 $H_r(j\omega)$ 的频率响应为：
$$H_r(j\omega) = \frac{H(j\omega)}{H_0(j\omega)} = \frac{H(j\omega)}{\frac{2\sin(\omega T/2)}{\omega} e^{-j\frac{\omega T}{2}}} = \frac{H(j\omega) \cdot \omega}{2\sin(\omega T/2)} e^{j\frac{\omega T}{2}}$$

【Image $H_0(j\omega)$, $H(j\omega)$, $|H_r(j\omega)|$, $\angle H_r(j\omega)$ 的频谱图 21】
![[Screenshot_20250516_212830.jpg|300]]
![[Screenshot_20250516_212850.jpg|300]]
图示了零阶保持器频率响应 $H_0(j\omega)$，理想低通滤波器 $H(j\omega)$，以及补偿滤波器 $H_r(j\omega)$ 的幅频特性和相频特性。
若 $\omega_c = \frac{1}{2}\omega_s = \frac{\pi}{T}$，则补偿滤波器的作用是在通带内校正零阶保持引入的幅度和相位失真。

## 7.2 利用内插从样本重建信号 (Reconstruction of a Signal from Its Samples Using Interpolation)

内插：由样本值重建某一函数的过程。

### 一. 理想内插

若 $h(t)$ 为理想低通滤波器的单位冲激响应，则重建信号 $x(t)$ (这里用 $x(t)$ 代表重建后的信号 $x_r(t)$) 为：
$$x(t) = x_p(t) * h(t) = \left( \sum_{n=-\infty}^{\infty} x(nT)\delta(t-nT) \right) * h(t)$$
$$x(t) = \sum_{n=-\infty}^{\infty} x(nT)h(t-nT)$$
表明：理想内插以理想低通滤波器的单位冲激响应作为内插函数。
理想低通滤波器的单位冲激响应 $h(t)$ (增益为 $T$，截止频率为 $\omega_c$) 为：
$$h(t) = T \cdot \frac{\sin(\omega_c t)}{\pi t} = \frac{T\omega_c}{\pi} \frac{\sin(\omega_c t)}{\omega_c t}$$

因此，重建信号为：
$$x(t) = \sum_{n=-\infty}^{\infty} x(nT)h(t-nT) = \sum_{n=-\infty}^{\infty} x(nT) \cdot \frac{T\omega_c}{\pi} \frac{\sin(\omega_c(t-nT))}{\omega_c(t-nT)}$$

当 $\omega_c = \frac{\omega_s}{2} = \frac{\pi}{T}$ 时 (即奈奎斯特频率的一半作为截止频率，滤波器的增益为1，而不是T，教材这里公式与前面H(jω)增益为T的设定有出入，通常sinc函数形式的内插，滤波器增益为1)，则：
$$h(t) = \frac{\sin(\pi t/T)}{\pi t/T} = \text{sinc}\left(\frac{t}{T}\right)$$
$$x(t) = \sum_{n=-\infty}^{\infty} x(nT) \frac{\sin(\frac{\pi}{T}(t-nT))}{\frac{\pi}{T}(t-nT)} = \sum_{n=-\infty}^{\infty} x(nT) \text{sinc}\left(\frac{t-nT}{T}\right)$$

这种内插称为时域中的带限内插或sinc内插。

[Image 时域中的带限内插过程示意图 24]
![[Screenshot_20250516_093340.jpg|250]]
图示了采样点序列 $x_p(t)$（冲激形式）和通过理想内插恢复的连续信号 $x_r(t)$。

### 二. 零阶保持内插

零阶保持内插的内插函数是零阶保持系统的单位冲激响应 $h_0(t)$。
$$x_0(t) = \sum_{n=-\infty}^{\infty} x(nT)h_0(t-nT)$$
这会产生一个阶梯状的波形。零阶保持可以看作是一种简单的内插方法，但它在频域会引入高频分量的衰减（sinc函数形状的包络）和相位失真。

[Image 零阶保持内插的频谱特性 25]
![[Screenshot_20250516_093423.jpg|300]]
图示了零阶保持 $H_0(j\omega)$ 的频谱特性，它不是一个理想的内插滤波器，会在 $-\omega_s/2$ 到 $\omega_s/2$ 频率范围外引入不必要的频率成分的衰减，同时在带内也有衰减。 

[Image 理想采样与零阶保持内插效果对比图 26, 27]
图26显示了理想采样（可能是指原始图像或更高采样率的图像）。 
图27显示了采样间隔为T/4，经过零阶保持内插后的图像，可以看到图像的块效应。 

### 三. 一阶保持内插 (线性内插)


线性内插时，其内插函数是三角形脉冲 $h_1(t)$。
$$h_1(t) = \begin{cases} 1 - \frac{|t|}{T}, & |t| \le T \\ 0, & |t| > T \end{cases}$$
[Image 一阶保持（线性内插）的单位冲激响应和频谱 28]
![[Screenshot_20250516_093558.jpg|200]]![[Screenshot_20250516_093611.jpg|200]]![[Screenshot_20250516_093624.jpg|200]]
图示了线性内插的单位冲激响应 $h_1(t)$ (三角形脉冲) 及其傅里叶变换 $H_1(j\omega)$。 
$$H_1(j\omega) = T \left[ \frac{\sin(\omega T/2)}{\omega T/2} \right]^2$$

一阶保持连接相邻的采样点形成折线，比零阶保持更平滑。

[Image 一阶保持内插效果图 29, 30]
图示了一阶保持内插（采样间隔为T/4）的结果，图像比零阶保持更平滑，但仍可能存在模糊。

## 7.3 欠采样的效果——频谱混叠 (The Effect of Undersampling : Aliasing)



### 一. 欠采样与频谱混叠


如果采样时，不满足采样定理的要求（即 $\omega_s < 2\omega_M$），就会在 $x(t)$ 的频谱周期延拓时，出现频谱的重叠，这种现象称为频谱混叠。
此时，即使通过理想内插（理想低通滤波器）也得不到原信号。恢复出的信号 $x_r(t)$ 的高频部分会被错误地解释为低频部分。但是，无论怎样，恢复所得的信号 $x_r(t)$ 与原信号 $x(t)$ 在采样点上将具有相同的值：
$$x_r(nT) = x(nT)$$


**例子：** $x(t) = \cos(\omega_0 t)$ 
其频谱 $X(j\omega) = \pi[\delta(\omega - \omega_0) + \delta(\omega + \omega_0)]$。
当采样频率 $\omega_s$ 满足 $\omega_0 < \omega_s < 2\omega_0$ 时（即欠采样），会产生频谱混叠。
[Image 欠采样导致频谱混叠的示意图 32]
![[Screenshot_20250516_093746.jpg|300]]
图示了原始信号频谱 $X(j\omega)$，采样后信号频谱 $X_p(j\omega)$ 由于 $\omega_s < 2\omega_0$ 发生混叠，以及通过理想低通滤波器（截止频率 $\omega_s/2$）后恢复的信号频谱 $X_r(j\omega)$。 
恢复的信号为：
$$x_r(t) = \cos((\omega_s - \omega_0)t)$$

原始信号的频率 $\omega_0$ 被错误地恢复为较低的频率 $|\omega_s - \omega_0|$。

显然当 $t=nT$ 时，有：
$$x_r(nT) = \cos((\omega_s - \omega_0)nT) = \cos(\omega_s nT - \omega_0 nT)$$
因为 $\omega_s T = 2\pi$，所以 $\omega_s nT = 2\pi n$。
$$x_r(nT) = \cos(2\pi n - \omega_0 nT) = \cos(-\omega_0 nT) = \cos(\omega_0 nT) = x(nT)$$

这验证了即使发生混叠，在采样点处的值仍然是相同的。

如果 $x(t) = \cos(\omega_0 t + \phi)$，则在上述欠采样情况下：
恢复信号的频谱为：
$$X_r(j\omega) = \pi\{\delta[\omega - (\omega_s - \omega_0)]e^{-j\phi} + \delta[\omega + (\omega_s - \omega_0)]e^{j\phi}\}$$
恢复的信号为：
$$x_r(t) = \cos((\omega_s - \omega_0)t - \phi)$$

表明恢复的信号不仅频率降低，而且相位也可能发生改变（这里是反相）。

**临界采样：** 
工程应用时，如果采样频率 $\omega_s = 2\omega_M$ (奈奎斯特频率)，理论上可以恢复信号，但实际中这可能不足以从样本恢复原信号，特别是当信号包含恰好在 $\omega_M$ 的分量且相位特定时。
例如 $x(t) = \cos(\omega_0 t + \phi)$，在 $\omega_s = 2\pi/T = 2\omega_0$ 时进行采样：
$$x(nT) = \cos(\omega_0 nT + \phi) = \cos(2\omega_0 nT/2 + \phi) = \cos(n\pi + \phi)$$
如果 $\phi = \pi/2$, $x(t) = \cos(\omega_0 t + \pi/2) = -\sin(\omega_0 t)$。
$x(nT) = \cos(n\pi + \pi/2) = 0$ 对所有 $n$。此时无法恢复信号。
教材例子： $x(t) = \cos\phi \cos\omega_0 t - \sin\phi \sin\omega_0 t$ (应为 +)
$x(nT) = \cos\phi \cos\omega_0 nT = \cos\phi \cos(n\pi)$。这和对 $x_1(t) = \cos\phi \cos\omega_0 t$ 采样的结果一样（当 $\omega_0 T = \pi$）。从用样本代替信号的角度出发，这种情况是工程应用中不希望的。 

### 二. 欠采样在工程实际中的应用

虽然频谱混叠通常是有害的，但在某些特定应用中可以加以利用。

1.  **采样示波器：**
    用于观测极高频周期信号。通过以一个略微偏离信号周期的整数倍的时间间隔 $(T_s = N T_0 + \Delta)$ 进行慢速采样，可以将高频信号等效变换到一个较低的频率上进行显示。
    采样脉冲串：
    $$p(t) = \sum_{n=-\infty}^{+\infty} \delta[t - n(T + \Delta)]$$
    [Image 采样示波器原理示意图 35]
    ![[Screenshot_20250516_093839.jpg|300]]
    图示了高频信号 $x(t)$，以 $T+\Delta$ 为周期的采样脉冲 $p(t)$，以及在示波器上显示的等效低频信号 $y(t)$。

2.  **频闪测速 (Stroboscope)：**
    利用视觉暂留原理。用一个频率可调的闪光灯照射旋转物体。当闪光频率 $\omega_s$ 是物体旋转频率 $\omega_0$ 的整数倍或接近整数倍时，物体看起来会静止或缓慢转动。
    [Image 频闪测速示意图（旋转圆盘和频闪器）35]
	
    [Image 不同频闪频率下观察到的旋转圆盘状态 36]
    图示了当频闪频率 $\omega_s$ 与物体固有频率 $\omega_0$ 关系不同时（例如 $\omega_s = 4\omega_0, \omega_s = 2\omega_0, \omega_s = \frac{4}{3}\omega_0, \omega_s = \omega_0$）观察到的现象。
    -   $\omega_s = k\omega_0$ (k为整数): 物体看起来静止。
    -   $\omega_s$ 略大于 $k\omega_0$: 物体看起来缓慢反向转动。
    -   $\omega_s$ 略小于 $k\omega_0$: 物体看起来缓慢正向转动。

## 7.4 连续时间信号的离散时间处理 (Discrete-Time Processing of Continuous-Time Signals)

许多信号处理任务可以通过数字方式实现，即将连续时间信号转换为离散时间信号，用数字系统处理，然后再转换回连续时间信号。
对连续时间信号进行离散时间处理的系统可视作三个环节的级联：
1.  **C/D (Continuous-to-Discrete) 转换器：** 将连续时间信号 $x_c(t)$ 转换为离散时间序列 $x_d(n)$。这通常包括理想采样和将冲激串转换为序列。
2.  **离散时间系统：** 对 $x_d(n)$ 进行处理，得到输出序列 $y_d(n)$。其特性由 $H_d(e^{j\Omega})$ 描述。
3.  **D/C (Discrete-to-Continuous) 转换器：** 将离散时间序列 $y_d(n)$ 转换回连续时间信号 $y_c(t)$。这通常包括将序列转换为冲激串，然后通过一个理想低通重建滤波器。

[Image 连续时间信号的离散时间处理系统框图 37]
![[Screenshot_20250516_093923.jpg|300]]
$x_c(t) \xrightarrow{C/D} x_d(n) \xrightarrow{\text{离散时间系统}} y_d(n) \xrightarrow{D/C} y_c(t)$
等效为一个对 $x_c(t)$ 进行处理的连续时间系统 $H(j\omega)$。

### 一. C/D 转换

C/D转换包含两个步骤：
1.  **冲激串采样：** $x_p(t) = x_c(t) \cdot p(t) = \sum_{n=-\infty}^{\infty} x_c(nT)\delta(t-nT)$
2.  **冲激串到序列的转换：** $x_d(n) = x_c(nT)$

在时域：
$p(t) = \sum_{n=-\infty}^{\infty} \delta(t-nT)$
$x_p(t) = x_c(t) \cdot p(t) = \sum_{n=-\infty}^{\infty} x_c(nT)\delta(t-nT)$
$x_d(n) = x_c(nT)$

在频域：
$P(j\omega) = \frac{2\pi}{T} \sum_{k=-\infty}^{\infty} \delta(\omega - k\omega_s)$, $\omega_s = \frac{2\pi}{T}$
$X_p(j\omega) = \frac{1}{T} \sum_{k=-\infty}^{\infty} X_c(j(\omega - k\omega_s))$

离散时间傅里叶变换 (DTFT) $X_d(e^{j\Omega})$ 与 $X_p(j\omega)$ 的关系：
$x_d(n) = x_c(nT) \Rightarrow X_d(e^{j\Omega}) = \sum_{n=-\infty}^{+\infty} x_c(nT)e^{-j\Omega n}$

而 $X_p(j\omega) = \sum_{n=-\infty}^{\infty} x_c(nT)e^{-j\omega nT}$。

比较两者，令 $\Omega = \omega T$，则 $X_p(j\omega) = X_d(e^{j\omega T})$。
或者 $X_d(e^{j\Omega}) = X_p(j\frac{\Omega}{T})$。
所以，
$$X_d(e^{j\Omega}) = X_p(j\frac{\Omega}{T}) = \frac{1}{T} \sum_{k=-\infty}^{\infty} X_c\left(j\frac{1}{T}(\Omega - 2\pi k)\right)$$

其中 $\Omega$ 是归一化数字角频率，$\omega$ 是模拟角频率。
冲激串到序列的变换过程，在时域是一个对时间进行归一化的过程 ($t \rightarrow nT \rightarrow n$)；在频域是一个对频率进行归一化（或去归一化）的过程 ($\omega \rightarrow \Omega = \omega T$)。 

[Image C/D转换中频谱的变化过程 40]
![[屏幕截图 2025-05-28 225008.png|400]]
图示了原始连续信号频谱 $X_c(j\omega)$，经过理想采样后的频谱 $X_p(j\omega)$（周期延拓），以及转换成离散序列后的频谱 $X_d(e^{j\Omega})$（频率轴缩放 $\Omega = \omega T$）。 

### 二. D/C 转换


D/C转换也包含两个步骤：
1.  **序列到冲激串的转换：** $y_p(t) = \sum_{n=-\infty}^{\infty} y_d(n)\delta(t-nT)$
2.  **理想低通滤波：** $y_c(t) = y_p(t) * h(t)$，其中 $h(t)$ 是截止频率为 $\omega_c = \omega_s/2 = \pi/T$ 的理想低通滤波器的冲激响应，增益为 $T$。

$Y_p(j\omega) = \sum_{n=-\infty}^{\infty} y_d(n)e^{-j\omega nT}$
$Y_d(e^{j\Omega}) = \sum_{n=-\infty}^{\infty} y_d(n)e^{-j\Omega n}$
所以，$Y_p(j\omega) = Y_d(e^{j\omega T})$ 或者 $Y_d(e^{j\Omega}) = Y_p(j\frac{\Omega}{T})$。

可见，D/C转换是C/D转换的逆过程（在频谱关系上）。 
[Image D/C转换系统框图 41]
![[屏幕截图 2025-05-28 225032.png|300]]

### 三. 连续时间信号的离散时间处理


整个系统的框图：
[Image 连续时间信号的离散时间处理完整系统框图 42]
![[屏幕截图 2025-05-28 225051.png|400]]
$x_c(t) \xrightarrow{C/D: x_p(t), x_d(n)} \xrightarrow{H_d(e^{j\Omega}): y_d(n)} \xrightarrow{D/C: y_p(t), y_c(t)}$
假定离散时间系统为恒等系统，即 $H_d(e^{j\Omega}) = 1$，则 $y_d(n) = x_d(n)$。如果采样满足采样定理，那么 $y_p(t) = x_p(t)$，并且通过理想低通滤波器后 $y_c(t) = x_c(t)$。这表明理想C/D和D/C转换互为逆系统。 

对一般情况： 
$Y_d(e^{j\Omega}) = X_d(e^{j\Omega}) \cdot H_d(e^{j\Omega})$
$Y_p(j\omega) = Y_d(e^{j\omega T}) = X_d(e^{j\omega T}) H_d(e^{j\omega T}) = X_p(j\omega) H_d(e^{j\omega T})$

最终输出信号 $y_c(t)$ 的频谱 $Y_c(j\omega)$ 是 $Y_p(j\omega)$ 经过理想低通滤波器 $H(j\omega)$ (截止频率 $\omega_s/2 = \pi/T$，增益为 $T$) 后的结果。
$$H(j\omega) = \begin{cases} T, & |\omega| < \omega_s/2 \\ 0, & |\omega| > \omega_s/2 \end{cases}$$
$$Y_c(j\omega) = Y_p(j\omega) H(j\omega)$$

当 $|\omega| < \omega_s/2$ 时：
$X_p(j\omega) = \frac{1}{T}X_c(j\omega)$ （假设没有混叠，只考虑基带）
$Y_c(j\omega) = \left( \frac{1}{T}X_c(j\omega) H_d(e^{j\omega T}) \right) \cdot T = X_c(j\omega) H_d(e^{j\omega T})$
所以，等效的连续时间系统频率响应 $H_c(j\omega)$ 为：
$$H_c(j\omega) = \begin{cases} H_d(e^{j\omega T}), & |\omega| < \omega_s/2 \\ 0, & |\omega| > \omega_s/2 \end{cases}$$

或者用归一化频率表示：
$H_c(j\frac{\Omega}{T}) = H_d(e^{j\Omega})$ for $|\Omega| < \pi$. 

[Image 离散时间处理各阶段频谱变化图 45]
![[屏幕截图 2025-05-28 225113.png|400]]
图示了从 $X_c(j\omega)$ 到 $X_p(j\omega)$ 到 $X_d(e^{j\Omega})$，然后经过 $H_d(e^{j\Omega})$ 得到 $Y_d(e^{j\Omega})$，再到 $Y_p(j\omega)$，最后经过低通滤波器得到 $Y_c(j\omega)$ 的整个频谱演变过程。同时也显示了等效的 $H_c(j\omega)$。 

可见，等效连续时间系统的频率响应，就是离散时间系统频率响应在一个周期 $(-\pi, \pi)$ 内的特性，只不过在频率轴上有一个尺度变换 $\Omega = \omega T$，并且带限于 $\omega_s/2$。 
[Image $H_d(e^{j\Omega})$ 和等效的 $H_c(j\omega)$ 的关系图 46]
![[屏幕截图 2025-05-28 225137.png|400]]

对连续时间信号进行离散时间处理的系统只有在 $x_c(t)$ 带限，且采样频率满足采样定理的要求时才能等效为一个LTI（线性时不变）系统。 

**例：数字微分器** 
理想的连续时间带限微分器：
$$H_c(j\omega) = \begin{cases} j\omega, & |\omega| < \omega_c \\ 0, & |\omega| > \omega_c \end{cases}$$
[Image 理想带限微分器的幅频和相频特性 47]
![[屏幕截图 2025-05-28 225203.png|300]]
其中 $\omega_c$ 为系统的有效带宽，这里假设 $\omega_c = \omega_s/2 = \pi/T$。
对应的离散时间微分器的频率响应 $H_d(e^{j\Omega})$ 满足 $H_d(e^{j\Omega}) = H_c(j\frac{\Omega}{T})$ for $|\Omega| < \pi$。
$$H_d(e^{j\Omega}) = j\frac{\Omega}{T}, \quad |\Omega| < \pi$$

[Image 连续时间微分器 $H_c(j\omega)$ 和对应离散时间微分器 $H_d(e^{j\Omega})$ 的幅频和相频特性 48]
![[屏幕截图 2025-05-28 225229.png|400]]
## 7.5 离散时间信号采样 (Sampling of Discrete-Time Signals)


与连续时间信号采样类似，离散时间信号也可以被采样，通常称为抽取 (Decimation) 或下采样 (Downsampling)。

### 一. 脉冲串采样


对离散时间信号 $x(n)$ 进行脉冲串采样，采样间隔为 $N$ (整数)。
采样脉冲串 $p(n) = \sum_{k=-\infty}^{\infty} \delta(n-kN)$。
采样后的信号 $x_p(n) = x(n) \cdot p(n) = \sum_{k=-\infty}^{\infty} x(kN)\delta(n-kN)$。
[Image 离散时间信号及其采样脉冲串和采样后信号 49]
![[屏幕截图 2025-05-28 225252.png|300]]

频谱关系：
$P(e^{j\omega}) = \text{DTFT}\{p(n)\} = \frac{2\pi}{N} \sum_{k=0}^{N-1} \delta\left(\omega - \frac{2\pi}{N}k\right)$ (在一个 $2\pi$ 周期内) 或 $\frac{2\pi}{N}\sum_{k=-\infty}^{\infty}\delta(\omega-\frac{2\pi}{N}k)$。 
$X_p(e^{j\omega}) = \frac{1}{2\pi} X(e^{j\omega}) \circledast P(e^{j\omega})$ (圆周卷积)
$$X_p(e^{j\omega}) = \frac{1}{N} \sum_{k=0}^{N-1} X\left(e^{j(\omega - \frac{2\pi k}{N})}\right)$$
或更一般地：
$$X_p(e^{j\omega}) = \frac{1}{N} \sum_{k=-\infty}^{+\infty} X\left(e^{j(\omega - \frac{2\pi k}{N})}\right)$$

这表明，时域以 $N$ 为间隔对离散时间信号采样，频域是将原信号频谱 $X(e^{j\omega})$ 以 $2\pi/N$ 为间隔进行周期延拓并叠加，幅度乘以 $1/N$。 [source 50, source 51]

[Image 离散时间信号采样前后的频谱 50]
![[屏幕截图 2025-05-28 225311.png|400]]
图示了原始离散信号频谱 $X(e^{j\omega})$，采样脉冲串频谱 $P(e^{j\omega})$，以及采样后信号频谱 $X_p(e^{j\omega})$。 

要使 $x_p(n)$ 能恢复成 $x(n)$，则频谱在周期性延拓时不能发生混叠。为此要求： 
1.  $x(n)$ 带限于 $\omega_M$ (即 $|X(e^{j\omega})| = 0$ for $\omega_M < |\omega| \le \pi$)。
2.  采样频率（角频率间隔）$\omega_s = 2\pi/N > 2\omega_M$。

此时可以通过离散时间理想低通滤波器恢复信号 $x(n)$。 
该滤波器的频率响应 $H(e^{j\omega})$ 为：
$$H(e^{j\omega}) = \begin{cases} N, & |\omega| < \omega_c \\ 0, & \omega_c < |\omega| \le \pi \end{cases}$$
其中 $\omega_M < \omega_c < (\frac{2\pi}{N} - \omega_M)$。通带增益为 $N$ 是为了抵消采样带来的 $1/N$ 幅度因子。
[Image 离散时间信号采样与重建系统及理想低通滤波器特性 51, 52]
![[屏幕截图 2025-05-28 225330.png|300]]
![[屏幕截图 2025-05-28 225346.png|300]]
恢复 $x(n)$ 的过程也是一种带限内插，内插函数为理想低通滤波器的单位脉冲响应 $h(n)$。 
$$x_r(n) = x_p(n) * h(n) = \sum_{k=-\infty}^{\infty} x(kN)h(n-kN)$$
其中 $h(n) = \text{IDTFT}\{H(e^{j\omega})\}$。对于截止频率为 $\omega_c$、增益为 $N$ 的理想低通滤波器：
$$h(n) = N \frac{\sin(\omega_c n)}{\pi n}$$

如果选择 $\omega_c = \pi/N$ (奈奎斯特截止频率)，则：
$$h(n) = N \frac{\sin(\pi n/N)}{\pi n} = \frac{\sin(\pi n/N)}{(\pi n/N)}$$
$$x_r(n) = \sum_{k=-\infty}^{\infty} x(kN) \frac{\sin(\frac{\pi}{N}(n-kN))}{\frac{\pi}{N}(n-kN)}$$


### 二. 离散时间抽取与内插 (Discrete-Time Decimation and Interpolation)


**抽取 (Decimation)：**
如果 $x_d(n) = x_p(nN) = x(nN)$，则把由 $x(n)$ 经过（隐式的脉冲串采样）$x_p(n)$ 到 $x_d(n)$ 的过程称为抽取（或下采样）。它直接从 $x(n)$ 中每隔 $N$ 个点取一个点。
$$x(n) \xrightarrow{\text{抽取因子 N}} x_d(m) = x(mN)$$
(这里用 $m$ 作为抽取后序列的索引，教材用 $n$ 但指代 $x_d(n)$)
$x_d(n) = x(nN)$ (教材写法，其中 $x_d$ 的索引 $n$ 对应原序列的 $nN$ 时刻) 
这个过程通常表示为 $x(n) \rightarrow \downarrow N \rightarrow x_d(n)$。

[Image 抽取过程的系统框图 54]
![[屏幕截图 2025-05-28 225414.png|300]]
$x(n) \xrightarrow{\text{脉冲串采样 } p(n)} x_p(n) \xrightarrow{\text{到序列}} x_d(n)$ 
若直接从 $x(n)$ 抽取得到 $x_d(n)$（即 $x_d(m) = x(mN)$），这个过程一般是不可逆的，除非 $x(n)$ 在抽取前经过了合适的抗混叠滤波且满足采样定理。
当 $x(n)$ 满足采样定理，即其频谱带限于 $\pi/N$，则经过 $x_p(n)$ 再到 $x_d(n)$ 的过程是可逆的。 

**抽取过程在频域的反映：** 
设 $x_d(m) = x(mN)$ (这里用 $m$ 表示新序列的索引)。
其DTFT为 $X_d(e^{j\omega}) = \sum_{m=-\infty}^{\infty} x(mN) e^{-j\omega m}$。
与通过脉冲串采样 $x_p(n) = \sum_{k=-\infty}^{\infty} x(kN)\delta(n-kN)$ 后转换为序列 $x_d'(n) = x_p(nN) = x(nN)$ (这里 $x_d'$ 的索引 $n$ 对应 $k$) 的关系：
$X_d(e^{j\omega}) = X_p(e^{j\frac{\omega}{N}})$ (这里 $X_p$ 是采样后但未压缩时间轴的信号 $x_p(n)$ 的频谱，而 $X_d$ 是 $x_d(n)=x(nN)$ 的频谱，频率轴被扩展了N倍)
教材公式：$X_d(e^{j\omega}) = X_p(e^{j\frac{\omega}{N}})$ 
其中 $X_p(e^{j\omega}) = \frac{1}{N} \sum_{k=0}^{N-1} X(e^{j(\omega - \frac{2\pi k}{N})})$。
所以，
$$X_d(e^{j\omega}) = \frac{1}{N} \sum_{k=0}^{N-1} X\left(e^{j\left(\frac{\omega - 2\pi k}{N}\right)}\right)$$
这表明，在时域对带限序列进行抽取，相当于在频域对采样序列的频谱进行尺度扩展（展宽 $N$ 倍）并叠加。如果没有预先的抗混叠滤波，高频成分会混叠到低频。

[Image 抽取过程的时域和频域表示 ($N=3$) 55, 56]
![[屏幕截图 2025-05-28 225442.png|200]]
![[屏幕截图 2025-05-28 225509.png|300]]
时域：$x(n) \rightarrow p(n) \rightarrow x_p(n) \rightarrow x_d(n)$ (每N点取一点) 
频域：$X(e^{j\omega}) \rightarrow X_p(e^{j\omega})$ (频谱周期延拓) $\rightarrow X_d(e^{j\omega})$ (频谱展宽N倍) 

[Image 连续信号采样再离散信号抽取与直接NT采样关系图 57, 58, 59]
![[屏幕截图 2025-05-28 225538.png|400]]
![[屏幕截图 2025-05-28 225613.png|400]]
如果一个连续信号 $x_c(t)$ 首先以周期 $T$ 采样得到 $x(n) = x_c(nT)$ ，其频谱为 $X(e^{j\omega}) = \frac{1}{T} \sum_k X_c(j(\frac{\omega-2\pi k}{T}))$。
然后对 $x(n)$ 以 $N$ 为间隔进行抽取得到 $x_d(m) = x(mN) = x_c(mNT)$ [source 58, source 59]。
$X_d(e^{j\omega})$ 的频谱是 $X(e^{j\omega/N})$ 再进行适当的求和与幅度调整。
这等效于直接对 $x_c(t)$ 以 $NT$ 为采样间隔进行采样。 

**内插 (Interpolation / Upsampling)：**
与抽取相反，内插是在离散信号的样本点之间插入新的样本点，通常是插入零值（补零），然后通过一个低通滤波器平滑。
$x(n) \rightarrow \uparrow L \rightarrow x_i(n)$ (在样本间插入 $L-1$ 个零) $\rightarrow \text{低通滤波} \rightarrow y(n)$
$x_i(n) = \begin{cases} x(n/L), & \text{if } n \text{ is a multiple of } L \\ 0, & \text{otherwise} \end{cases}$
其频谱 $X_i(e^{j\omega}) = X(e^{j\omega L})$。频谱被压缩了 $L$ 倍，并在 $(-\pi, \pi]$ 区间内产生了 $L-1$ 个镜像。低通滤波器用于去除这些镜像。

### 三. 抽取与内插的应用：半抽样间隔延时


目标：产生 $y_c(t) = x_c(t - \Delta)$，其中 $\Delta = T/2$ (半个采样周期的延时)。
这不能直接用离散系统对 $x(n)=x_c(nT)$ 实现，因为 $n-1/2$ 不是整数。
方法：
1.  对 $x(n)$ 进行内插（例如因子 $N=2$），得到 $x_1(n')$，其采样周期等效为 $T/2$。
2.  对 $x_1(n')$ 进行整数延时，例如延时1个单位得到 $x_2(n') = x_1(n'-1)$。
3.  对 $x_2(n')$ 进行抽取（例如因子 $N=2$），得到 $x_3(m)$。
    或者，将 $x_1(n')$ （内插后的序列）通过D/C转换回连续信号 $y_c(t)$，则 $y_c(t)$ 近似为 $x_c(t - T/2)$ （如果内插和延时设计得当）。

[Image 半抽样间隔延时系统框图及各点信号 59, 60, 61]
![[屏幕截图 2025-05-28 225646.png|500]]
![[屏幕截图 2025-05-28 225723.png|500]]
![[屏幕截图 2025-05-28 225744.png|500]]
框图：$x_c(t) \xrightarrow{C/D (T)} x(n) \xrightarrow{\text{内插 } N=2} x_1(n) \xrightarrow{\text{延时 } z^{-1}} x_2(n-1) \xrightarrow{\text{抽取 } N=2} x_3(n) \xrightarrow{D/C (T)} y_c(t)$ [source 59, 60, 61]
如果理想内插和抽取，并且离散系统是单位延时，那么 $x_3(n)$ 对应的连续信号 $y_c(t)$ 应该是 $x_c(t-T/2)$。
$x_3(n) = x(n - \Delta/T)$ 在这里 $\Delta/T = 1/2$。所以 $x_3(n)$ 试图表示 $x(n-1/2)$。 

## 7.6 频域采样 (Sampling in Frequency Domain)

采样的本质是将连续变量的函数离散化。因此，在频域也可以对连续的频谱进行采样。这一过程与时域采样是完全对偶的。

对连续频谱 $X(j\omega)$ 进行频域采样，采样间隔为 $\omega_0$。
频域采样函数 $P(j\omega) = \sum_{k=-\infty}^{\infty} \delta(\omega - k\omega_0)$。
频域采样后的频谱 $\tilde{X}_p(j\omega) = X(j\omega)P(j\omega) = \sum_{k=-\infty}^{\infty} X(k\omega_0)\delta(\omega - k\omega_0)$。

根据对偶性，时域采样导致频域周期延拓；频域采样导致时域周期延拓。
时域对应信号 $\tilde{x}_p(t) = \frac{1}{2\pi} x(t) * p(t)$，其中 $p(t) = \mathcal{F}^{-1}\{P(j\omega)\}$。
$p(t) = \frac{1}{2\pi} \int_{-\infty}^{\infty} \sum_{k=-\infty}^{\infty} \delta(\omega - k\omega_0) e^{j\omega t} d\omega = \frac{1}{2\pi} \sum_{k=-\infty}^{\infty} e^{jk\omega_0 t}$。
这不是教材给出的 $p(t)=\frac{1}{\omega_{0}}\sum_{k=-\infty}^{\infty}\delta(t-\frac{2\pi}{\omega_{0}}k)$。
教材的推导：$p(t) = \mathcal{F}^{-1}\{P(j\omega)\}$。如果 $P(j\omega)$ 是间隔为 $\omega_0$ 的冲激串，那么其反变换 $p(t)$ 是间隔为 $T_0 = 2\pi/\omega_0$ 的冲激串，幅度为 $\omega_0/(2\pi)$ 或 $1/T_0$。
教材给出：$p(t) = \frac{1}{\omega_0} \sum_{k=-\infty}^{\infty} \delta(t - \frac{2\pi}{\omega_0}k)$ (这里幅度因子可能有误，应为 $1/(2\pi)$ 乘以频域冲激串的幅度，或者直接由对偶性，时域冲激串 $\sum \delta(t-kT_0)$ 对应频域冲激串 $\frac{2\pi}{T_0} \sum \delta(\omega - k\frac{2\pi}{T_0})$)。
假设 $P(j\omega)=\sum_{k=-\infty}^{\infty}\delta(\omega-k\omega_{0})$，则 $p(t) = \frac{1}{2\pi} \sum_{k=-\infty}^{\infty} e^{jk\omega_0 t}$。
$\tilde{x}_p(t) = x(t) * p(t) = x(t) * \left( \frac{1}{2\pi} \sum_{k=-\infty}^{\infty} e^{jk\omega_0 t} \right)$
这与教材的 $\tilde{x}_p(t) = \frac{1}{\omega_0} \sum_{k=-\infty}^{\infty} x(t - \frac{2\pi}{\omega_0}k)$ 不同。 

**频域采样定理 (对偶于时域采样定理)：**
如果一个信号 $x(t)$ 是时限的，即 $x(t)=0$ for $|t| > T_M$，那么它的频谱 $X(j\omega)$ 可以由其在频域的采样点 $X(jk\omega_0)$唯一确定，条件是频域采样间隔 $\omega_0 \le \pi/T_M$ (即频域采样频率 $F_s = \omega_0/(2\pi) \le 1/(2T_M)$)。
此时，$\tilde{x}_p(t)$ 是 $x(t)$ 以 $T_p = 2\pi/\omega_0$ 为周期的周期延拓。为了不发生时域混叠，要求 $T_p \ge 2T_M$，即 $2\pi/\omega_0 \ge 2T_M$，所以 $\omega_0 \le \pi/T_M$。 

[Image 频域采样与时域周期延拓示意图 62, 63, 64]
![[屏幕截图 2025-05-28 225806.png|300]]
![[屏幕截图 2025-05-28 225856.png|300]]
图示了 $X(j\omega)$, $P(j\omega)$, $\tilde{X}_p(j\omega)$ (频域采样后的频谱)，以及对应的时域信号 $x(t)$ 和 $\tilde{x}_p(t)$ (周期延拓后的时域信号)。 [source 62, 63, 64]

**从频域样本重建频谱：** 
如果满足频域采样定理，可以通过在时域加窗（乘以一个矩形窗 $w(t)$）来从周期信号 $\tilde{x}_p(t)$ 中恢复出 $x(t)$。
$$w(t) = \begin{cases} 1, & |t| < T_M' \\ 0, & |t| > T_M' \end{cases}$$
其中 $T_M < T_M' < T_p - T_M$。如果取 $T_M' = \pi/\omega_0 = T_p/2$ (假设 $T_p = 2T_M$ 为临界情况，窗宽为 $T_p$)。
教材中窗函数 $w(t)=\begin{cases}\omega_{0}&|t|\le\pi/\omega_{0}\\ 0&|t|>\pi/\omega_{0}\end{cases}$，这里的幅度 $\omega_0$ 可能是为了补偿。 
$x(t) = \tilde{x}_p(t) w(t)$ (如果 $w(t)$ 幅度为1)
在频域，这对应于卷积：
$X(j\omega) = \frac{1}{2\pi} \tilde{X}_p(j\omega) * W(j\omega)$
其中 $W(j\omega) = \mathcal{F}\{w(t)\}$。如果 $w(t)$ 是宽度为 $2\pi/\omega_0$、幅度为1的矩形窗，则 $W(j\omega) = \frac{2\sin(\pi\omega/\omega_0)}{\omega/\omega_0} = \frac{2\pi}{\omega_0} \text{sinc}(\frac{\omega}{\omega_0})$ (这里sinc定义为 $\sin(\pi x)/(\pi x)$)。
教材内插公式：
$$X(j\omega) = \sum_{k=-\infty}^{\infty} X(k\omega_0) \text{sinc}\left(\frac{\omega - k\omega_0}{\omega_0}\right)$$

这里的sinc函数通常定义为 $\text{sinc}(x) = \sin(\pi x)/(\pi x)$，所以 $\text{sinc}(\frac{\omega-k\omega_0}{\omega_0}) = \frac{\sin(\pi(\omega-k\omega_0)/\omega_0)}{\pi(\omega-k\omega_0)/\omega_0}$。这对应于频域的理想低通(或带通)内插。

**重要指出：** 
带限信号一定不时限；时限信号一定不带限。（不确定性原理的体现）
这意味着严格的带限信号不能进行无混叠的频域采样，严格的时限信号不能进行无混叠的时域采样。实际中都是近似处理。

对有限长的离散时间信号 $x(n)$ (长度为 $N$)，其频谱 $X(e^{j\omega})$ 是以 $2\pi$ 为周期的连续函数。
可以在频域对其进行采样，例如取 $M$ 个等间隔的采样点 $X(e^{j 2\pi k/M})$ for $k=0, 1, \dots, M-1$。这就是离散傅里叶变换 (DFT) 的基础。
为了能从这些频域样本完全恢复原信号（或其等效的周期延拓），必须保证 $M \ge N$。如果 $M < N$，则会发生时域混叠。 

## 7.7 小结 (Summary)


1.  连续时间信号的时域采样，采样定理。
2.  从样本通过内插重建信号（理想内插、零阶保持、一阶保持）。
3.  欠采样引起的频谱混叠，及其在工程实际中的某些应用（采样示波器、频闪测速）。
4.  连续时间信号的离散时间处理及其等效系统。
5.  离散时间信号的时域采样（抽取）与内插。
6.  频域采样及其与时域信号特性的对偶关系。
