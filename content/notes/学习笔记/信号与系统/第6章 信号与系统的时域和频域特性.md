## 第五章 回顾

第五章与第四章平行地讨论了离散时间傅里叶变换 (DTFT)，基本思路和方法与第四章的连续时间傅里叶变换 (CTFT) 完全对应，得到的许多结论也很类似。

通过对DTFT性质的讨论，揭示了离散时间信号时域与频域特性的关系。不仅看到有许多性质在CTFT中都有相对应的结论，而且它们也存在一些重要的差别，例如DTFT总是以 $2\pi$ 为周期的。

通过卷积特性的讨论，对LTI系统建立了频域分析的方法。同样地，相乘特性的存在则为离散时间信号的传输技术提供了理论基础。

对偶性的讨论为进一步认识连续时间信号、离散时间信号、周期信号与非周期信号频域描述的几种工具之间的内在联系，提供了重要的理论根据。深入理解并恰当运用对偶性，对深刻掌握 CFS (连续时间傅里叶级数)、DFS (离散傅里叶级数)、CTFT、DTFT的本质关系有很大帮助。

**对偶关系归纳**
[Image 表格形式的对偶关系总结 3]
![[屏幕截图 2025-05-27 222231.png|400]]

时域 | 频域 | 变换对与说明
---|---|---
连续、周期 ($x(t)$) | 离散、非周期 ($a_k$) | 连续时间傅立叶级数 (CFS): $x(t) \leftrightarrow a_k$
&nbsp; | &nbsp; | 时域采样导致频域周期延拓，频域采样 $a_k = \frac{1}{T}X(j\frac{2\pi}{T}k)$
连续、非周期 ($x(t)$) | 连续、非周期 ($X(j\omega)$) | 连续时间傅立叶变换 (CTFT): $x(t) \leftrightarrow X(j\omega)$
&nbsp; | &nbsp; | 对偶性: $X(jt) \leftrightarrow 2\pi x(-\omega)$
离散、周期 ($x(n)$) | 离散、周期 ($a_k$) | 离散时间傅立叶级数 (DFS): $x(n) \leftrightarrow a_k$
&nbsp; | &nbsp; | 对偶性: $a_n \leftrightarrow \frac{1}{N}x(-k)$
&nbsp; | &nbsp; | 频域采样 $a_k = \frac{1}{N}X(e^{j\frac{2\pi}{N}k})$
离散、非周期 ($x(n)$) | 连续、周期 ($X(e^{j\omega})$) | 离散时间傅立叶变换 (DTFT): $x(n) \leftrightarrow X(e^{j\omega})$
&nbsp; | &nbsp; | 对偶性: $X(e^{jt}) \stackrel{CFS}{\longleftrightarrow} \frac{1}{2\pi} \sum_k x(-k) \delta(\omega - \frac{2\pi k}{T_0})$ (这里的对偶性表述与原图稍有不同，原图为 $X(e^{jt}) \stackrel{CFS}{\rightarrow} x(-k)$, 应理解为从一个周期信号的傅里叶级数系数反推原离散信号)

与连续时间LTI系统一样，对由LCCDE (线性常系数差分方程) 或由方框图描述的LTI系统，可以很方便地由方程或方框图得到系统的频率响应函数 $H(e^{j\omega})$，进而实现系统的频域分析。其基本过程和涉及到的问题与连续时间LTI系统的情况也完全类似。随着今后进一步的讨论，我们可以看到CFS、DFS、CTFT、DTFT之间是完全相通的。

---

## 本章主要内容
* 傅立叶变换的模与相位。
* LTI系统的幅频特性与相频特性，系统的失真。
* 系统的不失真传输条件。
* 理想滤波器的频域、时域特性及其不可实现性。
* 非理想滤波器的特性及其逼近方式。
* 一阶与二阶系统的分析方法，Bode图。

---
## 6.0 引言 Introduction

在以前的讨论中，已经看到：
* 在时域，系统的特性由其冲激响应 $h(t)$ (连续时间) 或 $h(n)$ (离散时间) 描述。
* 在频域，系统的特性由其频率响应 $H(j\omega)$ (连续时间) 或 $H(e^{j\omega})$ (离散时间) 描述。

工程中设计系统时，往往会对系统的特性从时域角度或频域角度提出某些要求。

在LTI 系统分析中，由于时域中的微分 (或差分) 方程和卷积运算在频域都变成了代数运算，所以利用频域分析往往特别方便。例如，时域卷积 $y(t) = x(t) * h(t)$ 对应频域相乘 $Y(j\omega) = X(j\omega)H(j\omega)$。

系统的时域特性与频域特性是相互制约的。在进行系统的分析与设计时，要权衡考虑系统的时域与频域特性。本章的基本内容旨在建立对系统的时域和频域特性进行综合分析的思想和方法。

---
## 6.1 傅里叶变换的模和相位表示 (The Magnitude-Phase Representation of the Fourier Transform)

无论CTFT还是DTFT，一般情况下都表现为一个复函数。
对于连续时间信号 $x(t)$，其傅里叶变换 $X(j\omega)$ 可以表示为：
$X(j\omega) = |X(j\omega)|e^{j\angle X(j\omega)}$
其中 $|X(j\omega)|$ 是幅度谱，$\angle X(j\omega)$ 是相位谱。

对于离散时间信号 $x(n)$，其傅里叶变换 $X(e^{j\omega})$ 可以表示为：
$X(e^{j\omega}) = |X(e^{j\omega})|e^{j\angle X(e^{j\omega})}$
其中 $|X(e^{j\omega})|$ 是幅度谱，$\angle X(e^{j\omega})$ 是相位谱。

这说明：一个信号所携带的全部信息分别包含在其频谱的模和相位中。

因此，导致信号失真的原因有两种：
1.  **幅度失真 (Amplitude Distortion)**: 由于频谱的模改变而引起的失真。各频率分量幅度产生不同程度的衰减或放大。
2.  **相位失真 (Phase Distortion)**: 由于频谱的相位改变引起的失真。各频率分量产生的相移不与频率成正比 (即非线性相移)，使响应的各频率分量在时间轴上的相对位置产生变化，从而导致波形改变。

在工程实际中，不同的应用场合，对幅度失真和相位失真有不同的敏感程度，也会有不同的技术指标要求。例如，在音频信号处理中，人耳对相位失真相对不敏感，但对幅度失真非常敏感。而在数字通信中，相位失真可能导致码间串扰，严重影响系统性能。

**二维傅里叶变换的模与相位示例**
[Image 二维傅里叶变换的模 (c), 二维傅里叶变换的相位 (d), 模保持相位为0的图像 (e), 相位保持模全1的图像 (f), 相位保持模换为(g)的模 10, 11]
![[屏幕截图 2025-05-27 222313.png|400]]
这些图像直观地展示了在图像处理中，幅度和相位信息各自的重要性。通常，相位信息对于图像的结构和特征更为关键。

---
## 6.2 LTI系统频率响应的模和相位表示 (The Magnitude-Phase Representation of the Frequency Response of LTI Systems)

LTI系统对输入信号所起的作用包括两个方面：
1.  改变输入信号各频率分量的幅度。
2.  改变输入信号各频率分量的相对相位。

输入信号 $X(j\omega)$ 或 $X(e^{j\omega})$，系统频率响应 $H(j\omega)$ 或 $H(e^{j\omega})$，输出信号 $Y(j\omega)$ 或 $Y(e^{j\omega})$。
对于连续时间LTI系统：
$Y(j\omega) = X(j\omega)H(j\omega)$
因此，输出信号的幅度谱和相位谱分别为：
$|Y(j\omega)| = |X(j\omega)||H(j\omega)|$
$\angle Y(j\omega) = \angle X(j\omega) + \angle H(j\omega)$

对于离散时间LTI系统：
$Y(e^{j\omega}) = X(e^{j\omega})H(e^{j\omega})$
$|Y(e^{j\omega})| = |X(e^{j\omega})||H(e^{j\omega})|$
$\angle Y(e^{j\omega}) = \angle X(e^{j\omega}) + \angle H(e^{j\omega})$

#### 一. 线性与非线性相位
信号在传输过程中，相位特性或幅度特性发生改变都会引起信号波形的改变，即发生失真。 

当相位特性仅仅是附加一个线性相移时，只引起信号在时间上的平移。
如连续时间LTI系统，若其频率响应为 $H(j\omega) = e^{-j\omega t_0}$ (其中 $t_0$ 是常数)，则其幅度响应 $|H(j\omega)| = 1$，相位响应 $\angle H(j\omega) = -\omega t_0$ 是线性的。
根据傅里叶变换的时移性质，输出信号 $y(t) = x(t-t_0)$。
此时并未丢失信号所携带的任何信息，只是发生时间上的延迟，因而在工程应用中是允许的，这种系统有时被称为无失真延迟系统 (若幅度响应也为常数)。

如果系统的相位特性是非线性的，由于不同频率分量受相位特性影响所产生的时移不同 (因为群延时不是常数)，叠加起来一定会变成一个与原来信号很不相同的信号波形。

对离散时间LTI系统，也有同样的结论。但对线性相位系统 $H(e^{j\omega}) = e^{-j\omega n_0}$，当相位特性的斜率 $n_0$ 是整数时，只引起信号的时域移位 $y(n) = x(n-n_0)$。若相位特性的斜率不是整数，由于离散时间信号的时移量只能是整数，需要采用其他手段实现 (如插值)，其含义也不再是原信号的简单移位。

#### 二. 信号的不失真传输条件
如果系统响应与输入信号满足下列条件，可视为在传输中未发生失真 (仅有尺度变化和时延)：
对于连续时间系统：
$y(t) = kx(t-t_0)$
其中 $k$ 是一个常数增益，$t_0$ 是一个常数时延。
这就要求系统的频率特性为：
$H(j\omega) = ke^{-j\omega t_0}$
即幅度响应 $|H(j\omega)| = k$ (常数)，相位响应 $\angle H(j\omega) = -\omega t_0$ (关于 $\omega$ 的线性函数，且过原点)。 
[Image 不失真传输条件幅频与相频特性图 16]
![[屏幕截图 2025-05-27 222742.png|300]]

对于离散时间系统：
$y(n) = kx(n-n_0)$
要求系统的频率特性为：
$H(e^{j\omega}) = ke^{-j\omega n_0}$
即幅度响应 $|H(e^{j\omega})| = k$ (常数)，相位响应 $\angle H(e^{j\omega}) = -\omega n_0$ (关于 $\omega$ 的线性函数，且 $n_0$ 通常为整数以实现简单移位)。

如果一个系统的幅频特性是一个常数，称这种系统为**全通系统** (all-pass system)。 (有些书上称具有单位增益 $|H(j\omega)|=1$ 的系统为全通系统)。

据此可得出信号传输的**不失真条件**：
* **时域表征**: 系统冲激响应为 $h(t) = k\delta(t-t_0)$ (CT) 或 $h(n) = k\delta(n-n_0)$ (DT)。
* **频域表征**:
    * 幅度特性：$|H(j\omega)| = k$ (常数，在信号有效频带内)。
    * 相位特性：$\angle H(j\omega) = -\omega t_0$ (线性相位，在信号有效频带内)。

通常，系统若在被传输信号的带宽范围内满足不失真条件，则认为该系统对此信号是不失真系统。 

#### 三. 群时延 (Group Delay)
对线性相位系统，系统的相位特性 $\phi(\omega) = -\omega t_0$ 表明了信号的各个频率分量在通过系统时，系统对它所产生的附加相移。相位特性的斜率的负值就是该频率分量在时域产生的时延，即 $t_g = -\frac{d\phi(\omega)}{d\omega} = t_0$。

对非线性相位系统，定义**群时延** $\tau(\omega)$ (或 $t_g(\omega)$) 为相位的导数的负值：
$\tau(\omega) = -\frac{d}{d\omega} \angle H(j\omega)$ (对于连续时间系统)
$\tau_g(\omega) = -\frac{d}{d\omega} \angle H(e^{j\omega})$ (对于离散时间系统)

群时延代表了在以 $\omega_0$ 为中心的一个很窄的频带或很少的一组频率上信号包络所受到的有效公共延时。考察一个中心频率为 $\omega_0$ 的窄带输入信号，一个非线性相位的系统在此窄带范围内，可将其相位的变化近似看成线性的 (泰勒展开)。
$\angle H(j\omega) \approx \angle H(j\omega_0) - \tau(\omega_0)(\omega - \omega_0)$
因此， $Y(j\omega) \approx X(j\omega)|H(j\omega_0)|e^{j(\angle H(j\omega_0) + \tau(\omega_0)\omega_0)} e^{-j\omega\tau(\omega_0)}$。
该系统对窄带输入信号产生的近似效果就是：
1.  由 $|H(j\omega_0)|$ 引起的幅度整形；
2.  对应系统在 $\omega_0$ 的恒定相位的因子 $e^{j\phi_0}$ (其中 $\phi_0 = \angle H(j\omega_0) + \tau(\omega_0)\omega_0$) 的影响；
3.  对应系统在窄带内的近似线性相位所产生的时延 $\alpha = \tau(\omega_0)$。该时延就是系统在 $\omega = \omega_0$ 的群时延。

对于不失真传输，要求群时延在信号的频带内为常数。

#### 四. 对数模与Bode图
在工程应用中，尤其对于连续时间系统，往往采用对数模特性 (或称为**Bode图**) 来描述系统的频率特性。在对数坐标下，采用对数模，可以给频率特性的表示带来一些方便。这是因为：
1.  可以将模特性的相乘关系变为相加关系 (例如 $H(j\omega) = H_1(j\omega)H_2(j\omega)$，则 $\log|H(j\omega)| = \log|H_1(j\omega)| + \log|H_2(j\omega)|$)。
2.  利用对数坐标的非线性，可以展示更宽范围的频率特性，并使低频端更详细而高频端相对粗略。
3.  对连续时间系统，可以方便地建立模特性和相位特性的直线型渐近线，简化分析和设计。 

工程中广泛应用的有两种对数模：
* $\ln|H(j\omega)| \sim \lg \omega$  单位：**奈培 (Np)**
* $20\lg|H(j\omega)| \sim \lg \omega$  单位：**分贝 (dB)**
    其中 $\lg$ 表示以10为底的对数。频率轴通常也采用对数尺度 (例如，倍频程 octave，十倍频程 decade)。

对离散时间系统，由于其有效频率范围只有 $0$ 到 $\pi$ (或 $-\pi$ 到 $\pi$)，通常不采用对数频率轴。而且，即使在对数坐标下也不存在像连续时间系统那样简单的直线型渐近线。因而不常采用完整的Bode图分析方法，但仍可采用对数模来表示幅频特性。

采用对数模 (或Bode图) 表示频率特性，对于幅频特性有零点或在某些频段上为零的系统 (如理想带阻滤波器)，是不适用的 (因为对数零为负无穷)。

---
## 6.3 理想频率选择性滤波器 (The Ideal Frequency-Selective Filters)

#### 一. 滤波
通过系统改变信号中各频率分量的相对大小和相位，甚至完全去除某些频率分量的过程称为**滤波 (filtering)**。 实现滤波功能的系统称为**滤波器 (filter)**。
滤波器可分为两大类：
1.  **频率成形滤波器 (Frequency-shaping filter)**: 改变各频率分量的相对大小，例如均衡器。
2.  **频率选择性滤波器 (Frequency-selective filter)**: 保留某些频率分量，去除另一些频率分量。

#### 二. 理想频率选择性滤波器的频率特性
理想频率选择性滤波器的频率特性在某一个 (或几个) 频段内，频率响应为常数 (通常为1，且具有线性相位)，而在其它频段内频率响应等于零。
理想滤波器可分为：
* **低通滤波器 (Low-pass Filter, LPF)**: 允许低频分量通过，阻止高频分量。
* **高通滤波器 (High-pass Filter, HPF)**: 允许高频分量通过，阻止低频分量。
* **带通滤波器 (Band-pass Filter, BPF)**: 允许一定频带内的分量通过，阻止频带以外的分量。
* **带阻滤波器 (Band-stop Filter, BSF / Notch Filter)**: 阻止一定频带内的分量通过，允许频带以外的分量通过。

滤波器允许信号完全通过的频段称为滤波器的**通带 (passband)**，完全不允许信号通过的频段称为**阻带 (stopband)**。理想滤波器的通带增益为1，阻带增益为0。通带内的相位是线性的，以保证不失真传输。

**连续时间理想频率选择性滤波器的频率特性** (假设相位为零或线性相位 $e^{-j\omega t_0}$)
[Image 连续时间理想低通、高通、带通、带阻滤波器频率特性图 24]
![[屏幕截图 2025-05-27 222912.png|400]]
* **理想低通**: $|H(j\omega)| = 1$ for $|\omega| \le \omega_c$, $0$ otherwise. $\omega_c$ 是截止频率。
* **理想高通**: $|H(j\omega)| = 1$ for $|\omega| \ge \omega_c$, $0$ otherwise.
* **理想带通**: $|H(j\omega)| = 1$ for $\omega_1 \le |\omega| \le \omega_2$, $0$ otherwise.
* **理想带阻**: $|H(j\omega)| = 0$ for $\omega_1 \le |\omega| \le \omega_2$, $1$ otherwise.

**离散时间理想频率选择性滤波器的频率特性** (假设相位为零或线性相位 $e^{-j\omega n_0}$)
由于DTFT的周期性 ($2\pi$)，其频率特性在 $(-\pi, \pi]$ 区间内定义，并以 $2\pi$ 为周期延拓。
[Image 离散时间理想低通、高通、带通、带阻滤波器频率特性图 25]
![[屏幕截图 2025-05-27 222934.png|400]]
* **理想低通**: $|H(e^{j\omega})| = 1$ for $|\omega| \le \omega_c$ (在一个周期内，如 $-\pi < \omega \le \pi$), $0$ for $\omega_c < |\omega| \le \pi$.
* 其他类型的滤波器（高通、带通、带阻）的定义与连续时间类似，只是在离散频率域上，且具有周期性。

各种滤波器的特性都可以从理想低通特性通过频移、叠加等操作得到。离散时间理想滤波器的特性在 $-\pi \sim \pi$ 区间上，与相应的连续时间滤波器特性完全相似。

#### 三. 理想滤波器的时域特性
以**理想低通滤波器**为例，假设其线性相位为零 ($t_0=0$ 或 $n_0=0$)。

**连续时间理想低通滤波器 (CT-LPF)**
频率响应： $H(j\omega) = \begin{cases} 1, & |\omega| < \omega_c \\ 0, & |\omega| > \omega_c \end{cases}$ 
[Image 理想低通滤波器频率特性 26]
![[屏幕截图 2025-05-27 223001.png|200]]
其冲激响应为：
$h(t) = \frac{1}{2\pi} \int_{-\omega_c}^{\omega_c} 1 \cdot e^{j\omega t} d\omega = \frac{1}{2\pi} \left[ \frac{e^{j\omega t}}{jt} \right]_{-\omega_c}^{\omega_c} = \frac{e^{j\omega_c t} - e^{-j\omega_c t}}{2\pi jt} = \frac{2j \sin(\omega_c t)}{2\pi jt} = \frac{\sin(\omega_c t)}{\pi t}$
通常也写成 Sa 函数 (抽样函数) 的形式： $h(t) = \frac{\omega_c}{\pi} \text{Sa}(\omega_c t)$，其中 $\text{Sa}(x) = \frac{\sin x}{x}$。
[Image 理想低通滤波器冲激响应 $h(t)$ 图 27]
![[信号与系统/第6章 信号与系统的时域和频域特性/图片1.png|400]]
这个冲激响应 $h(t)$ 在 $t=0$ 时值为 $\omega_c/\pi$，在 $t<0$ 时不为零，因此系统是**非因果的**。

**离散时间理想低通滤波器 (DT-LPF)**
频率响应： $H(e^{j\omega}) = \begin{cases} 1, & |\omega| < \omega_c \\ 0, & \omega_c < |\omega| \le \pi \end{cases}$ (在一个周期内)
其冲激响应为：
$h(n) = \frac{1}{2\pi} \int_{-\omega_c}^{\omega_c} 1 \cdot e^{j\omega n} d\omega = \frac{\sin(\omega_c n)}{\pi n} = \frac{\omega_c}{\pi} \text{Sa}(\omega_c n)$ (对于 $n \ne 0$)
当 $n=0$ 时，$h(0) = \frac{1}{2\pi} \int_{-\omega_c}^{\omega_c} d\omega = \frac{\omega_c}{\pi}$。
[Image 离散时间理想低通滤波器冲激响应 $h[n]$ 图 28]
![[信号与系统/第6章 信号与系统的时域和频域特性/图片2.png|400]]
同样，这个冲激响应 $h(n)$ 在 $n<0$ 时不为零 (例如 $n=-1, -2, \dots$)，因此系统也是**非因果的**。

如果理想低通滤波器具有线性相位特性 $H(j\omega) = e^{-j\omega \alpha}$ (通带内)，则其冲激响应为：
$h(t) = \frac{\omega_c}{\pi} \text{Sa}[\omega_c(t-\alpha)] = \frac{\sin[\omega_c(t-\alpha)]}{\pi(t-\alpha)}$
这是一个时移的Sa函数。如果 $\alpha > 0$，系统仍然是非因果的，因为Sa函数在原点左侧无限延伸。
[Image 线性相位理想低通滤波器冲激响应 $h(t)$ 图 29]
![[信号与系统/第6章 信号与系统的时域和频域特性/图片3.png|400]]

**理想低通滤波器的单位阶跃响应**
对于CT-LPF (零相位)，单位阶跃响应 $s(t) = h(t) * u(t) = \int_{-\infty}^{t} h(\tau) d\tau$。
$s(t) = \int_{-\infty}^{t} \frac{\sin(\omega_c \tau)}{\pi \tau} d\tau = \frac{1}{\pi} \int_{-\infty}^{\omega_c t} \frac{\sin x}{x} dx$ (令 $x = \omega_c \tau$)
利用正弦积分函数 $\text{Si}(y) = \int_{0}^{y} \frac{\sin x}{x} dx$，且 $\text{Si}(\infty) = \pi/2$, $\text{Si}(-\infty) = -\pi/2$。
$s(t) = \frac{1}{\pi} \left( \int_{-\infty}^{0} \frac{\sin x}{x} dx + \int_{0}^{\omega_c t} \frac{\sin x}{x} dx \right) = \frac{1}{\pi} \left( \frac{\pi}{2} + \text{Si}(\omega_c t) \right) = \frac{1}{2} + \frac{1}{\pi} \text{Si}(\omega_c t)$
[Image 理想低通滤波器单位阶跃响应 $s(t)$ 图 31]
![[屏幕截图 2025-05-27 223156.png|400]]
阶跃响应在达到稳态值1之前有振荡 (吉布斯现象) 和超调。

如果理想低通滤波器具有线性相位 $e^{-j\omega t_0}$，则阶跃响应 $s(t)$ 整体右移 $t_0$。
[Image 线性相位理想低通滤波器单位阶跃响应 $s(t)$ 及上升时间图 32]
![[屏幕截图 2025-05-27 223225.png|400]]
* **上升时间 ($t_r$)**: 通常定义为响应从稳态值的10%上升到90%所需的时间，或者如图中定义的从第一个最小值到第一个最大值（过冲点）的时间。图中定义为 $t_r = 2 \cdot \frac{\pi}{\omega_c} = \frac{1}{B}$，其中 $B = \frac{\omega_c}{2\pi} = f_c$ 是滤波器的带宽 (截止频率，Hz)。
* 上升时间与滤波器带宽成反比：$t_r \propto 1/B$。带宽越宽，上升时间越短，系统响应越快。

对离散时间理想低通滤波器，相应有：
$s(n) = \frac{1}{2} + \frac{1}{\pi} \sum_{k=1}^{n} \frac{\sin(\omega_c k)}{k}$ (近似，或使用离散正弦积分)。课件给出 $s(n)=\frac{1}{2}+\frac{1}{\pi}Si(\omega_{c}n)$，这是连续形式的直接类比。
[Image 离散时间理想低通滤波器单位阶跃响应 $s[n]$ 图 33]
![[信号与系统/第6章 信号与系统的时域和频域特性/图片4.png|400]]

**从理想滤波器的时域特性可以看出**：
1.  **理想滤波器是非因果系统**。因为它们的冲激响应 $h(t)$ 或 $h(n)$ 在 $t<0$ 或 $n<0$ 时不为零。因而是物理不可实现的。
2.  尽管从频域滤波的角度看，理想滤波器的频率特性是最佳的 (陡峭的截止特性)。但它们的时域特性并不是最佳的，$h(t)$ 或 $h(n)$ 都有无限延伸的尾部、起伏 (旁瓣)、主瓣，这表明理想滤波器的时域特性与频域特性并不兼容 (例如，频域突变对应时域无限延伸和振荡)。
3.  在工程应用中，当要设计一个滤波器时，必须对时域特性和频域特性作出恰当的折中。例如，为了实现物理可实现的因果滤波器，并改善时域响应 (减少振铃)，需要牺牲频率选择性的急剧程度。

---
## 6.4 非理想滤波器 (The Nonideal Filters)

由于理想滤波器是物理不可实现的，工程应用中就必须寻找一个物理可实现的频率特性去逼近理想特性，这种物理可实现的系统就称为**非理想滤波器**。
对理想特性逼近得越精确 (例如，过渡带越窄，通带和阻带越平坦)，实现时付出的代价越大，系统的复杂程度也越高 (例如，需要更高阶的滤波器)。

非理想滤波器的频率特性通常用**容限 (tolerance scheme)** 来规定。

| 理想滤波器特性                      | 非理想滤波器特性 (容限)                                   |
|-------------------------------------|----------------------------------------------------------|
| 1. 通带绝对平坦，通带内衰减为零。     | 通带内允许有起伏 (波纹)，有一定衰减范围 $\pm\delta_1$。    |
| 2. 阻带绝对平坦，阻带内衰减为 $\infty$。 | 阻带内允许有起伏 (波纹)，有一定衰减范围 $\delta_2$ (最大允许传输)。 |
| 3. 无过渡带。                       | 存在**过渡带 (transition band)**，介于通带和阻带之间。      |

[Image 非理想低通滤波器容限图 37]
![[信号与系统/第6章 信号与系统的时域和频域特性/图片5.png|400]]
* **通带波纹 (Passband ripple)**: $\pm\delta_1$ (幅度值) 或对应的dB值。
* **阻带衰减 (Stopband attenuation)**: $\delta_2$ (幅度值) 或对应的dB值 (例如 -AdB，表示至少衰减 AdB)。
* **通带边缘频率 ($\omega_p$ 或 $f_p$)**: 通带结束的频率。
* **阻带边缘频率 ($\omega_s$ 或 $f_s$)**: 阻带开始的频率。
* **过渡带宽度**: $\omega_s - \omega_p$。

**工程实际中常用的逼近理想低通特性的方式有**：

从**幅频特性**出发逼近：
1.  **Butterworth (巴特沃斯) 滤波器**: 通带和阻带均呈单调衰减，也称通带最平坦逼近 (maximally flat in the passband)。
2.  **Chebyshev (切比雪夫) 滤波器**:
    * Type I: 通带等波纹，阻带单调衰减。
    * Type II (Inverse Chebyshev): 通带单调衰减，阻带等波纹。
3.  **Cauer (考尔) 滤波器 / Elliptic (椭圆) 滤波器**: 通带、阻带均等波纹。在阶数相同的情况下，它能在通带和阻带之间提供最陡峭的过渡特性。

从**相位特性**出发，逼近理想的线性相位特性 (即追求恒定的群时延)：
1.  **Bessel (贝塞尔) 滤波器**: 群时延最平坦逼近 (maximally flat group delay)。具有良好的瞬态响应，但频率选择性较差。
2.  **包络时延Chebyshev滤波器 (Equiripple Delay Filter)**: 群时延在通带内等波纹逼近。
3.  **Gauss (高斯) 滤波器**: 其冲激响应为高斯函数，频率响应的模也是高斯函数。具有良好的时域和频域特性折中，无过冲。

对同一种滤波器，**阶数 (order)** 越高，对理想特性的逼近得越好，过渡带越窄，但付出的代价是系统越复杂 (实现成本更高，延迟可能更大)。

对同样阶数的滤波器，从Butterworth $\rightarrow$ Chebyshev $\rightarrow$ Cauer，其幅频特性逼近得越来越好 (过渡带越来越窄)，但阶跃响应的起伏、超量和振荡也越厉害 (体现了系统频域特性与时域特性的不兼容)。系统的复杂程度也越来越高，相应地，实现系统所付出的代价也越来越大。

**5阶Butterworth滤波器与5阶Cauer (Elliptic) 滤波器的比较**：
* **幅频特性**: [Image 5阶Butterworth与Cauer滤波器幅频特性比较图 41] 
* ![[信号与系统/第6章 信号与系统的时域和频域特性/图片6.png|400]]
* Cauer滤波器有更陡的过渡带和波纹。
* **单位阶跃响应**: [Image 5阶Butterworth与Cauer滤波器单位阶跃响应比较图 42] 
* ![[信号与系统/第6章 信号与系统的时域和频域特性/图片7.png|400]]
* Cauer滤波器有更显著的振铃和过冲。

---
## 6.5 一阶与二阶连续时间系统 (First-Order and Second-Order Continuous-Time Systems)

对由LCCDE (线性常系数微分方程) 描述的连续时间LTI系统，其频率响应 $H(j\omega)$ 是 $j\omega$ 的有理函数：
$H(j\omega) = \frac{Y(j\omega)}{X(j\omega)} = \frac{\sum_{k=0}^{M} b_k (j\omega)^k}{\sum_{k=0}^{N} a_k (j\omega)^k} = \frac{B(j\omega)}{A(j\omega)}$
其中 $a_k$、$b_k$ 均为实常数。

此时，可通过对分子多项式 $B(j\omega)$ 和分母多项式 $A(j\omega)$ 进行因式分解，将其表示成若干个一阶或二阶有理函数的连乘 (级联)；或者通过部分分式展开，表示成若干个一阶或二阶有理函数相加 (并联)。
这表明：由LCCDE描述的LTI系统可以看成由若干个一阶或二阶系统通过级联或并联构成。因此，一阶和二阶系统是构成任何高阶系统的基本单元。掌握一阶和二阶系统的分析方法就尤为重要。

#### 一. 一阶系统
**标准模型 (低通型)**: $\tau \frac{dy(t)}{dt} + y(t) = x(t)$
其中 $\tau > 0$ 是**时间常数 (time constant)**。

**频率响应**:
$H(j\omega) = \frac{1}{1 + j\omega\tau}$

**1. 时域特性**:
* **冲激响应**: $h(t) = \frac{1}{\tau} e^{-t/\tau} u(t)$
    [Image 一阶连续时间系统冲激响应 $h(t)$ 图 45]
    ![[信号与系统/第6章 信号与系统的时域和频域特性/图片8.png|400]]
    $\tau$ 越小，$h(t)$ 衰减得越快，系统响应越快，带宽越宽。
* **单位阶跃响应**: $s(t) = h(t) * u(t) = \int_0^t \frac{1}{\tau} e^{-\lambda/\tau} d\lambda = (1 - e^{-t/\tau})u(t)$
    [Image 一阶连续时间系统阶跃响应 $s(t)$ 图 46]
    ![[信号与系统/第6章 信号与系统的时域和频域特性/图片9.png|400]]
    $\tau$ 越小，$s(t)$ 上升得越快，达到稳态值1的速度越快。在 $t=\tau$ 时，$s(\tau) = 1 - e^{-1} \approx 0.632$。

**2. 一阶系统的Bode图**: 
$H(j\omega) = \frac{1}{1 + j\omega\tau}$
* **幅频特性 (对数模)**:
    $|H(j\omega)| = \frac{1}{\sqrt{1 + (\omega\tau)^2}}$
    $20\lg|H(j\omega)| = -10\lg(1 + (\omega\tau)^2)$ (dB)
    * 当 $\omega\tau \ll 1$ (即 $\omega \ll 1/\tau$, 低频段): $20\lg|H(j\omega)| \approx -10\lg(1) = 0 \text{ dB}$。
    * 当 $\omega\tau \gg 1$ (即 $\omega \gg 1/\tau$, 高频段): $20\lg|H(j\omega)| \approx -10\lg((\omega\tau)^2) = -20\lg(\omega\tau) = -20\lg\omega - 20\lg\tau$。这是一条斜率为 **-20 dB/decade** (每十倍频程衰减20dB) 或约 -6 dB/octave (每倍频程衰减6dB) 的直线。
    * **折断频率 (Break frequency / Corner frequency)**: $\omega_c = 1/\tau$。在此频率，两条渐近线相交。 
        此时的准确值为 $20\lg|H(j(1/\tau))| = -10\lg(1+1^2) = -10\lg 2 \approx -3.01 \text{ dB}$。
    [Image 一阶连续时间系统幅频特性Bode图 48]
    ![[信号与系统/第6章 信号与系统的时域和频域特性/图片10.png|400]]

* **相频特性**:
    $\angle H(j\omega) = -\arctan(\omega\tau)$
    * 当 $\omega \rightarrow 0$: $\angle H(j\omega) \rightarrow -\arctan(0) = 0$。
    * 当 $\omega = 1/\tau$: $\angle H(j\omega) = -\arctan(1) = -\pi/4 \text{ rad } (-45^\circ)$。
    * 当 $\omega \rightarrow \infty$: $\angle H(j\omega) \rightarrow -\arctan(\infty) = -\pi/2 \text{ rad } (-90^\circ)$。
    * **折线化渐近线**:
        $\angle H(j\omega) \approx \begin{cases} 0, & \omega \le 0.1/\tau \\ -\frac{\pi}{4}[\lg(\omega\tau)+1], & 0.1/\tau \le \omega \le 10/\tau \\ -\frac{\pi}{2}, & \omega \ge 10/\tau \end{cases}$
        (在 $\omega=0.1/\tau$ 到 $\omega=10/\tau$ 这两个十倍频程内，相位从0变化到 $-\pi/2$，中心点在 $\omega=1/\tau$ 处为 $-\pi/4$)
    [Image 一阶连续时间系统相频特性Bode图 50]
    ![[信号与系统/第6章 信号与系统的时域和频域特性/图片11.png|400]]

#### 二. 二阶系统
**标准模型 (低通型)**: $\frac{d^2y(t)}{dt^2} + 2\zeta\omega_n \frac{dy(t)}{dt} + \omega_n^2 y(t) = \omega_n^2 x(t)$
其中：
* $\omega_n > 0$ 是**无阻尼自然频率 (undamped natural frequency)**。
* $\zeta \ge 0$ 是**阻尼系数 (damping ratio)**。

**示例**:
* RLC串联谐振电路 (输出为电容电压，输入为电源电压): 
    $y''(t) + \frac{R}{L}y'(t) + \frac{1}{LC}y(t) = \frac{1}{LC}x(t)$
    对比标准形式: $\omega_n^2 = 1/(LC) \Rightarrow \omega_n = 1/\sqrt{LC}$
    $2\zeta\omega_n = R/L \Rightarrow \zeta = \frac{R}{2L\omega_n} = \frac{R}{2}\sqrt{\frac{C}{L}}$
    [Image RLC串联谐振电路图 51]
    ![[信号与系统/第6章 信号与系统的时域和频域特性/图片12.png|200]]
* 弹簧-质量-阻尼器减震系统:
    $M\frac{d^2y(t)}{dt^2} + B\frac{dy(t)}{dt} + ky(t) = k\hat{x}(t)$ (若以 $k\hat{x}(t)$ 作为输入使右侧系数为 $\omega_n^2$)
    对比标准形式: $\omega_n^2 = k/M \Rightarrow \omega_n = \sqrt{k/M}$
    $2\zeta\omega_n = B/M \Rightarrow \zeta = \frac{B}{2M\omega_n} = \frac{B}{2\sqrt{kM}}$
    [Image 弹簧-质量-阻尼器减震系统图 52]
    ![[信号与系统/第6章 信号与系统的时域和频域特性/图片13.png|300]]

**频率响应**:
$H(j\omega) = \frac{\omega_n^2}{(j\omega)^2 + 2\zeta\omega_n(j\omega) + \omega_n^2} = \frac{1}{1 - (\frac{\omega}{\omega_n})^2 + j2\zeta(\frac{\omega}{\omega_n})}$

特征方程为 $s^2 + 2\zeta\omega_n s + \omega_n^2 = 0$，其根 (系统的极点) 为 $s_{1,2} = -\zeta\omega_n \pm \omega_n\sqrt{\zeta^2-1}$。

**1. 时域特性——冲激响应 $h(t)$**: 
行为取决于 $\zeta$ 的值：
* **① $\zeta = 0$ (无阻尼状态, Undamped)**: 极点 $s_{1,2} = \pm j\omega_n$。
    $H(j\omega) = \frac{\omega_n^2}{(j\omega)^2 + \omega_n^2}$
    $h(t) = \omega_n \sin(\omega_n t) u(t)$。持续振荡。
* **② $0 < \zeta < 1$ (欠阻尼状态, Underdamped)**: 极点 $c_{1,2} = -\zeta\omega_n \pm j\omega_n\sqrt{1-\zeta^2} = -\zeta\omega_n \pm j\omega_d$，其中 $\omega_d = \omega_n\sqrt{1-\zeta^2}$ 是阻尼振荡频率。
    $h(t) = \frac{\omega_n}{\sqrt{1-\zeta^2}} e^{-\zeta\omega_n t} \sin(\omega_n\sqrt{1-\zeta^2}t) u(t)$。衰减振荡。
* **③ $\zeta = 1$ (临界阻尼状态, Critically Damped)**: 极点 $c_1 = c_2 = -\omega_n$ (重实根)。
    $H(j\omega) = \frac{\omega_n^2}{(j\omega + \omega_n)^2}$
    $h(t) = \omega_n^2 t e^{-\omega_n t} u(t)$。无振荡，最快衰减到零而不超调的边界。
* **④ $\zeta > 1$ (过阻尼状态, Overdamped)**: 极点 $c_{1,2} = -\zeta\omega_n \pm \omega_n\sqrt{\zeta^2-1}$ (两个不等的负实根)。
    $h(t) = \frac{\omega_n}{2\sqrt{\zeta^2-1}} (e^{c_1 t} - e^{c_2 t}) u(t)$ (其中 $c_1 = -\zeta\omega_n + \omega_n\sqrt{\zeta^2-1}$, $c_2 = -\zeta\omega_n - \omega_n\sqrt{\zeta^2-1}$，课件 $M[e^{c_1t}-e^{c_2t}]u(t)$ 形式的 $M$ 和 $c_{1,2}$ 需要对应)。实际形式为 $\frac{\omega_n^2}{s_1-s_2}(e^{s_1 t} - e^{s_2 t})u(t)$。无振荡，衰减比临界阻尼慢。
[Image 不同阻尼系数 $\zeta$ 下的二阶连续时间系统冲激响应 $h(t)/\omega_n$ 图 56]
![[屏幕截图 2025-05-27 223915.png|400]]

**2. 时域特性——单位阶跃响应 $s(t)$**: 
* 当 $0 < \zeta < 1$ (欠阻尼): 阶跃响应既有**超量 (overshoot)** 又有**振荡 (oscillation)**。
    $s(t) = \left[ 1 - \frac{e^{-\zeta\omega_n t}}{\sqrt{1-\zeta^2}} \sin(\omega_n\sqrt{1-\zeta^2}t + \phi) \right] u(t)$, where $\cos\phi = \zeta, \sin\phi=\sqrt{1-\zeta^2}$.
* 当 $\zeta = 1$ (临界阻尼): 在没有超量的情况下，响应最快 (指达到并保持在稳态值附近的上升时间)。
    $s(t) = [1 - e^{-\omega_n t} - \omega_n t e^{-\omega_n t}] u(t)$ 
* 当 $\zeta > 1$ (过阻尼): 响应无超调，但比临界阻尼慢。
* 随着 $\zeta$ 的增加 (从欠阻尼到过阻尼)，响应的振荡减少，超调量减小，但上升时间可能会先减小后增大。$\zeta \approx 0.707$ 时通常有较好的综合性能 (例如最平坦的幅频响应)。

**3. 频率特性 (Bode图)**: 
$H(j\omega) = \frac{1}{1 - (\frac{\omega}{\omega_n})^2 + j2\zeta(\frac{\omega}{\omega_n})}$
* **幅频特性 (对数模)**:
    $|H(j\omega)| = \frac{1}{\sqrt{\left(1 - \left(\frac{\omega}{\omega_n}\right)^2\right)^2 + \left(2\zeta\frac{\omega}{\omega_n}\right)^2}}$ 
    $20\lg|H(j\omega)| = -10\lg\left[ \left(1 - \left(\frac{\omega}{\omega_n}\right)^2\right)^2 + 4\zeta^2\left(\frac{\omega}{\omega_n}\right)^2 \right]$ 
    * 当 $\omega \ll \omega_n$ (低频段): $20\lg|H(j\omega)| \approx -10\lg(1) = 0 \text{ dB}$。 
    * 当 $\omega \gg \omega_n$ (高频段): $20\lg|H(j\omega)| \approx -10\lg\left( \left(\frac{\omega}{\omega_n}\right)^4 \right) = -40\lg\left(\frac{\omega}{\omega_n}\right) = -40\lg\omega + 40\lg\omega_n$。这是一条斜率为 **-40 dB/decade** 的直线。
    * **折断频率**: $\omega_n$。两条渐近线在此相交。
    * 在 $\omega = \omega_n$: $20\lg|H(j\omega_n)| = -10\lg((2\zeta)^2) = -20\lg(2\zeta)$。
        * 如果 $\zeta = 0.5$, $20\lg|H(j\omega_n)| = -20\lg(1) = 0 \text{ dB}$。
        * 如果 $\zeta = 1/\sqrt{2} \approx 0.707$, $20\lg|H(j\omega_n)| = -20\lg(\sqrt{2}) \approx -3 \text{ dB}$ (最平坦Butterworth响应)。
        * 如果 $\zeta < 0.5$, 会出现峰值。
    [Image 不同阻尼系数 $\zeta$ 下的二阶连续时间系统幅频特性Bode图 59]
    ![[图片14.png|400]]

    * **谐振峰 (Resonant Peak)**: 
        当 $\zeta < 1/\sqrt{2} \approx 0.707$ 时，幅频特性在 $\omega_r = \omega_n\sqrt{1-2\zeta^2}$ 处出现峰值 (谐振频率)。
        峰值为 $M_p = |H(j\omega_r)| = \frac{1}{2\zeta\sqrt{1-\zeta^2}}$。
        **品质因数 (Quality Factor) $Q$**: $Q = \frac{1}{2\zeta}$。 $Q$ 衡量峰值的尖锐程度。 $Q$ 越大，峰越尖，选择性越好，但瞬态响应的振荡越剧烈。
        * $\zeta > 0.707$: 系统类似于一阶系统具有低通特性 (幅频单调下降)。
        * $\zeta = 0.707$: 系统具有最平坦的低通特性 (Butterworth二阶)。
        * $\zeta < 0.707$: 随 $\zeta$ 的减小，逐步过渡为带通特性 (在 $\omega_n$ 附近有明显峰值)。

* **相频特性**:
    $\angle H(j\omega) = -\arctan\left(\frac{2\zeta\frac{\omega}{\omega_n}}{1 - (\frac{\omega}{\omega_n})^2}\right)$ (注意分母正负导致的多值问题，通常取值在0到 $-\pi$)
    * 当 $\omega \rightarrow 0$: $\angle H(j\omega) \rightarrow 0$。
    * 当 $\omega = \omega_n$: $\angle H(j\omega) = -\arctan(\frac{2\zeta}{0}) = -\pi/2 \text{ rad } (-90^\circ)$ (如果 $1-(\omega/\omega_n)^2$ 从正到负)。
    * 当 $\omega \rightarrow \infty$: $\angle H(j\omega) \rightarrow -\pi \text{ rad } (-180^\circ)$。
    * $\zeta$ 越小，相位在 $\omega_n$ 附近变化越剧烈 (非线性越严重)。
    [Image 不同阻尼系数 $\zeta$ 下的二阶连续时间系统相频特性Bode图 62]
    ![[图片15.png|400]]

#### 三. 有理型频率响应的Bode图 (分子项)
对于分子中出现的项，例如 $\hat{H}(j\omega) = 1 + j\omega\tau$ (一阶零点) 或 $\hat{H}(j\omega) = 1 - (\frac{\omega}{\omega_n})^2 + j2\zeta(\frac{\omega}{\omega_n})$ (二阶复数零点)，它们的Bode图特性与前面讨论的分母项 (极点) 刚好相反。
即，如果 $H_{pole}(j\omega) = 1/H_{zero}(j\omega)$:
$20\lg|\hat{H}(j\omega)| = 20\lg|1/H(j\omega)| = -20\lg|H(j\omega)|$
$\angle \hat{H}(j\omega) = -\angle H(j\omega)$
这意味着幅频图的斜率符号相反 (例如，一阶零点提供 +20 dB/decade 的斜率)，相频图的符号也相反。

---
## 6.6 一阶与二阶离散时间系统 (First-Order and Second-Order Discrete-Time Systems)
Bode图的渐近线分析方法对离散时间系统不那么直接适用，但其幅频和相频特性仍然是分析的关键。

#### 一. 一阶系统
**系统的数学模型 (差分方程)**:
$y(n) - ay(n-1) = x(n)$，其中 $|a|<1$ 保证系统稳定。

**频率响应**:
$H(e^{j\omega}) = \frac{1}{1 - ae^{-j\omega}}$

**1. 时域特性**: 
* **冲激响应**: $h(n) = a^n u(n)$ 
    [Image 不同参数 $a$ 下的一阶离散时间系统冲激响应 $h[n]$ 图 66]
    ![[屏幕截图 2025-05-27 224509.png|400]]
* **单位阶跃响应**: $s(n) = \sum_{k=0}^{n} a^k u(n) = \frac{1-a^{n+1}}{1-a} u(n)$ (对于 $n \ge 0$)
    [Image 不同参数 $a$ 下的一阶离散时间系统单位阶跃响应 $s[n]$ 图 67]
    ![[屏幕截图 2025-05-27 224535.png|400]]

**时域特性总结**: 
* 当 $a > 0$: 随着 $a$ 的增大 (趋向1)，系统的单位脉冲响应单调衰减得越来越慢。单位阶跃响应单调上升得越来越慢。
* 当 $a < 0$: 系统的单位脉冲响应和单位阶跃响应都存在振荡 (符号交替)。$|a|$ 越大 (趋向1)，振荡的持续期越长，单位脉冲响应衰减得越慢。

**2. 频域特性**: 
$|H(e^{j\omega})| = \frac{1}{|1 - a\cos\omega + ja\sin\omega|} = \frac{1}{\sqrt{(1-a\cos\omega)^2 + (a\sin\omega)^2}} = \frac{1}{\sqrt{1+a^2-2a\cos\omega}}$
$\angle H(e^{j\omega}) = -\arctan\left(\frac{a\sin\omega}{1-a\cos\omega}\right)$ 

* **$a > 0$ (例如 $0 < a < 1$)**:
    * 当 $\omega = 0$, $|H(e^{j0})| = 1/(1-a)$ (最大值，低通特性)。
    * 当 $\omega = \pi$, $|H(e^{j\pi})| = 1/(1+a)$ (最小值)。
    * $a$ 越接近1，低通特性越明显，峰值越高，过渡带越窄。
    [Image $a>0$ 时一阶离散时间系统对数幅频和相频特性图 70]
    ![[屏幕截图 2025-05-27 224605.png|400]]
* **$a < 0$ (例如 $-1 < a < 0$)**:
    * 当 $\omega = 0$, $|H(e^{j0})| = 1/(1-a)$ (最小值)。
    * 当 $\omega = \pi$, $|H(e^{j\pi})| = 1/(1+a)$ (因为 $a$ 是负数，所以 $1+a = 1-|a|$, 导致峰值，高通特性)。
    * $|a|$ 越接近1，高通特性越明显。
    [Image $a<0$ 时一阶离散时间系统对数幅频和相频特性图 71]
    ![[屏幕截图 2025-05-27 224622.png|400]]

#### 二. 二阶系统
**数学模型 (差分方程)**:
$y(n) - 2r\cos\theta \cdot y(n-1) + r^2 y(n-2) = x(n)$
其中 $0 < r < 1$ (为了稳定，极点在单位圆内)，$0 \le \theta \le \pi$。
这个形式的系统极点为 $p_{1,2} = re^{\pm j\theta}$。

**频率响应**:
$H(e^{j\omega}) = \frac{1}{1 - 2r\cos\theta e^{-j\omega} + r^2 e^{-j2\omega}} = \frac{1}{(1 - re^{j\theta}e^{-j\omega})(1 - re^{-j\theta}e^{-j\omega})}$

**1. 时域特性——冲激响应 $h(n)$**:
* **Case 1: $\theta \ne 0$ 且 $\theta \ne \pi$ (欠阻尼状态, Underdamped)**: 极点是共轭复数。
    $h(n) = r^n \frac{\sin((n+1)\theta)}{\sin\theta} u(n)$
    $h(n)$ 为指数衰减 ($r^n$) 的正弦振荡。$r$ 影响衰减速率，$\theta$ 影响振荡频率。
* **Case 2: $\theta = 0$ (临界阻尼或过阻尼的特殊情况)**: 极点 $p_{1,2} = r$ (二重实极点)。
    $H(e^{j\omega}) = \frac{1}{(1 - re^{-j\omega})^2}$
    $h(n) = (n+1)r^n u(n)$。 $h(n)$ 单调变化 (如果 $r>0$)，无振荡。
* **Case 3: $\theta = \pi$ (临界阻尼或过阻尼的特殊情况)**: 极点 $p_{1,2} = -r$ (二重实极点 $re^{j\pi}$)。
    $H(e^{j\omega}) = \frac{1}{(1 + re^{-j\omega})^2}$
    $h(n) = (n+1)(-r)^n u(n)$。 $h(n)$ 振荡最剧烈 (符号交替)。

[Image 不同参数 $r, \theta$ 下的二阶离散时间系统冲激响应 $h[n]$ 图 (部分1) 74]
![[屏幕截图 2025-05-27 224646.png|400]]
[Image 不同参数 $r, \theta$ 下的二阶离散时间系统冲激响应 $h[n]$ 图 (部分2) 75]
![[屏幕截图 2025-05-27 224743.png|400]]
[Image 不同参数 $r, \theta$ 下的二阶离散时间系统单位阶跃响应 $s[n]$ 图 (部分1) 76]
![[屏幕截图 2025-05-27 224800.png|400]]
[Image 不同参数 $r, \theta$ 下的二阶离散时间系统单位阶跃响应 $s[n]$ 图 (部分2) 77]
![[图片16.png|400]]

**时域特性总结**: 
1.  当系统处于欠阻尼状态时 (即 $0 < \theta < \pi$)，系统的单位冲激响应和单位阶跃响应都存在振荡和超量。$\theta$ 越接近 $0$ 或 $\pi$ (实极点)，振荡减弱；$\theta$ 越接近 $\pi/2$，振荡频率相对于采样率较高。更准确地说，$\theta$ 决定了振荡的归一化频率。
2.  在欠阻尼状态下，$r$ 影响着单位冲激响应和单位阶跃响应的变化速率 (衰减包络)。$r$ 越接近1，单位冲激响应衰减得越慢，单位阶跃响应上升得越慢，出现的振荡也越明显 (持续时间长)。

**2. 频域特性**:
幅频特性 $|H(e^{j\omega})|$ 在 $\omega \approx \theta$ 附近会出现峰值 (如果 $r$ 接近1)。
[Image $\theta=0$ 时不同参数 $r$ 下的二阶离散时间系统对数幅频和相频特性图 79] (低通)
![[屏幕截图 2025-05-27 224840.png|400]]
[Image $\theta=\pi/4$ 时不同参数 $r$ 下的二阶离散时间系统对数幅频和相频特性图 80] (带通)
![[屏幕截图 2025-05-27 224901.png|400]]
[Image $\theta=\pi/2$ 时不同参数 $r$ 下的二阶离散时间系统对数幅频和相频特性图 81] (带通)
![[屏幕截图 2025-05-27 224915.png|400]]
[Image $\theta=3\pi/4$ 时不同参数 $r$ 下的二阶离散时间系统对数幅频和相频特性图 82] (带通)
![[屏幕截图 2025-05-27 224932.png|400]]
[Image $\theta=\pi$ 时不同参数 $r$ 下的二阶离散时间系统对数幅频和相频特性图 83] (高通)
![[屏幕截图 2025-05-27 224948.png|400]]

**频域特性总结**: 
1.  $r$ 越大 (越接近1)，幅频特性的峰越尖锐，系统的带宽越窄 (对于带通特性)。$r$ 越小，幅频特性越平坦，系统带宽越宽。
2.  系统幅频特性的峰值总是出现在 $\omega$ 值的附近 (即极点角 $\theta$ 附近)。随着 $\theta$ 从 $0 \rightarrow \pi$ 变化，系统经历了从低通特性 $\rightarrow$ 带通特性 $\rightarrow$ 高通特性的变化过程。
3.  系统通常具有非线性相位特性。

总之：$\theta$ 影响系统频响的峰值位置，$r$ 影响峰值的大小 (尖锐程度) 和带宽。其作用分别类似于连续时间二阶系统中的 $\omega_n$ (决定峰值位置) 和 $\zeta$ (决定峰值高度和带宽，但 $r$ 与 $\zeta$ 的关系不是直接的，$r$ 越接近1，等效于 $\zeta$ 越小)。

**二阶系统过阻尼状态 (两个不同实数极点)**: 
如果系统有两个不同的实数极点 $d_1, d_2$ (即 $re^{\pm j\theta}$ 中的 $\theta=0$ 或 $\theta=\pi$ 且分解为两个不同的一阶项，或者直接由 $y(n) - (d_1+d_2)y(n-1) + d_1d_2 y(n-2) = x(n)$ 形式给出)。
$H(e^{j\omega}) = \frac{1}{(1-d_1e^{-j\omega})(1-d_2e^{-j\omega})} = \frac{A}{1-d_1e^{-j\omega}} + \frac{B}{1-d_2e^{-j\omega}}$
其中 $A = \frac{d_1}{d_1-d_2}$, $B = \frac{d_2}{d_2-d_1}$ (若 $d_1 \ne d_2$)
此时相当于两个一阶系统级联 (或并联)。系统行为取决于 $d_1, d_2$ 的符号和大小。

---
## 6.7 系统的时域分析与频域分析举例 (Examples of Time- and Frequency-Domain Analysis of Systems)

#### 一. 汽车减震系统
系统模型 (简化): $M\frac{d^2y(t)}{dt^2} + b\frac{dy(t)}{dt} + ky(t) = kx(t) + b\frac{dx(t)}{dt}$
这与前面讨论的二阶系统形式略有不同，因为右边有输入的导数项。
其频率响应为 $H(j\omega) = \frac{k + j\omega b}{(j\omega)^2 M + j\omega b + k} = \frac{ (b/M)j\omega + k/M }{ (j\omega)^2 + (b/M)j\omega + k/M }$
如果定义 $\omega_n = \sqrt{k/M}$ 和 $2\zeta\omega_n = b/M$ (即 $\zeta = \frac{b}{2\sqrt{Mk}}$)。
$H(j\omega) = \frac{2\zeta\omega_n (j\omega) + \omega_n^2}{(j\omega)^2 + 2\zeta\omega_n (j\omega) + \omega_n^2}$
[Image 汽车减震系统模型图 87]
![[图片17.png|300]]

* **频域考虑**: 希望 $\omega_n$ 越小，越有利于滤除路面不平 (高频颠簸) 所造成的影响。
* **时域考虑**: 希望响应时间尽可能快，并且不要出现震荡和超量，因此可能要求 $\zeta \approx 1$ (临界阻尼)。
但 $\omega_n$ 越小，时域特性变化越慢 (系统响应慢)。$\zeta=1$ 时，系统的频率特性 (选择性) 并不是最佳的。
对系统的时域特性和频域特性综合折中考虑，是工程应用中很重要的问题。

#### 二. FIR滤波器 (Finite Impulse Response Filter)
离散时间滤波器可以分为**IIR (Infinite Impulse Response, 无限冲激响应)**和**FIR (Finite Impulse Response, 有限冲激响应)**两大类。FIR滤波器总是稳定的，并且容易设计成具有精确的线性相位。

**动平均滤波器 (Moving Average Filter)**: 
$y(n) = \frac{1}{N+M+1} \sum_{k=-N}^{M} x(n-k)$ (这是一个因果或非因果FIR系统，取决于N和M的取值)
其频率响应为：
$H(e^{j\omega}) = \frac{1}{N+M+1} \sum_{k=-N}^{M} e^{-j\omega k} = \frac{1}{N+M+1} e^{j\omega\frac{N-M}{2}} \frac{\sin\left(\frac{N+M+1}{2}\omega\right)}{\sin\left(\frac{\omega}{2}\right)}$ (Dirichlet核的变形)
这是一个具有线性相位的FIR滤波器 (如果对称)。
[Image 动平均FIR滤波器 (M+N+1=33) 幅频特性图 90]
![[屏幕截图 2025-05-27 225042.png|400]]
[Image 动平均FIR滤波器 (M+N+1=65) 幅频特性图 91]
![[屏幕截图 2025-05-27 225101.png|400]]
动平均滤波器的长度 $(N+M+1)$ 越大，主瓣越窄，旁瓣越多且幅度减小，低通滤波效果越好，但平滑作用也越强 (细节损失多，延迟增大)。

**加权的动平均滤波器**: 
$y(n) = \sum_{k=-N}^{M} b_k x(n-k)$
其中 $b_k$ 是滤波器的系数 (即冲激响应 $h(k)=b_k$ for $-N \le k \le M$)。选择不同的加权序列 $b_k$ (也称为**窗函数 (window function)** 应用于理想冲激响应)，即可改变滤波器的特性，例如改善旁瓣衰减，加宽主瓣等。

**示例：窗函数设计的FIR滤波器**
$h(n) = \begin{cases} \frac{\sin(2\pi n/33)}{\pi n}, & |n| \le 32 \\ 0, & |n| > 32 \end{cases}$ (这是一个截断的Sinc函数，对应理想低通滤波器的冲激响应，通过矩形窗截断得到FIR滤波器)
[Image 加权动平均滤波器窗函数序列 h[n] 图 92]
![[图片18.png|400]]
[Image 加权动平均FIR滤波器幅频特性（对数模）图 93] 
![[图片19.png|400]]
(展现了Sinc函数形状的频谱，带有吉布斯现象的旁瓣)

---
## 6.8 小结 Summary

* 从傅里叶变换的模和相位表示出发，研究了信号在传输中发生失真的原因 (幅度失真、相位失真) 和失真的种类。建立了信号传输的不失真条件 (恒定幅度和线性相位)。
* 介绍了滤波与滤波器的基本概念，理想频率选择性滤波器 (低通、高通、带通、带阻) 的频率特性和时域特性 (Sa函数冲激响应、Si函数阶跃响应)。指出了理想滤波器的不可实现性 (非因果性)。介绍了非理想滤波器的概念及容限指标，以及工程中常用的逼近方式 (Butterworth, Chebyshev, Cauer, Bessel等)。
* 讨论了连续时间和离散时间一阶、二阶系统的时域和频域特性的分析方法，包括冲激响应、阶跃响应、频率响应的幅度和相位。对连续时间一阶、二阶系统Bode图的绘制方法 (渐近线) 进行了介绍。
* 以汽车减震系统和动平均FIR滤波器为例，简单介绍了在工程应用中时域-频域、幅频-相频特性要折衷权衡考虑的思想。

---
### 课本习题
6.1, 6.4, 6.11, 6.14, 6.15, 6.17, 6.23, 6.24, 6.36
