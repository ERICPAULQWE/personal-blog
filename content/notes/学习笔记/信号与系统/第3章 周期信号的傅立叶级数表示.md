## 引言 

* **时域分析方法基础**:
    * 信号在时域的分解。 
    * LTI (线性时不变) 系统: 满足线性、时不变性。 
* **基本信号要求**:
    * 本身简单，且 LTI 系统对它的响应能简便得到。 
    * 具有普遍性，能够用以构成相当广泛的信号。 
* **傅立叶分析方法**:
    * 出发点: 将信号表示成一组基本信号的线性组合。 
    * 基本信号: 复指数信号 ($e^{st}$, $z^n$)。 
    * 信号表示形式: 傅立叶级数 (周期信号) 或 傅立叶变换 (非周期信号)。 

## 本章内容 

I.  周期信号的傅立叶级数 
II. 傅立叶级数的性质 
III.LTI 系统的频率响应 

## 3.1 历史的回顾 (A Historical Perspective) 

* 科学理论和方法是多人努力的结果，傅立叶分析法也经历了漫长的发展和争论过程。 
* 傅里叶生平 (Jean-Baptiste Joseph Fourier, 1768-1830): 
    * 1768年生于法国。 
    * 1807年提出“任何周期信号都可以用正弦函数的级数来表示”。 
    * 拉格朗日 (Lagrange) 反对发表。 
    * 1822年首次发表《热的分析理论》(Théorie analytique de la chaleur)。 
    * 1829年狄里赫利 (Dirichlet) 第一个给出收敛条件。 
* **傅里叶的两大贡献**: 
    * 周期信号可以表示为成谐波关系的正弦信号的加权和。 
    * 非周期信号可以表示为正弦信号的加权积分。 

## 3.2 LTI系统对复指数信号的响应 (The Response of LTI Systems to Complex Exponentials) 

* **LTI 系统对复指数输入的响应**: 
    * 连续时间: 输入 $x(t) = e^{st}$，输出 $y(t) = H(s)e^{st}$。 
        * 其中 $H(s) = \int_{-\infty}^{\infty} h(\tau) e^{-s\tau} d\tau$ 是系统的系统函数。 
    * 离散时间: 输入 $x(n) = z^n$，输出 $y(n) = H(z)z^n$。 
        * 其中 $H(z) = \sum_{k=-\infty}^{\infty} h(k) z^{-k}$ 是系统的系统函数。 
* **特征函数 (Eigenfunction)**: 如果系统对某输入的响应是该输入乘以一个常数，则该输入称为系统的特征函数，该常数称为特征值。 
* **结论**: 复指数函数 $e^{st}$ 和 $z^n$ 是所有 LTI 系统的特征函数。 
    * $H(s)$ 和 $H(z)$ 是对应的特征值。 
    * $H(s)=\int_{-\infty}^{\infty}h(t)e^{-st}dt$ 
    * $H(z)=\sum_{n=-\infty}^{\infty}h(n)z^{-n}$ 
    * 只有复指数函数才是一切 LTI 系统的特征函数。 
* **叠加性**: 若输入为复指数信号的线性组合： 
    * 连续时间: $x(t)=\sum_{k}a_{k}e^{s_{k}t} \longrightarrow y(t)=\sum_{k}a_{k}H(s_{k})e^{s_{k}t}$ 
    * 离散时间: $x(n)=\sum_{k}a_{k}Z_{k}^{n} \longrightarrow y(n)=\sum_{k}a_{k}H(Z_{k})Z_{k}^{n}$ 
* **核心问题**: 多大范围的信号可以用复指数信号的线性组合表示？ 

## 3.3 连续时间周期信号的傅里叶级数表示 (Fourier Series Representation of Continuous-Time Periodic Signals)

### 一. 连续时间傅里叶级数

* **成谐波关系的复指数信号集**: $\Phi_{k}(t)=\{e^{jk\omega_{0}t}\}$, $k=0,\pm1,\pm2,\cdot\cdot\cdot$
    * $\omega_0$ 是基波频率。
    * 每个信号周期为 $T_k = \frac{2\pi}{|k\omega_{0}|}$。
    * 公共周期 (基波周期) 为 $T_0 = \frac{2\pi}{|\omega_{0}|}$。
    * 集合中信号彼此独立。
* **傅里叶级数 (FS)**: 周期信号 $x(t)$ (周期 $T_0$) 可以表示为该集合中信号的线性组合：
    * $x(t)=\sum_{k=-\infty}^{\infty}a_{k}e^{jk\omega_{0}t}$ ($\omega_0 = \frac{2\pi}{T_0}$)
    * $a_k$ 称为傅里叶级数系数。
    * 这表明连续时间周期信号可以分解为无穷多个复指数谐波分量。
* **示例**:
    * 例1: $x(t)=cos~\omega_{0}t=\frac{1}{2}e^{j\omega_{0}t}+\frac{1}{2}e^{-j\omega_{0}t}$。系数 $a_{1}=a_{-1}=\frac{1}{2}$，其他为 0。
    * 例2: $x(t)=cos~\omega_{0}t+2~cos~3\omega_{0}t = \frac{1}{2}(e^{j\omega_{0}t}+e^{-j\omega_{0}t})+(e^{j3\omega_{0}t}+e^{-j3\omega_{0}t})$。系数 $a_{\pm 1}=\frac{1}{2}$, $a_{\pm 3}=1$。

### 二. 频谱 (Spectral) 的概念

* 信号集 $\Phi_{k}(t)$ 中各信号仅频率不同。
* 傅里叶级数中，各谐波分量 $a_{k}e^{jk\omega_{0}t}$ 的区别在于幅度和相位 ($a_k$) 及频率 ($k\omega_0$)。
* **频谱图**: 用 $a_k$ 与频率 $k\omega_0$ 的关系图来描述各分量。$a_k$的幅度和相位分别用一根线段来表示，用线段的位置表示相应的频率，所得到的$a_k$的幅度和相位与频率之间的关系图分别称为幅度谱和相位谱。
    * **幅度谱**: $|a_k|$ vs $k\omega_0$。
    * **相位谱**: $\angle a_k$ vs $k\omega_0$。
    * 由于 $k$ 取整数，频谱是离散的线状谱。
 >[!figure]+ Image: cos(ω₀t) 的幅度谱 Page 14
>![[Screenshot_20250421_200926 1.jpg|400]]
* 频谱图即 $a_k \sim \omega$ 的关系，完全代表了信号，称为信号的**频域表示法**。
* **示例**: $f(t)=1+sin~\omega_{1}t+2~cos~\omega_{1}t+cos(2\omega_{1}t+\frac{\pi}{4})$ 的频谱。 
    * $a_{0}=1$
    * $a_{1}=(1+\frac{1}{2j})=1.12e^{-j0.15\pi}$
    * $a_{-1}=(1-\frac{1}{2j})=1.12e^{j0.15\pi}$
    * $a_{2}=\frac{1}{2}e^{j\frac{\pi}{4}}$
    * $a_{-2}=\frac{1}{2}e^{-j\frac{\pi}{4}}$
    * $a_{k}=0$ for $|k|>2$
>[!figure]+ Image: 示例 f(t) 的幅度谱和相位谱 Page 16
>![[Screenshot_20250421_201649.jpg|400]]

### 三. 傅里叶级数的其它形式 

* **三角函数表示式**:
    * 若 $x(t)$ 是实信号，则 $a_k = a_{-k}^*$。 
    * 推导: $x(t) = a_0 + \sum_{k=1}^{\infty} [a_k e^{jk\omega_0 t} + a_{-k} e^{-jk\omega_0 t}]$ 
    * $x(t) = a_0 + \sum_{k=1}^{\infty} [a_k e^{jk\omega_0 t} + (a_k e^{jk\omega_0 t})^*] = a_0 + \sum_{k=1}^{\infty} 2 Re\{a_k e^{jk\omega_0 t}\}$ 
    * 令 $a_k = A_k e^{j\theta_k}$ (其中 $A_k = |a_k|$, $\theta_k = \angle a_k$):
        * $A_k = A_{-k}$ (幅度谱偶对称) 
        * $\theta_k = -\theta_{-k}$ (相位谱奇对称) 
        * $x(t) = a_0 + 2\sum_{k=1}^{\infty} A_k cos(k\omega_0 t + \theta_k)$ 
    * 令 $a_k = B_k + jC_k$:
        * $B_k = Re\{a_k\}$，$C_k = Im\{a_k\}$
        * $B_k = B_{-k}$ (实部偶对称) 
        * $C_k = -C_{-k}$ (虚部奇对称) 
        * $x(t) = a_0 + \sum_{k=1}^{\infty} [(B_k+jC_k)e^{jk\omega_0 t} + (B_k-jC_k)e^{-jk\omega_0 t}]$ 
        * $x(t) = a_0 + 2\sum_{k=1}^{\infty} [B_k cos(k\omega_0 t) - C_k sin(k\omega_0 t)]$ 

### 四. 连续时间傅里叶级数系数的确定 

* 利用复指数信号的正交性: $\int_{T_0} e^{j(k-n)\omega_0 t} dt = T_0 \delta_{kn}$。
* 推导:
    * $x(t) = \sum_{k=-\infty}^{\infty} a_k e^{jk\omega_0 t}$
    * $\int_{T_0} x(t) e^{-jn\omega_0 t} dt = \int_{T_0} \sum_{k=-\infty}^{\infty} a_k e^{j(k-n)\omega_0 t} dt$ 
    * $\int_{T_0} x(t) e^{-jn\omega_0 t} dt = \sum_{k=-\infty}^{\infty} a_k \int_{T_0} e^{j(k-n)\omega_0 t} dt = a_n T_0$
* **傅里叶系数计算公式 (分析式)**:
    * $$a_{k}=\frac{1}{T_{0}}\int_{T_{0}}x(t)e^{-jk\omega_{0}t}dt$$ (积分区间可以是任意一个周期) 
* **直流分量 (DC Component)**:
    * $$a_{0}=\frac{1}{T_{0}}\int_{T_{0}}x(t)dt$$ (信号在一个周期内的平均值) 

### 五. 周期性矩形脉冲信号的频谱 

* 信号描述: 周期 $T_0$，脉冲宽度 $2T_1$，幅度 1。 
* 计算 $a_k$: 
    * $a_{k}=\frac{1}{T_{0}}\int_{-T_{1}}^{T_{1}} 1 \cdot e^{-jk\omega_{0}t}dt = \frac{1}{T_0} [\frac{e^{-jk\omega_0 t}}{-jk\omega_0}]_{-T_1}^{T_1}$
    * $a_{k}=\frac{1}{T_0} \frac{e^{-jk\omega_0 T_1} - e^{jk\omega_0 T_1}}{-jk\omega_0} = \frac{1}{T_0} \frac{2 \sin(k\omega_0 T_1)}{k\omega_0}$
    * $a_{k}=\frac{2T_{1}}{T_{0}}\frac{sin(k\omega_{0}T_{1})}{k\omega_{0}T_{1}}$ 
* 利用 **Sa 函数 (Sampling function)**: $Sa(x) = \frac{\sin x}{x}$
    * $a_k = \frac{2T_1}{T_0} Sa(k\omega_0 T_1)$ 
* 利用 **sinc 函数**: $sinc(x) = \frac{\sin(\pi x)}{\pi x}$ (注意定义可能不同，这里用 $Sa$)
    * $a_k = \frac{2T_1}{T_0} sinc(\frac{k\omega_0 T_1}{\pi}) = \frac{2T_1}{T_0} sinc(\frac{2T_1}{T_0}k)$ 
    * **占空比 (Duty Cycle)**: $D = \frac{2T_1}{T_0}$。 
    * $a_k = D \cdot Sa(k \pi D)$
* $k=0$ 时，$a_0 = \frac{2T_1}{T_0} = D$ (平均值)。 
>[!figure]+ Image: Sa(x) 函数图像 Page 23
> ![[Screenshot_20250422_081115.jpg|350]]

* **频谱图特征**:
    * 包络线为 Sa 函数形状。
    * 谱线位置为 $k\omega_0 = k \frac{2\pi}{T_0}$。
    * 谱线间隔为 $\omega_0 = \frac{2\pi}{T_0}$。
    * 零点位置: $k\omega_0 T_1 = m\pi \implies k \frac{2\pi}{T_0} T_1 = m\pi \implies k \frac{2T_1}{T_0} = m \implies k D = m$ (m为非零整数)。即 $k = m/D$。
* **参数变化对频谱的影响**:
    * **$T_1$ 不变，$T_0 \uparrow$**: 占空比 $D \downarrow$。
        * 谱线间隔 $\omega_0 = \frac{2\pi}{T_0} \downarrow$ (谱线变密)。 
        * 幅度 $a_0 = D \downarrow$ (整体幅度下降)。 
        * 包络形状 $Sa(k\omega_0 T_1)$ 不变，但由于 $\omega_0$ 变小，包络在 $\omega$ 轴上被压缩，主瓣宽度（$\frac{2\pi}{T_1}$）不变，但包含的谱线数增加。 
>[!figure]+ 矩形脉冲频谱， $T_1$不变$T_0\uparrow$时
>![[Screenshot_20250422_082609.jpg|350]]

* **$T_0$ 不变，$T_1 \downarrow$**: 占空比 $D \downarrow$。
        **谱线间隔** $\omega_0 = \frac{2\pi}{T_0}$ 不变。
        **幅度** $a_0 = D \downarrow$ (整体幅度下降)。
        **包络形状** $Sa(k\omega_0 T_1)$ 改变，主瓣宽度（由 $T_1$ 决定，$\frac{2\pi}{T_1}$）变宽。
>[!figure]+ 矩形脉冲频谱, T₀不变$T_1\downarrow$
>![[Screenshot_20250422_081440 1.jpg|350]]
* **周期性矩形脉冲频谱特征总结**:
    1.  **离散性**: 频谱仅在 $k\omega_0$ 处有值。
    2.  **谐波性**: 频率是基频 $\omega_0$ 的整数倍。
    3.  **收敛性**: 幅度 $|a_k|$ 随 $k$ 增大而趋于 0 (大致按 $1/k$ 衰减)。

### 六. 信号对称性与频谱的关系

* **偶信号 (Even Signal)**: $x(t)=x(-t)$
    * $a_k = \frac{1}{T_0} \int_{-T_0/2}^{T_0/2} x(t) (\cos(k\omega_0 t) - j\sin(k\omega_0 t)) dt$
    * 由于 $x(t)\sin(k\omega_0 t)$ 是奇函数，积分为 0。
    * $a_k = \frac{1}{T_0} \int_{-T_0/2}^{T_0/2} x(t) \cos(k\omega_0 t) dt = \frac{2}{T_0} \int_{0}^{T_0/2} x(t) \cos(k\omega_0 t) dt$
    * 结论: **偶信号**的傅里叶系数 $a_k$ 是**实数**且是 $k$ 的**偶函数** ($a_k = a_{-k}$)。
* **奇信号 (Odd Signal)**: $x(t)=-x(-t)$
    * $a_k = \frac{1}{T_0} \int_{-T_0/2}^{T_0/2} x(t) (\cos(k\omega_0 t) - j\sin(k\omega_0 t)) dt$
    * 由于 $x(t)\cos(k\omega_0 t)$ 是奇函数，积分为 0。
    * $a_k = -j \frac{1}{T_0} \int_{-T_0/2}^{T_0/2} x(t) \sin(k\omega_0 t) dt = -j \frac{2}{T_0} \int_{0}^{T_0/2} x(t) \sin(k\omega_0 t) dt$
    * 结论: **奇信号**的傅里叶系数 $a_k$ 是**纯虚数**且是 $k$ 的**奇函数** ($a_k = -a_{-k}$)。

## 3.4 连续时间傅里叶级数的收敛 (Convergence of the Fourier series)

* 研究满足什么条件的周期信号可以表示为傅里叶级数。 

### 一. 傅里叶级数是对信号的最佳近似 

* 用有限项谐波 $x_N(t)=\sum_{k=-N}^{N}a_{k}e^{jk\omega_{0}t}$ 近似 $x(t)$。 
* **误差**: $e_{N}(t)=x(t)-x_{N}(t)$ 
* **均方误差 (Mean Squared Error, MSE)**: $E_{N}=\frac{1}{T_{0}}\int_{T_{0}}|e_{N}(t)|^{2}dt$ 
* 可以证明，当系数 $a_k$ 按傅里叶系数公式 $a_{k}=\frac{1}{T_{0}}\int_{T_{0}}x(t)e^{-jk\omega_{0}t}dt$ 选取时，均方误差 $E_N$ 最小。 
* **结论**: 在均方误差最小的准则下，傅里叶级数是对周期信号的最佳近似。 

### 二. 傅里叶级数的收敛条件 

* **收敛含义**: ① 系数 $a_k$ 是否存在？ ② 级数是否收敛于 $x(t)$？ 
* **条件组1：平方可积条件** 
    * 如果信号在一个周期内能量有限，即 $$\int_{T_{0}}|x(t)|^{2}dt<\infty$$
    * 则 $a_k$ 必定存在，且傅里叶级数在均方意义下收敛于 $x(t)$ (即 $\lim_{N\to\infty} E_N = 0$)。 
* **条件组2：狄里赫利条件 (Dirichlet Conditions)** 
    * 在一个周期内，信号 $x(t)$ 满足：
        1.  **绝对可积**: $$\int_{T_{0}}|x(t)|dt<\infty$$ (保证 $a_k$ 存在且有限 $|a_{k}|\le\frac{1}{T_{0}}\int_{T_{0}}|x(t)|dt$) 
        2.  **有限个极值点**: 在任何有限区间内，只有有限个极大值和极小值点且均为有限值。 
        3.  **有限个间断点**: 在任何有限区间内，只有有限个不连续点，且这些点都是**第一类间断点** (左右极限存在)。 傅里叶计傅里叶级数
    * 如果满足 Dirichlet 条件，则傅里叶级数**逐点收敛**:
        * 在 $x(t)$ 的连续点处，级数收敛于 $x(t)$。
        * 在 $x(t)$ 的间断点 $t_0$ 处，级数收敛于左右极限的平均值 $\frac{x(t_0^+) + x(t_0^-)}{2}$。
* 这两组条件都是**充分条件**，不是必要条件。Dirichlet 条件更强，保证逐点收敛。 
* 大多数实际中的周期信号都能满足这些条件。 
>[!figure]+ Image: 不满足 Dirichlet 条件的信号示例 (1/t, sin(2π/t)) Page 33
>![[Screenshot_20250422_092229.jpg|400]]

>[!figure]+ Image: 不满足 Dirichlet 条件的信号示例 (无限个极值点) 
>![[Screenshot_20250422_092314.jpg|350]]

### 三. 吉布斯现象 (Gibbs Phenomenon) 

* 研究傅里叶级数在间断点附近的收敛行为。
* 用有限项 $N$ 的傅里叶级数 $x_N(t)$ 逼近有间断点的信号 (如方波) 时，在间断点附近会出现：
    * **振荡 (Ringing)**。
    * **超量 (Overshoot)**: $x_N(t)$ 的峰值会超过原信号的最大值 (或低于最小值)。
* **特点**:
    * 当 $N \to \infty$ 时，超量的**幅度**趋于一个固定值，约为跳变高度的 9% (单边)。
    * 超量峰值的位置会向间断点压缩。
    * 振荡频率变高，并向间断点处压缩。
    * 虽然峰值不消失，但超量所占的**能量**会趋于 0 (因为宽度趋于 0)。
>[!figure]+ Image: Gibbs 现象 N=1,3,7,19,100 
>![[Screenshot_20250422_092609.jpg|450]]
>![[Screenshot_20250422_092625.jpg|350]]

## 3.5 连续时间傅里叶级数的性质 (Properties of Continuous-Time Fourier Series)

令 $x(t) \stackrel{FS}{\longleftrightarrow} a_k$ 和 $y(t) \stackrel{FS}{\longleftrightarrow} b_k$，周期均为 T，$\omega_0 = 2\pi/T$。

1.  **线性 (Linearity)**:
    * $Ax(t)+By(t) \stackrel{FS}{\longleftrightarrow} Aa_{k}+Bb_{k}$
2.  **时移 (Time Shifting)**:
    * $x(t-t_{0}) \stackrel{FS}{\longleftrightarrow} a_{k}e^{-jk\omega_{0}t_{0}}$
3.  **反转 (Time Reversal)**:
    * $x(-t) \stackrel{FS}{\longleftrightarrow} a_{-k}$
4.  **尺度变换 (Time Scaling)**:
    * $x(\alpha t)$ (周期 $T/\alpha$, $\alpha > 0$)
    * $x(\alpha t) \stackrel{FS}{\longleftrightarrow} a_k$ (系数不变，但基频变为 $\alpha \omega_0$)
    * 即 $x(\alpha t) = \sum_{k=-\infty}^{\infty} a_k e^{jk(\alpha\omega_0) t}$
5.  **相乘 (Multiplication)**:
    * $x(t) \cdot y(t) \stackrel{FS}{\longleftrightarrow} \sum_{l=-\infty}^{\infty}a_{l}b_{k-l} = (a * b)_k$ (系数的周期卷积)
    * 计算公式: $c_k = \frac{1}{T}\int_{T}x(t)y(t)e^{-jk\omega_{0}t}dt = \sum_{l=-\infty}^{\infty}a_{l}b_{k-l}$
6.  **共轭与共轭对称 (Conjugation and Conjugate Symmetry)**:
    * $x^{*}(t) \stackrel{FS}{\longleftrightarrow} a_{-k}^{*}$
    * **对于实信号 $x(t)$**: $x(t)=x^*(t) \implies a_k = a_{-k}^*$。
        * $|a_k| = |a_{-k}|$ (幅度谱偶对称) 
        * $\angle a_k = -\angle a_{-k}$ (相位谱奇对称)
        * $Re\{a_k\} = Re\{a_{-k}\}$ (实部偶对称)
        * $Im\{a_k\} = -Im\{a_{-k}\}$ (虚部奇对称)
    * 实偶信号 $x(t)=x(-t)$: $a_k$ 为实数且偶对称 ($a_k = a_{-k}$)
    * 实奇信号 $x(t)=-x(-t)$: $a_k$ 为纯虚数且奇对称 ($a_k = -a_{-k}$)
7.  **帕塞瓦尔定理 (Parseval's Theorem)**: 
    * $$\frac{1}{T}\int_{T}|x(t)|^{2}dt=\sum_{k=-\infty}^{+\infty}|a_{k}|^{2}$$ 
    * 意义: 信号在一个周期内的**平均功率**等于其所有谐波分量的**平均功率之和**。 
8.  **时域微分 (Differentiation)**: (未在性质列表明确列出，但例子中用到
    * $\frac{dx(t)}{dt} \stackrel{FS}{\longleftrightarrow} jk\omega_0 a_k$ 

* **性质应用示例**:
    * **例1**: 周期冲激串 $x(t)=\sum_{m=-\infty}^{+\infty}\delta(t-mT)$ 
        * $a_k = \frac{1}{T}\int_{-T/2}^{T/2} \delta(t) e^{-jk\omega_0 t} dt = \frac{1}{T} e^0 = \frac{1}{T}$ (对所有 k) 
        * $\sum_{m=-\infty}^{+\infty}\delta(t-mT) = \sum_{k=-\infty}^{\infty}\frac{1}{T}e^{jk\omega_{0}t}$ 
    * **例2**: 周期矩形脉冲 $g(t)$ (利用微分性质) 
        * $g'(t) = \sum_{m=-\infty}^{\infty} [\delta(t - mT + T_1) - \delta(t - mT - T_1)]$
        * $g'(t) = x(t+T_1) - x(t-T_1)$, 其中 $x(t)$ 是周期为 T 的单位冲激串。 
        * $x(t) \stackrel{FS}{\longleftrightarrow} a_k = 1/T$
        * $x(t+T_1) \stackrel{FS}{\longleftrightarrow} \frac{1}{T} e^{jk\omega_0 T_1}$ (时移)
        * $x(t-T_1) \stackrel{FS}{\longleftrightarrow} \frac{1}{T} e^{-jk\omega_0 T_1}$ (时移)
        * $g'(t) \stackrel{FS}{\longleftrightarrow} b_k = \frac{1}{T} (e^{jk\omega_0 T_1} - e^{-jk\omega_0 T_1}) = \frac{2j}{T} \sin(k\omega_0 T_1)$ 
        * $g(t) \stackrel{FS}{\longleftrightarrow} c_k$
        * $g'(t) \stackrel{FS}{\longleftrightarrow} jk\omega_0 c_k$ (微分性质) 
        * $jk\omega_0 c_k = b_k = \frac{2j}{T} \sin(k\omega_0 T_1)$
        * $c_k = \frac{2j \sin(k\omega_0 T_1)}{T (jk\omega_0)} = \frac{2 \sin(k\omega_0 T_1)}{T k\omega_0} = \frac{2T_1}{T} \frac{\sin(k\omega_0 T_1)}{k\omega_0 T_1}$ (与直接计算结果一致) 

## 3.6 离散时间周期信号的傅里叶级数表示 (Fourier Series Representation of Discrete-Time Periodic Signals) 

### 一. 离散时间傅里叶级数 (DFS - Discrete-Time Fourier Series) 

* **成谐波关系的离散时间复指数信号集**: $\Phi_{k}(n)=\{e^{j\frac{2\pi}{N}kn}\}$ 
    * 信号 $e^{j\frac{2\pi}{N}kn}$ 是关于 $n$ 的周期函数，周期为 $N$。 
    * 信号 $e^{j\frac{2\pi}{N}kn}$ 也是关于 $k$ 的周期函数，周期为 $N$。
    * 该集合中只有 $N$ 个**不同**的信号 (例如 $k=0, 1, ..., N-1$)。 
* **离散傅里叶级数 (DFS)**: 任何周期为 $N$ 的离散时间序列 $x(n)$ 可以表示为这 $N$ 个独立信号的线性组合： 
    * $x(n)=\sum_{k=<N>}a_{k}e^{j\frac{2\pi}{N}kn}$ 
    * $\sum_{k=<N>}$ 表示对任意 $N$ 个连续的 $k$ 值求和 (通常取 $k=0, ..., N-1$)。 
    * $a_k$ 称为 DFS 系数或频谱。 

### 二. 傅里叶级数系数的确定 

* 利用离散复指数序列的正交性: $\sum_{n=<N>}e^{j\frac{2\pi}{N}(k-r)n} = N \delta[(k-r) \pmod N]$。 
    * 当 $k$ 和 $r$ 都在 $0, ..., N-1$ 范围内时，$\sum_{n=0}^{N-1}e^{j\frac{2\pi}{N}(k-r)n} = \begin{cases} N, & k=r \\ 0, & k \neq r \end{cases}$ 
* 推导:
    * $x(n) e^{-j\frac{2\pi}{N}rn} = \sum_{k=<N>} a_k e^{j\frac{2\pi}{N}(k-r)n}$ 
    * $\sum_{n=<N>} x(n) e^{-j\frac{2\pi}{N}rn} = \sum_{n=<N>} \sum_{k=<N>} a_k e^{j\frac{2\pi}{N}(k-r)n}$ 
    * $\sum_{n=<N>} x(n) e^{-j\frac{2\pi}{N}rn} = \sum_{k=<N>} a_k (\sum_{n=<N>} e^{j\frac{2\pi}{N}(k-r)n}) = a_r N$ 
* **DFS 系数计算公式 (分析式)**: 
    * $$a_{k}=\frac{1}{N}\sum_{n=<N>}x(n)e^{-j\frac{2\pi}{N}kn}$$ 
* **DFS 系数的周期性**: $a_k$ 是关于 $k$ 的周期序列，周期为 $N$ ($a_{k+N}=a_k$)。 
* **实数序列 $x(n)$ 的 DFS 系数对称性**: $a_k^* = a_{-k \pmod N}$。 
    * $|a_k|=|a_{-k \pmod N}|$ (幅度谱偶对称) 
    * $\angle a_k = -\angle a_{-k \pmod N}$ (相位谱奇对称) 
    * $Re[a_k] = Re[a_{-k \pmod N}]$ (实部偶对称) 
    * $Im[a_k] = -Im[a_{-k \pmod N}]$ (虚部奇对称) 

### 三. 周期性方波序列的频谱 

* 信号描述: 周期 $N$, 在一个周期内 $x(n)=1$ for $-N_1 \le n \le N_1$, 0 otherwise。脉冲宽度 $M = 2N_1 + 1$。 
* 计算 $a_k$: 
    * $a_{k}=\frac{1}{N}\sum_{n=-N_{1}}^{N_{1}} 1 \cdot e^{-j\frac{2\pi}{N}kn}$ (几何级数求和)
    * $a_{k}=\frac{1}{N}\frac{sin(\frac{\pi}{N}k(2N_{1}+1))}{sin(\frac{\pi}{N}k)}$ for $k \neq mN$ 
    * $a_{k}=\frac{2N_{1}+1}{N} = \frac{M}{N}$ for $k = mN$ (平均值) 
* 包络形状类似于**离散 Sinc 函数 (Dirichlet Kernel)** $\frac{sin(Mx/2)}{sin(x/2)}$。 
>[!figure]+ Image: 周期方波序列频谱示例 (N=20, N1=2; N=10, N1=1; N=10, N1=2)
> ![[屏幕截图 2025-04-22 215522.png|450]]

* **参数变化影响**: 
    * $N_1$ 不变, $N \uparrow$: 幅度 $\downarrow$, 谱线变密, 包络形状不变但压缩。
    * $N$ 不变, $N_1 \downarrow$ ($M \downarrow$): 幅度 $\downarrow$, 谱线间隔不变, 包络主瓣变宽。

### 四. DFS的收敛 

* DFS 合成式 $x(n)=\sum_{k=<N>}a_{k}e^{j\frac{2\pi}{N}kn}$ 是有限项和。 
* DFS 分析式 $a_{k}=\frac{1}{N}\sum_{n=<N>}x(n)e^{-j\frac{2\pi}{N}kn}$ 也是有限项和。 
* 因此，DFS **不存在收敛问题**。 
* **不会产生吉布斯现象**。 
* DFS 频谱特点: 离散性、谐波性、收敛性 (幅度趋于0，虽然只有N项)、**周期性** (周期N)。 

## 3.7 DFS的性质 (Properties of Discrete-Time Fourier Series) 

令 $x(n) \stackrel{DFS}{\longleftrightarrow} a_k$ 和 $y(n) \stackrel{DFS}{\longleftrightarrow} b_k$，周期均为 N。求和/卷积都以 N 为模。

1.  **线性**: $Ax(n)+By(n) \stackrel{DFS}{\longleftrightarrow} Aa_k+Bb_k$
2.  **时移**: $x(n-n_0) \stackrel{DFS}{\longleftrightarrow} a_k e^{-j\frac{2\pi}{N}kn_0}$
3.  **频移**: $x(n)e^{j\frac{2\pi}{N}k_0 n} \stackrel{DFS}{\longleftrightarrow} a_{k-k_0}$
4.  **反转**: $x(-n) \stackrel{DFS}{\longleftrightarrow} a_{-k}$
5.  **周期卷积 (Circular Convolution)**:
    * $x(n) \circledast y(n) = \sum_{m=0}^{N-1} x(m)y(n-m) \stackrel{DFS}{\longleftrightarrow} N a_k b_k$
6.  **相乘 (Multiplication)**: 
    * $x(n)y(n) \stackrel{DFS}{\longleftrightarrow} \sum_{l=<N>} a_l b_{k-l} = (a \circledast b)_k$ (系数的周期卷积) 
7.  **差分 (First Difference)**: 
    * $x(n) - x(n-1) \stackrel{DFS}{\longleftrightarrow} a_k (1 - e^{-j\frac{2\pi}{N}k})$  (注意: 图示公式 $1-e^{-j\frac{2\pi}{N}k n_0}$ 似乎是结合了差分和移位 $n_0$，标准一阶差分是 $n_0=1$)
8.  **累加 (Accumulation)**: (差分的逆运算)
    * $\sum_{m=-\infty}^n x(m)$ (需处理收敛/周期性问题)
9.  **共轭与共轭对称**:
    * $x^*(n) \stackrel{DFS}{\longleftrightarrow} a_{-k}^*$
    * 实数序列 $x(n)$: $a_k = a_{-k}^*$ (周期 N)
10. **时域内插/扩展 (Time Expansion / Interpolation)**: 
    * 定义 $x_L(n) = \begin{cases} x(n/L) & \text{if } n = rL \\ 0 & \text{if } n \neq rL \end{cases}$ (周期 $LN$)
    * $m(n) \stackrel{DFS}{\longleftrightarrow} h_k = \frac{1}{L} a_{k \pmod N}$ (周期 $LN$)  (原系数幅度缩小，并在频域重复 L 次)
11. **帕塞瓦尔定理 (Parseval's Theorem)**: 
    * $\frac{1}{N}\sum_{n=<N>}|x(n)|^{2} = \sum_{k=<N>}|a_{k}|^{2}$ 
    * 意义: 序列在一个周期内的**平均功率**等于其 DFS 系数的**功率和**。

## 3.8 傅里叶级数与LTI系统 (Fourier Series and LTI Systems) 

* 复指数信号 $e^{st}$ / $z^n$ 是 LTI 系统的特征函数，对应特征值为系统函数 $H(s)$ / $H(z)$。 
* **频率响应 (Frequency Response)**: 系统函数在虚轴/单位圆上的取值。 即为**系统冲激响应**$h(n)$的**离散傅里叶变换**。
    * **连续时间**: $H(j\omega) = H(s)|_{s=j\omega} = \int_{-\infty}^{\infty}h(t)e^{-j\omega t}dt$ 
    * **离散时间**: $H(e^{j\omega}) = H(z)|_{z=e^{j\omega}} = \sum_{n=-\infty}^{\infty}h(n)e^{-j\omega n}$ 
    * $H(e^{j\omega})$ 是关于 $\omega$ 的周期函数，周期为 $2\pi$。 
* **LTI 系统对周期信号的响应**: 
    * LTI系统输入周期性信号 $x(t)$ 或 $x(n)$ 通过傅里叶级数/DFS 分解为谐波分量 $a_k e^{jk\omega_0 t}$ / $a_k e^{j\frac{2\pi}{N}kn}$。
    * 根据特征函数性质，每个谐波分量的输出为 $a_k H(jk\omega_0) e^{jk\omega_0 t}$ / $a_k H(e^{j\frac{2\pi}{N}k}) e^{j\frac{2\pi}{N}kn}$。
    * 利用叠加性，总输出为：
        * 连续时间: $y(t) = \sum_{k=-\infty}^{\infty} a_k H(jk\omega_0) e^{jk\omega_0 t}$ 
        * 离散时间: $y(n) = \sum_{k=<N>} a_k H(e^{j\frac{2\pi}{N}k}) e^{j\frac{2\pi}{N}kn}$ 
* **输出信号的 FS/DFS 系数**: $b_k = a_k H(\text{at harmonic frequency})$
* **结论**: 
    * LTI 系统对周期信号的响应**仍是周期信号** (相同周期)。 
    * 系统作用是对输入信号的**各个谐波分量**进行**幅度**和**相位**的调整 (由频率响应 $H(\cdot)$ 决定)。 
    * 此方法要求频率响应 $H(\cdot)$ 在谐波频率处**有限** (即系统稳定)。 
* **示例**: 
    * 离散时间 LTI 系统 $h(n) = \alpha^n u(n)$, $|\alpha|<1$。
    * 频率响应 $H(e^{j\omega}) = \frac{1}{1-\alpha e^{-j\omega}}$。
    * 输入 $x(n) = cos(\frac{2\pi}{N}n) = \frac{1}{2}e^{j\frac{2\pi}{N}n} + \frac{1}{2}e^{-j\frac{2\pi}{N}n}$。
    * 输入 DFS 系数 (非零): $a_1 = a_{-1} = 1/2$。
    * 输出 DFS 系数 (非零):
        * $b_1 = a_1 H(e^{j\frac{2\pi}{N}}) = \frac{1}{2} \frac{1}{1-\alpha e^{-j\frac{2\pi}{N}}}$
        * $b_{-1} = a_{-1} H(e^{-j\frac{2\pi}{N}}) = \frac{1}{2} \frac{1}{1-\alpha e^{j\frac{2\pi}{N}}}$
    * 输出信号 $y(n) = b_1 e^{j\frac{2\pi}{N}n} + b_{-1} e^{-j\frac{2\pi}{N}n}$。

## 3.9 滤波 Filtering 

* (移至第6章讲授) 

## 3.10 用微分方程描述的连续时间滤波器举例 

* (移至第6章讲授)

## 3.11 用差分方程描述的离散时间滤波器举例

* (移至第6章讲授)

## 3.12 小结 Summary

* 复指数函数是 LTI 系统的特征函数。
* 傅里叶级数 (FS/DFS) 将周期信号分解为谐波分量，实现频域分析。
* 研究了连续和离散周期信号的频谱特性及参数影响。
* 比较了 CTFS 和 DFS 的异同 (DFS 频谱具有周期性)。 
* 研究了 LTI 系统的频率响应及其对周期信号的作用。 

## 课本习题 

* 3.5, 3.8, 3.9, 3.11, 3.16, 3.33, 3.36 
