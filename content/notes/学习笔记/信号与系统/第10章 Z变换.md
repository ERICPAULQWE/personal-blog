本章主要内容包括Z变换的定义、收敛域（ROC）、性质、反变换，以及其在离散时间LTI系统分析中的应用。

---
## 10.0 引言 

Z变换在离散时间信号与系统分析中的地位，与拉普拉斯变换在连续时间信号与系统分析中的地位相当。它是离散时间傅里叶变换（DTFT）的推广。Z变换的基本思想、许多性质及其分析方法都与拉普拉斯变换有相似之处，但也存在一些重要的差异。

---
## 10.1 双边Z变换 (The z-Transform)

### 一. 双边Z变换的定义 
离散时间序列 $x(n)$ 的双边Z变换定义为：
$$X(z) = \sum_{n=-\infty}^{\infty} x(n)z^{-n}$$
其中，$z = re^{j\omega}$ 是一个复变量。

特别地：
* 当 $r=1$ 时，$z=e^{j\omega}$，Z变换即为离散时间傅立叶变换（DTFT）。这表明DTFT是在Z平面的**单位圆**上进行的Z变换。
* 我们可以将 $X(z)$ 视为序列 $x(n)r^{-n}$ 的傅立叶变换：
    $$X(re^{j\omega}) = \sum_{n=-\infty}^{\infty} (x(n)r^{-n})e^{-j\omega n} = \mathcal{F}[x(n)r^{-n}]$$
    $r$的大小决定了$x(n)$受影响的方式，$r>1$，$x(n)r^{-n}$随着$n$变大而递减，$0<r<1$，$x(n)r^{-n}$随着$n$变大而递增。
    因此，对 $x(n)$ 做Z变换等价于对 $x(n)r^{-n}$ 做DTFT。 Z变换是对DTFT的推广。

### 二. Z变换的收敛域 (Region of Convergence - ROC) 
Z变换并非对所有序列都存在，也不是对Z平面上的所有复数 $z$ 都收敛。
* **收敛域 (ROC)**：Z平面上那些能使 $X(z)$ 收敛的 $z$ 值的集合。
* **例1**: $x(n) = a^n u(n)$ 
    $$X(z) = \sum_{n=0}^{\infty} a^n z^{-n} = \sum_{n=0}^{\infty} (az^{-1})^n = \frac{1}{1-az^{-1}}$$
    这个几何级数收敛的条件是 $|az^{-1}| < 1$，即 $|z| > |a|$。这就是该信号Z变换的ROC。
    * 若 $|a|<1$，ROC包括单位圆，此时 $x(n)$ 的DTFT存在： $X(e^{j\omega}) = \frac{1}{1-ae^{-j\omega}}$。
    * Image: Z-plane for $x(n)=a^n u(n)$ with $|a|<1$
    	![[Screenshot_20250603_082658.jpg|150]]
* **例2**: $x(n) = u(n)$ (即 $a=1$ 的情况) 
    $$X(z) = \sum_{n=0}^{\infty} z^{-n}  =\frac{1}{1-z^{-1}}, \quad \text{ROC: } |z|>1$$
    此时ROC不包括单位圆，所以不能简单地从 $X(z)$ 通过将 $z \rightarrow e^{j \omega}$ 得到 $X(e^{j \omega})$ 。 
    Image: Z-plane for $x(n)=u(n)$ with pole at 1, ROC $|z|>1$
    	![[Screenshot_20250603_083227.jpg|150]]
    其DTFT包含冲激项： $X(e^{j\omega})=\frac{1}{1-e^{-j\omega}}+\sum_{k=-\infty}^{\infty}\pi\delta(\omega-2\pi k)$。 
* **例3**: 左边序列 $x(n) = -a^n u(-n-1)$ 
    $$X(z) = -\sum_{n=-\infty}^{-1} a^n z^{-n} = -\sum_{k=1}^{\infty} a^{-k} z^{k} = 1 - \sum_{k=0}^{\infty} (a^{-1}z)^k = 1 - \frac{1}{1-a^{-1}z} = \frac{-a^{-1}z}{1-a^{-1}z} = \frac{z}{z-a} = \frac{1}{1-az^{-1}}$$
    收敛条件为 $|a^{-1}z| < 1$，即 $|z| < |a|$。
     Image: Z-plane for $x(n)=-a^n u(-n-1)$, ROC $|z|<|a|$
     ![[Screenshot_20250603_083359.jpg|200]]
* **例4**: 双边序列 $x(n) = (\frac{1}{2})^n u(n) - 2^n u(-n-1)$ 
    $X(z) = \sum_{n=0}^{\infty} (\frac{1}{2})^nz^{-n}-\sum_{n=- \infty}^{-1} 2^nz^{-n} =\frac{1}{1-\frac{1}{2}z^{-1}} + \frac{1}{1-2z^{-1}}$ 
    (注意第二项实际上是 $-(-(2)^n u(-n-1))$ 的变换)
    第一个部分 $(\frac{1}{2})^n u(n)$ 的ROC是 $|z| > \frac{1}{2}$。
    第二个部分 $-(2)^n u(-n-1)$ 的ROC是 $|z| < 2$。
    总的ROC是两者交集： $\frac{1}{2} < |z| < 2$。
    Image: Z-plane for $x(n)=(1/2)^n u(n) - 2^n u(-n-1)$, ROC $1/2 < |z| < 2$
    ![[Screenshot_20250603_083913.jpg|150]]
    一般情况下，$X(z)$ 的ROC是Z平面上以原点为中心的圆环。 

**结论**: 
1.  Z变换存在收敛问题。
2.  $X(z)$ 的表达式本身不能唯一确定一个信号 $x(n)$，必须同时给出ROC才能建立一一对应关系。
3.  Z变换的ROC一般是以原点为中心的环形区域。
4.  若 $x(n) = \sum_i x_i(n)$，则其ROC是各个 $x_i(n)$ 的ROC的公共部分。若无公共区域，则 $x(n)$ 的Z变换不存在。
5.  当 $X(z)$ 是有理函数时，其ROC的边界总是由 $X(z)$ 的极点所在的圆周界定的。ROC内部不包含任何极点。
6.  若 $X(z)$ 的ROC包括单位圆，则 $X(e^{j\omega}) = X(z)|_{z=e^{j\omega}}$。

### 三. $X(z)$ 的几何表示——零极点图 
如果 $X(z)$ 是有理函数，可以表示为分子多项式 $N(z)$ 与分母多项式 $D(z)$之比：
$$X(z) = \frac{N(z)}{D(z)} = M \frac{\prod_i (z-z_i)}{\prod_p (z-z_p)}$$
其中 $z_i$ 是零点，$z_p$ 是极点，$M$ 是常数因子。
* **零极点图**：在Z平面上标出 $X(z)$ 的全部零点（用 '○' 表示）和极点（用 'X' 表示）。
* 如果在零极点图上同时标出ROC，则由该图可以唯一地确定一个信号。
* 零极点图对于描述和分析LTI系统特性非常重要。

---
## 10.2 Z变换的ROC特征 

1.  $X(z)$ 的ROC是Z平面上以原点为中心的环形区域。
2.  ROC内部不包含任何极点。 
3.  **有限长序列**:
    * 若序列仅在 $0 \le N_1 \le n \le N_2 < \infty$ 区间非零($x(n)$为有限长序列)，则ROC是整个Z平面，可能不包括 $z=0$ (若有 $z^{-k}$ 项) 或 $|z|=\infty$ (若有 $z^k$ 项)。
    * 例: $x(n) = a^n$ for $0 \le n \le N-1$. $X(z) = \frac{1-(az^{-1})^N}{1-az^{-1}} = \frac{z^N-a^N}{z^{N-1}(z-a)}$.除去在 $z=a$ 处可能的零极点对消，极点主要在 $z=0$。ROC一般为 $|z|>0$ (若 $N \ge 1$)。 
    	Image: Pole-zero plot $x(n)=a^n$ for $0 \le n \le N-1$ with N=8
    	![[Screenshot_20250603_085852 1.jpg|150]]
4.  **右边序列** ($x(n)=0$ for $n<N_1$): ROC是某个圆 $|z|>r_{max}$ 的外部区域 ( $r_{max}$ 是最外层极点的模值)，可能不包括 $|z|=\infty$ (如果序列在 $n<0$ 部分有值，导致 $X(z)$ 包含 $z$ 的正幂次项)。 
5.  **左边序列** ($x(n)=0$ for $n>N_1$): ROC是某个圆 $|z|<r_{min}$ 的内部区域 ( $r_{min}$ 是最内层非零极点的模值)，可能不包括 $z=0$ (如果序列在 $n>0$ 部分有值，导致 $X(z)$ 包含 $z$ 的负幂次高阶项，即在原点有极点)。 
6.  **双边序列**: 如果Z变换存在，ROC是一个环形区域 $r_1 < |z| < r_2$。 
    * 例: $x(n)=b^{|n|}$, $b>0$. 即 $x(n) = b^n u(n) + b^{-n} u(-n-1)$. 
        $X(z) = \frac{1}{1-bz^{-1}} - \frac{1}{1-b^{-1}z^{-1}}$. (注意，原课件 $b^{-n}u(-n-1)$ 的变换项符号有误，应为 $-\frac{1}{1-b^{-1}z^{-1}}$，其ROC为 $|z|<1/b$；$b^n u(n)$ 的变换为 $\frac{1}{1-bz^{-1}}$，ROC为 $|z|>b$ )。
        若 $0<b<1$，则 $b < 1/b$，ROC为 $b<|z|<1/b$。
        Image: Z-plane ROC for $x(n)=b^{|n|}$, $0<b<1$, showing an annulus $b < |z| < 1/b$
        	![[Screenshot_20250603_090128.jpg|150]]
        若 $b>1$，则 $b > 1/b$，ROC $|z|>b$ 与 $|z|<1/b$ 无交集，$X(z)$ 不存在。 
	* **例**: $X(z)=\frac{1}{(1-\frac{1}{3}z^{-1})(1-2z^{-1})}$. 极点 $p_1=1/3, p_2=2$。
		Image: $X(z)=1/((1-1/3z^{-1})(1-2z^{-1}))$ 的零级图
		![[Screenshot_20250603_085946 1.jpg|150]]
    	* ROC 1: $|z|>2 \implies$ 右边序列 (因果)，DTFT不存在。 
    	* ROC 2: $|z|<1/3 \implies$ 左边序列 (反因果)，DTFT不存在。 
    	* ROC 3: $1/3 < |z| < 2 \implies$ 双边序列，DTFT存在 (单位圆在ROC内)。 
* ROC是否包括 $|z|=\infty$ 是 $x(n)$ **是否因果**的标志 (对于有理函数，还要求分子阶数不大于分母阶数)。 
* ROC是否包括 $z=0$ 是 $x(n)$ **是否反因果**的标志 (对于有理函数，要求分母 $z$ 的最低次幂不低于分子 $z$ 的最低次幂)。 

---
## 10.3 Z-反变换 (The Inverse Z-Transform)

### 一. Z-反变换公式 
Z反变换由围线积分定义：
$$x(n) = \frac{1}{2\pi j} \oint_C X(z)z^{n-1}dz$$
其中 $C$ 是在ROC内逆时针环绕原点的闭合路径。

### 二. 反变换的求取方法
1.  **部分分式展开法**: 当 $X(z)$ 是有理函数时，可将其展开为部分分式。
    步骤： 
    1.  求出 $X(z)$ 的所有极点。
    2.  将 $X(z)$ 展开为部分分式，例如 $\sum_i \frac{A_i}{1-a_i z^{-1}}$ (对于单极点) 或更复杂的形式。
    3.  根据总的ROC，确定每一项的ROC。
        * 形如 $\frac{A}{1-az^{-1}}$ 的项，若其ROC为 $|z|>|a|$，则反变换为 $A a^n u(n)$。
        * 若其ROC为 $|z|<|a|$，则反变换为 $-A a^n u(-n-1)$。
    4.  利用常用变换对和Z变换性质求出每一项的反变换。
    * **例**: $X(z)=\frac{3-\frac{5}{6}z^{-1}}{(1-\frac{1}{4}z^{-1})(1-\frac{1}{3}z^{-1})}$, ROC: $\frac{1}{4}<|z|<\frac{1}{3}$. 
        $X(z) = \frac{1}{1-\frac{1}{4}z^{-1}} + \frac{2}{1-\frac{1}{3}z^{-1}}$. 
        第一项极点 $1/4$，ROC $|z|>1/4$ (与总ROC $\frac{1}{4}<|z|<\frac{1}{3}$ 一致)。
        第二项极点 $1/3$，ROC $|z|<1/3$ (与总ROC $\frac{1}{4}<|z|<\frac{1}{3}$ 一致)。
        $x(n) = (\frac{1}{4})^n u(n) - 2(\frac{1}{3})^n u(-n-1)$. 

2.  **幂级数展开法 (长除法)**: 
    由 $X(z) = \sum_{n=-\infty}^{\infty} x(n)z^{-n}$，展开式中 $z^{-n}$ 的系数即为 $x(n)$。
    * 若ROC为 $|z|>R_{max}$ (右边序列)，将 $X(z)$ 按 $z^{-1}$ 的升幂 (即 $z$ 的降幂) 进行长除，得到 $\sum_{n=N_0}^{\infty} c_n z^{-n}$。
    * 若ROC为 $|z|<R_{min}$ (左边序列)，将 $X(z)$ 按 $z$ 的升幂进行长除，得到 $\sum_{n=-\infty}^{N_1} d_n z^{-n}$。
    * 对双边序列，通常先将 $X(z)$ 分解为对应右边序列和左边序列的两部分和，再分别处理。 
    * 缺点：当 $X(z)$ 较复杂时，难以得出 $x(n)$ 的闭合表达式。适合求解某些非有理函数形式 $X(z)$ 的反变换或求序列的头几个值。 

3.  **留数法**:
    $x(n) = \sum_k \text{Res}[X(z)z^{n-1}, p_k]$，其中 $p_k$ 是 $X(z)z^{n-1}$ 在围线 $C$ 内部的极点。
    * 对于简单极点 $p_0$，$Res[F(z),p_0] = \lim_{z \to p_0} (z-p_0)F(z)$。
    * 对于 $m$ 阶极点 $p_0$，$Res[F(z),p_0] = \frac{1}{(m-1)!} \lim_{z \to p_0} \frac{d^{m-1}}{dz^{m-1}}[(z-p_0)^m F(z)]$。

---
## 10.4 由零极点图对离散时间傅立叶变换几何求值 
当ROC包括单位圆 $|z|=1$ 时，$X(e^{j\omega})$ 可以通过零极点图进行几何求值。
$X(z) = M \frac{\prod_i (z-z_i)}{\prod_k (z-p_k)}$，则 $X(e^{j\omega}) = M \frac{\prod_i (e^{j\omega}-z_i)}{\prod_k (e^{j\omega}-p_k)}$。
$|X(e^{j\omega})| = |M| \frac{\prod_i |e^{j\omega}-z_i|}{\prod_k |e^{j\omega}-p_k|}$ (幅频特性)。
$\angle X(e^{j\omega}) = \angle M + \sum_i \angle(e^{j\omega}-z_i) - \sum_k \angle(e^{j\omega}-p_k)$ (相频特性)。
$|e^{j\omega}-q|$ 是从点 $q$ (零点或极点) 到单位圆上点 $e^{j\omega}$ 的向量长度。
$\angle(e^{j\omega}-q)$ 是该向量与正实轴的夹角。

* **一阶系统示例**: $H(z) = \frac{1}{1-az^{-1}} = \frac{z}{z-a}$ (零点在 $z=0$，极点在 $z=a$)。 
    $|H(e^{j\omega})| = \frac{|e^{j\omega}|}{|e^{j\omega}-a|} = \frac{1}{|e^{j\omega}-a|}$ (因为零点在原点)。
     Image: 一阶系统的零级图
     ![[Screenshot_20250603_090804.jpg|150]]
    * 若 $0 < a < 1$ (低通特性): 极点在正实轴。当 $\omega=0$, $e^{j\omega}=1$, 分母 $|1-a|$ 最小, 幅度最大。当 $\omega=\pi$, $e^{j\omega}=-1$, 分母 $|-1-a|=1+a$ 最大, 幅度最小。
    * Image: $H(z)=1/(1-az^{-1})$ with $0<a<1$ 的幅频特性
    	![[Screenshot_20250603_090836.jpg|150]]
	* Image: $H(z)=1/(1-az^{-1})$ with $0<a<1$ 的相频特性
		![[Screenshot_20250603_090848.jpg|150]]
    * 若 $-1 < a < 0$ (高通特性): 极点在负实轴。当 $\omega=0$, 分母 $|1-a|=1+|a|$ 最大, 幅度最小。当 $\omega=\pi$, 分母 $|-1-a|=|-(1+a)| = |1-|a||$ 最小, 幅度最大。
    * Image: $H(z)=1/(1-az^{-1})$ with $-1<a<0$的相频特性
	    ![[Screenshot_20250606_083527.jpg|150]]
    * Image: $H(z)=1/(1-az^{-1})$ with $-1<a<0$的幅频特性
	    ![[Screenshot_20250606_083539.jpg|150]]
    * $|a|$ 越小，极点越靠近原点，频响越平缓，带宽越宽。$h(n)$ 衰减越快。 
    * $|a|$ 越大，极点越靠近单位圆，频响越尖锐，带宽越窄。 

* **二阶系统示例**: $H(z) = \frac{1}{1-2r\cos\theta z^{-1} + r^2 z^{-2}}$ (零点在 $z=0$ (二阶)，共轭极点在 $re^{\pm j\theta}$)。 
    $|H(e^{j\omega})| = \frac{1}{|e^{j\omega}-re^{j\theta}||e^{j\omega}-re^{-j\theta}|}$. 
    Image: 二阶系统的零极图
    	![[Screenshot_20250603_091012.jpg|150]]
    当 $e^{j\omega}$ 靠近极点 $re^{\pm j\theta}$ (即 $\omega \approx \pm\theta$) 时，对应分母项的向量长度变小，幅度出现峰值 (带通/带阻特性)。 
    $r$ 越接近1，峰值越尖锐。
    Image: $H(z)=1/(1-2r\cos\theta z^{-1}+r^2 z^{-2})$的幅频曲线与幅度的关系
    	![[第10章_20250603_091051_1.png|150]]
	Image: Z平面中的极点位置与信号的时域特性的关系
		![[第10章_20250603_091051_2.png|150]]

---
## 10.5 Z变换的性质 

1.  **线性 (Linearity)**: 
    $ax_1(n) + bx_2(n) \leftrightarrow aX_1(z) + bX_2(z)$
    ROC: 至少为 $R_1 \cap R_2$。若发生零极点对消，ROC可能扩大。 

2.  **时移 (Time Shifting)**: 
    $x(n-n_0) \leftrightarrow z^{-n_0}X(z)$
    ROC: $R$，但可能增加或删除 $z=0$ 或 $|z|=\infty$。
    由于信号时移可能会改变其因果性，故会使ROC在$z=0$$，|z|= \infty$可能有改变

3.  **Z域尺度变换 (Scaling in z-domain / Multiplication by an exponential)**: 
    $z_0^n x(n) \leftrightarrow X(\frac {z}{z_0})$. ROC: $|z_0|R$ (即若原ROC为 $r_1<|z|<r_2$，新ROC为 $|z_0|r_1<|z|<|z_0|r_2$) 。
    Image: Z-domain scaling example, pole at 1/2 scaled by $r_0=2$ to 1
    	![[Screenshot_20250603_091552.jpg|250]]

4.  **时域反转 (Time Reversal)**: 
    $x(-n) \leftrightarrow X(z^{-1})$. ROC: $1/R$ (即若原ROC为 $r_1<|z|<r_2$，新ROC为 $1/r_2<|z|<1/r_1$) 。
    如果$z_i$是$X(z)$的零极点，则$\frac {1}{z_i}$就是$X(z^{-1})$的零极点。由于$z^*_i$也是$X(z)$的零极点，因此$\frac {1}{z^*_i}$也是$X(z^{-1})$的零极点
    即：$X(z)$与$X(z^{-1})$的零极点呈**共轭倒量对称**
    Image: Pole transformation under time reversal $z_i \to 1/z_i$
    ![[Screenshot_20250606_090605.jpg|150]]

5.  **时域内插 (Time Expansion / Upsampling)**: 
    $x_k(n) = \begin{cases} x(n/k) & \text{if } n \text{ is a multiple of } k \\ 0 & \text{otherwise} \end{cases} \leftrightarrow X(z^k)$. ROC: $R^{1/k}$ (即若原ROC为 $r_1<|z|<r_2$，新ROC为 $r_1^{1/k}<|z|<r_2^{1/k}$) 。
    

6.  **共轭对称性 (Conjugation)**: 
    $x^*(n) \leftrightarrow X^*(z^*)$. ROC: $R$.
    若 $x(n)$ 为实序列，$X(z) = X^*(z^*)$，这意味着 $X(z)$ 的复数零极点必共轭成对出现。

7.  **卷积性质 (Convolution)**: 
    $x_1(n) * x_2(n) \leftrightarrow X_1(z)X_2(z)$. ROC: 至少为 $R_1 \cap R_2$。若发生零极点对消，ROC可能扩大。 
    这是用Z变换分析LTI系统的理论基础。

8.  **Z域微分 (Differentiation in z-domain / Multiplication by n)**: 
    $nx(n) \leftrightarrow -z\frac{dX(z)}{dz}$. ROC: $R$.
    * 例: $X(z) = \ln(1+az^{-1}), |z|>|a| \implies x(n) = -\frac{1}{n}(-a)^n u(n-1)$. 
    * 例: 从 $a^n u(n) \leftrightarrow \frac{1}{1-az^{-1}}$，可得 $na^n u(n) \leftrightarrow \frac{az^{-1}}{(1-az^{-1})^2}$. 

9.  **初值定理 (Initial Value Theorem)**: 
    若 $x(n)$ 为因果序列 ($x(n)=0$ for $n<0$)，则 $x(0) = \lim_{z\rightarrow\infty} X(z)$。

10. **终值定理 (Final Value Theorem)**: 
    若 $x(n)$ 为因果序列，且 $X(z)(z-1)$ 的所有极点都在单位圆内部 (即 $X(z)$ 的极点都在单位圆内，除了在 $z=1$ 处允许有一个一阶极点)，则 $\lim_{n\rightarrow\infty} x(n) = \lim_{z\rightarrow 1} (z-1)X(z)$。 

**常用Z变换对**: 
* $\delta(n) \leftrightarrow 1$, ROC: 所有 $z$
* $u(n) \leftrightarrow \frac{1}{1-z^{-1}}$, ROC: $|z|>1$
* $a^n u(n) \leftrightarrow \frac{1}{1-az^{-1}}$, ROC: $|z|>|a|$
* $-a^n u(-n-1) \leftrightarrow \frac{1}{1-az^{-1}}$, ROC: $|z|<|a|$
* $n a^n u(n) \leftrightarrow \frac{az^{-1}}{(1-az^{-1})^2}$, ROC: $|z|>|a|$
* $(n+1)a^n u(n) \leftrightarrow \frac{1}{(1-az^{-1})^2}$, ROC: $|z|>|a|$
* $\cos(\omega_0 n)u(n) \leftrightarrow \frac{1-z^{-1}\cos\omega_0}{1-2z^{-1}\cos\omega_0+z^{-2}}$, ROC: $|z|>1$

---
## 10.7 利用Z变换分析与表征LTI系统 

LTI系统的特性可以由其单位脉冲响应 $h(n)$ 的Z变换 $H(z)$ (称为系统函数) 及其ROC来表征。

### 一. 系统特性与 $H(z)$ 的关系
1.  **因果性 (Causality)**: 
    * LTI系统因果 $\iff H(z)$ 的ROC是某个圆的外部且包括 $|z|=\infty$。
    * 若 $H(z)$ 有理，则系统因果 $\iff H(z)$ 的ROC是最外部极点的外部，并且 $H(z)$ 分子多项式关于 $z^{-1}$ 的阶次不大于分母多项式的阶次 (即 $H(z)$ 是 $z^{-1}$ 的proper有理函数，或者说 $H(z)$ 关于 $z$ 的分子阶数不大于分母阶数)。

2.  **稳定性 (Stability)**: 
    * LTI系统BIBO稳定 $\iff \sum_{n=-\infty}^{\infty} |h(n)| < \infty$。
    * 这等价于 $h(n)$ 的DTFT存在，即 $H(z)$ 的ROC必须包括单位圆 $|z|=1$。
    * 对于有理系统函数 $H(z)$ 的**因果**LTI系统，稳定的充要条件是 $H(z)$ 的所有极点都必须位于单位圆内部。 

### 二. LTI系统的Z变换分析法 
1.  由输入信号 $x(n)$ 求得 $X(z)$ 及其ROC $R_x$。
2.  由系统描述求得系统函数 $H(z)$ 及其ROC $R_h$。
3.  计算输出信号的Z变换 $Y(z) = H(z)X(z)$，其ROC包含 $R_x \cap R_h$。
4.  对 $Y(z)$ 做反变换得到输出信号 $y(n)$。

### 三. 由LCCDE描述的LTI系统的 $H(z)$ 
线性常系数差分方程 (LCCDE)：
$$\sum_{k=0}^{N} a_k y(n-k) = \sum_{k=0}^{M} b_k x(n-k)$$
假设系统初始松弛 (zero initial conditions for $H(z)$ derivation)，对方程两边取Z变换：
$$\left(\sum_{k=0}^{N} a_k z^{-k}\right)Y(z) = \left(\sum_{k=0}^{M} b_k z^{-k}\right)X(z)$$
系统函数为：
$$H(z) = \frac{Y(z)}{X(z)} = \frac{\sum_{k=0}^{M} b_k z^{-k}}{\sum_{k=0}^{N} a_k z^{-k}}$$
这是一个有理函数。其ROC需要根据系统的因果性或稳定性等附加条件来确定。

* **例 (FIR系统)**: $y(n)=x(n)-5x(n-1)+8x(n-3)$. 
    $H(z) = 1-5z^{-1}+8z^{-3}$. $h(n)=\delta(n)-5\delta(n-1)+8\delta(n-3)$.
    Image: FIR system block diagram
* **例 (IIR系统)**: $y(n)-3y(n-1)+3y(n-2)-y(n-3)=x(n)$. 
    $H(z) = \frac{1}{1-3z^{-1}+3z^{-2}-z^{-3}} = \frac{1}{(1-z^{-1})^3}$.
    若系统因果，ROC为 $|z|>1$。 $h(n) = \frac{(n+1)(n+2)}{2}u(n)$.
    Image: IIR system block diagram (Direct Form II like)

---
## 10.8 系统函数的代数属性与方框图表示 

### 一. 系统互联的系统函数
1.  **级联 (Cascade)**: $H(z) = H_1(z)H_2(z)$. ROC包含 $R_1 \cap R_2$. 
2.  **并联 (Parallel)**: $H(z) = H_1(z)+H_2(z)$. ROC包含 $R_1 \cap R_2$. (ROC可能扩大) 
3.  **反馈 (Feedback)**: 对于标准负反馈结构（前向通路 $H_1(z)$，反馈通路 $G(z)$），总系统函数为 $H(z) = \frac{H_1(z)}{1+H_1(z)G(z)}$. ROC由 $H_1(z)$, $G(z)$ 的ROC及新极点位置决定。 

### 二. LTI系统的级联与并联型结构 
有理系统函数 $H(z)$ 可以通过因式分解或部分分式展开来实现级联或并联结构。
1.  **级联型**: 将 $H(z)$ 分解为一阶或二阶子系统的乘积。 
    $H(z) = \frac{b_0}{a_0} \prod_{k} H_k(z)$, 其中 $H_k(z)$ 为形如 $\frac{1+\mu_k z^{-1}}{1+\eta_k z^{-1}}$ 或 $\frac{1+\beta_{1k}z^{-1}+\beta_{2k}z^{-2}}{1+\alpha_{1k}z^{-1}+\alpha_{2k}z^{-2}}$。
    Image: LTI system cascade structure
2.  **并联型**: 将 $H(z)$ （若为proper）展开为部分分式（可能含有一个常数项）。 
    $H(z) = C + \sum_k H_k(z)$, 其中 $H_k(z)$ 为形如 $\frac{A_k}{1+\eta_k z^{-1}}$ 或 $\frac{\gamma_{0k}+\gamma_{1k}z^{-1}}{1+\alpha_{1k}z^{-1}+\alpha_{2k}z^{-2}}$。
    Image: LTI system parallel structure

---
## 10.9 单边Z变换 (The Unilateral Z-Transform) 

### 一. 单边Z变换定义
单边Z变换定义为：
$$\mathcal{X}(z) = \sum_{n=0}^{\infty} x(n)z^{-n}$$
它是双边Z变换在信号为因果信号 ($x(n)=0$ for $n<0$) 时的特例。因此其ROC一定是最外部极点的外部区域，并包括 $|z|=\infty$ (若 $\mathcal{X}(z)$ 有理)。 
* 若信号 $x(n)$ 本身不是因果序列，其双边Z变换 $X(z)$ 与单边Z变换 $\mathcal{X}(z)$ 不同，因为单边Z变换不考虑 $n<0$ 的部分。 
    * 例: $x(n) = a^{n+1}u(n+1)$. 这是一个从 $n=-1$ 开始的序列。 
        双边 $X(z) = \sum_{n=-1}^{\infty} a^{n+1}z^{-n} = z + a + a^2z^{-1} + \dots = \frac{z}{1-az^{-1}}$, ROC: $|z|>|a|$.
        单边 $\mathcal{X}(z) = \sum_{n=0}^{\infty} a^{n+1}z^{-n} = a + a^2z^{-1} + \dots = \frac{a}{1-az^{-1}}$, ROC: $|z|>|a|$.
        两者不相等，因为 $x(-1)$ 对双边Z变换有贡献，但对单边Z变换无贡献。 

### 二. 单边Z变换的性质 
多数性质与双边Z变换一致 (因涉及的信号视为因果)。主要区别在于**时移特性**，因为它需要考虑初始值。
* **时移特性**: 
    * $\mathcal{Z}\{x(n-1)\} = z^{-1}\mathcal{X}(z) + x(-1)$
    * $\mathcal{Z}\{x(n-2)\} = z^{-2}\mathcal{X}(z) + z^{-1}x(-1) + x(-2)$
    * $\mathcal{Z}\{x(n+1)\} = z\mathcal{X}(z) - zx(0)$
    * $\mathcal{Z}\{x(n+2)\} = z^2\mathcal{X}(z) - z^2x(0) - zx(1)$

### 三. 利用单边Z变换分析增量线性系统 (系统含初始条件) 
单边Z变换在将LCCDE变换为代数方程时，可以自动将方程的初始条件引入。
* **例**: $y(n)+3y(n-1)=x(n)$, 输入 $x(n)=u(n)$, 初始条件 $y(-1)=1$. 
    取单边Z变换： $\mathcal{Y}(z) + 3[z^{-1}\mathcal{Y}(z) + y(-1)] = \mathcal{X}(z)$.
    $\mathcal{X}(z) = \frac{1}{1-z^{-1}}$.
    $(1+3z^{-1})\mathcal{Y}(z) + 3y(-1) = \mathcal{X}(z)$.
    $\mathcal{Y}(z) = \frac{\mathcal{X}(z)}{1+3z^{-1}} - \frac{3y(-1)}{1+3z^{-1}}$.
    代入 $y(-1)=1$ 和 $\mathcal{X}(z)$:
    $\mathcal{Y}(z) = \frac{1}{(1-z^{-1})(1+3z^{-1})} - \frac{3}{1+3z^{-1}}$
    $= \left(\frac{1/4}{1-z^{-1}} + \frac{3/4}{1+3z^{-1}}\right) - \frac{3}{1+3z^{-1}} = \frac{1/4}{1-z^{-1}} - \frac{9/4}{1+3z^{-1}}$. 
    $y(n) = \left[\frac{1}{4} - \frac{9}{4}(-3)^n\right]u(n)$. 
    第一部分 $\frac{\mathcal{X}(z)}{1+3z^{-1}}$ 对应零状态响应，第二部分 $\frac{-3y(-1)}{1+3z^{-1}}$ 对应零输入响应。

---
## 10.10 小结 (Summary) 

1.  Z变换是分析离散时间信号和系统的有力工具，与拉普拉斯变换在连续时间中的作用类似。
2.  **s平面与Z平面的映射关系**: $z = e^{sT}$。 
    其中 $T$ 是采样周期。此关系由连续信号 $x_c(t)$ 采样得到离散序列 $x(n)=x_c(nT)$ 而来。
    $X_p(s) = \sum x_c(nT)e^{-snT}$ (采样信号的拉氏变换) 与 $X(z) = \sum x_c(nT)z^{-n}$ (序列的Z变换) 比较得出。 
    * $s=\sigma+j\omega \implies z = e^{\sigma T} e^{j\omega T}$. 令 $r=e^{\sigma T}$ 和 $\Omega=\omega T$.
    * s平面的虚轴 ($\sigma=0$) 映射到Z平面的单位圆 ($r=1$)。 
    * s平面的左半平面 ($\sigma<0$) 映射到Z平面的单位圆内部 ($r<1$)。 
    * s平面的右半平面 ($\sigma>0$) 映射到Z平面的单位圆外部 ($r>1$)。 
    * s平面上的主带 $-\pi/T \le \omega \le \pi/T$ 映射为Z平面的整个区域。
    [Image: Mapping $z=e^{sT}$ from s-plane to z-plane ]
    这种映射关系在数字滤波器设计等领域非常重要。 
3.  Z变换分析LTI系统比DTFT更普适（如可分析不稳定系统）。 
4.  单边Z变换是分析带初始条件的线性系统的有效工具。 

---
**补充知识点：**
* **BIBO稳定性**: 系统有界输入产生有界输出 (Bounded-Input Bounded-Output)。对于LTI系统，BIBO稳定的充要条件是其单位脉冲响应 $h(n)$ 绝对可和，即 $\sum_{n=-\infty}^{\infty} |h(n)| < \infty$。
* **LTI系统响应**: 总响应 = 零状态响应 (Zero-State Response, ZSR) + 零输入响应 (Zero-Input Response, ZIR)。
    * ZSR是系统在初始状态为零时，仅由输入信号引起的响应， $Y_{ZSR}(z) = H(z)X(z)$。
    * ZIR是输入信号为零时，仅由系统初始状态引起的响应。单边Z变换在求解差分方程时可以方便地同时得到ZSR和ZIR。
