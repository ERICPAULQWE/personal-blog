
# DSP 期末复习笔记：Z 变换、离散 LTI 系统、极点零点与 FIR（本科版·详细）

> 适用：本科《数字信号处理》《信号与系统（离散部分）》期末复习  
> 目标：**会算、会判、会写步骤**（而不是只记概念）  
> 约定：离散时间序列用 $x[n]$；Z 变换变量为 $z$（复数）；频率响应在单位圆 $z=e^{j\omega}$ 上讨论。  
> 重点提示：**写 Z 变换时必须同时给出 ROC（收敛域）**，否则很多题信号不唯一。

---

## 0. 预备知识（必须熟）

### 0.1 三个基础序列
- 单位冲激：
  $$\delta[n]=\begin{cases}1,&n=0\\0,&n\neq 0\end{cases}$$
- 单位阶跃（常用定义）：
  $$u[n]=\begin{cases}1,&n\ge 0\\0,&n<0\end{cases}$$
- 指数序列（右边序列）：
  $$a^n u[n]$$

### 0.2 三个基本操作（最易错）
- **时移**：$x[n-n_0]$ 向右移 $n_0$；$x[n+n_0]$ 向左移 $n_0$  
  口诀：**减号向右、加号向左**
- **翻转**：$x[-n]$
- **有限长序列构造**（常考）：
  $$u[n]-u[n-N]\quad\Rightarrow\quad n=0,1,\dots,N-1\ \text{为 1，其余为 0}$$

---

## 1. Z 变换定义与直觉

### 1.1 双边 Z 变换定义
$$X(z)=\sum_{n=-\infty}^{\infty}x[n]z^{-n}$$

> 直觉：$z^{-n}$ 像“离散指数基函数”，Z 变换把序列投影到这些基函数上。  
> 更关键的工程直觉：**时域延迟 ↔ Z 域乘 $z^{-1}$**，让差分方程变代数方程。

### 1.2 什么时候必须写 ROC？
只要出现无限求和（例如 $u[n]$、$a^n u[n]$、系统函数分式等），就必须给 ROC。  
**有限长序列**（只有有限个非零样本）通常 Z 变换存在，ROC 很“宽”，但仍建议写清楚（至少说明不含极点）。

---

## 2. ROC（收敛域）——Z 变换的灵魂

### 2.1 ROC 的定义
ROC（Region of Convergence）是使级数
$$\sum_{n=-\infty}^{\infty}x[n]z^{-n}$$
**收敛**的 $z$ 的集合。

### 2.2 三类序列与 ROC 形状（必背 + 必会用）
设 $X(z)$ 为有理函数（分式），其极点为 $p_k$，定义
- $r_{\max}=\max_k |p_k|$
- $r_{\min}=\min_k |p_k|$

**基本事实：ROC 不包含任何极点。**

1) **右边序列（因果/右支撑）**：$x[n]=0$ 对所有 $n<n_0$  
ROC 形如
$$|z|>r_{\max}\quad(\text{外侧，包含}\ \infty)$$

2) **左边序列（反因果/左支撑）**：$x[n]=0$ 对所有 $n>n_0$  
ROC 形如
$$|z|<r_{\min}\quad(\text{内侧，包含}\ 0)$$

3) **双边序列**：左右两侧都非零  
ROC 形如
$$r_1<|z|<r_2\quad(\text{环形区域，不含}\ 0,\infty)$$

### 2.3 同一个 $X(z)$，不同 ROC → 不同 $x[n]$（期末陷阱）
例：
$$X(z)=\frac{1}{1-\frac12 z^{-1}}$$
- 若 ROC：$|z|>\frac12$（外侧）  
  $$x[n]=\left(\frac12\right)^n u[n]$$
- 若 ROC：$|z|<\frac12$（内侧）  
  $$x[n]=-\left(\frac12\right)^n u[-n-1]$$

---

## 3. 常见序列的 Z 变换（必会“看到就写”）

> 记忆技巧：把 $\frac{1}{1-a z^{-1}}$ 当成最重要的“母式”，ROC 决定右边还是左边。

### 3.1 冲激与移位冲激
- $\delta[n]\leftrightarrow 1$
- $\delta[n-n_0]\leftrightarrow z^{-n_0}$

推导（考试写法）：
$$\sum_{n=-\infty}^{\infty}\delta[n-n_0]z^{-n}=z^{-n_0}$$

### 3.2 阶跃
$$u[n]\leftrightarrow \frac{1}{1-z^{-1}},\quad \text{ROC: }|z|>1$$

推导要点：等比级数
$$\sum_{n=0}^{\infty}z^{-n}=\frac{1}{1-z^{-1}},\ |z|>1$$

### 3.3 右边指数（最常考）
$$a^n u[n]\leftrightarrow \frac{1}{1-a z^{-1}},\quad \text{ROC: }|z|>|a|$$

推导要点：公比为 $a z^{-1}$ 的等比级数。

### 3.4 左边指数（常考陷阱）
$$-a^n u[-n-1]\leftrightarrow \frac{1}{1-a z^{-1}},\quad \text{ROC: }|z|<|a|$$

### 3.5 有限长矩形序列（构造题神器）
$$u[n]-u[n-N]\leftrightarrow \frac{1-z^{-N}}{1-z^{-1}}$$

---

## 4. Z 变换性质（刷题加速器）

### 4.1 线性
若 $x[n]\leftrightarrow X(z)$，$y[n]\leftrightarrow Y(z)$，则
$$a x[n]+b y[n]\leftrightarrow aX(z)+bY(z)$$

### 4.2 时移（超级常考）
$$x[n-n_0]\leftrightarrow z^{-n_0}X(z)$$

常见对偶：
$$\frac{z^{-1}}{1-a z^{-1}}\leftrightarrow a^{n-1}u[n-1]$$

### 4.3 指数加权（变量代换）
$$a^n x[n]\leftrightarrow X\!\left(\frac{z}{a}\right)$$

**什么意思？**：把 $X(z)$ 里的 $z$ 全部替换为 $z/a$。  
ROC 也随之缩放：若原 ROC 为 $|z|>R$，则新 ROC 为 $|z|>|a|R$（右边序列场景）。

### 4.4 卷积定理（系统题核心）
$y[n]=x[n]*h[n]$（离散卷积）对应
$$Y(z)=X(z)H(z)$$

---

## 5. 初值定理与终值定理（会用才给分）

### 5.1 初值定理
若 $x[n]$ 合适（常见右边有理序列），则
$$x[0]=\lim_{z\to\infty}X(z)$$

例：
$$X(z)=\frac{2}{1-\frac12 z^{-1}}$$
则
$$x[0]=\lim_{z\to\infty}\frac{2}{1-\frac12 z^{-1}}=2$$

### 5.2 终值定理（更容易翻车）
若 $\lim_{n\to\infty}x[n]$ 存在，并且满足稳定相关条件（避免单位圆上不合规极点），则
$$\lim_{n\to\infty}x[n]=\lim_{z\to 1}(1-z^{-1})X(z)$$

**常见不适用：发散序列（如 $2^n u[n]$）或持续振荡（如 $\cos(\omega n)$），因为极限不存在。

---

## 6. 逆 Z 变换（期末大题核心）

### 6.1 三种方法与优先级
1) 识别/查表（最快）  
2) 部分分式展开（最常考）  
3) 幂级数展开（理解 ROC，偶尔用）

### 6.2 识别法：母式 + ROC
看到
$$\frac{1}{1-a z^{-1}}$$
立刻根据 ROC 写：
- $|z|>|a|$：$a^n u[n]$
- $|z|<|a|$：$-a^n u[-n-1]$

### 6.3 部分分式展开（简单极点）
例：
$$X(z)=\frac{1}{(1-\frac12 z^{-1})(1-\frac13 z^{-1})}$$
设
$$X(z)=\frac{A}{1-\frac12 z^{-1}}+\frac{B}{1-\frac13 z^{-1}}$$
可用**遮盖法**快速求系数：
- $A=\left.\frac{1}{1-\frac13 z^{-1}}\right|_{z=\frac12}=3$
- $B=\left.\frac{1}{1-\frac12 z^{-1}}\right|_{z=\frac13}=-2$

因此（若 ROC 在外侧 $|z|>\frac12$）
$$x[n]=3\left(\frac12\right)^n u[n]-2\left(\frac13\right)^n u[n]$$

### 6.4 重根极点（必须补齐阶次）
若出现 $(1-a z^{-1})^2$，展开必须写：
$$\frac{A}{1-a z^{-1}}+\frac{B}{(1-a z^{-1})^2}$$

关键表项（外侧 ROC）：
$$\frac{1}{(1-a z^{-1})^2}\leftrightarrow (n+1)a^n u[n]$$





---

## 重根极点的部分分式技巧

> **有重根极点时，用“待定系数 + 求导法（扩展遮盖法）”，  
> 不能再用普通遮盖法。**

### 一、什么叫“重根极点”？

例如：  
$$
X(z)=\frac{1}{(1-a z^{-1})^2}  
$$

这里：

- 极点 (z=a)
    
- **二重极点**
    

再如：  
$$
\frac{1}{(1-a z^{-1})^3}  
$$
是三重极点。

📌 **判断标准**：  
分母中有 $((1-a z^{-1})^k,\ k\ge 2)$。

### 二、展开形式（必须会写）

以二重极点为例：

$$
\boxed{  
\frac{1}{(1-a z^{-1})^2}

\frac{A}{1-a z^{-1}}  
+  
\frac{B}{(1-a z^{-1})^2}  
}  
$$

⚠️ 注意：

- **不能只写一项**
- 次数必须“补齐”

### 三、快速求系数的技巧（扩展遮盖法 / 求导法）

 核心思想（一句话）

> **重根时，先乘上最高次因子，再对剩余表达式求导后代极点。**

### 二重极点的标准公式（考试可用）

设：  
$$
X(z)=\frac{N(z)}{(z-a)^2}  
$$

则：

- 二次项系数：  
    $$
    \boxed{  
    B=\lim_{z\to a}(z-a)^2 X(z)  
    }  
    $$
    
- 一次项系数：  
    $$
    \boxed{  
    A=\left.\frac{d}{dz}\big[(z-a)^2 X(z)\big]\right|_{z=a}  
    }  
    $$
    

📌 在 Z 变换里，(z-a) 对应 (1-a z^{-1})，本质完全一样。

### 四、期末最典型例题（一步不跳）

 **例题 1（必考型）**

$$
X(z)=\frac{1}{(1-\frac12 z^{-1})^2}  
$$

#### 第 1 步：写展开形式

$$ 
X(z)=\frac{A}{1-\frac12 z^{-1}}+\frac{B}{(1-\frac12 z^{-1})^2}  
$$


#### 第 2 步：先求 (B)

$$
B=\lim_{z\to \frac12}  
(1-\tfrac12 z^{-1})^2 X(z)  
$$

但这里：  
$$
(1-\tfrac12 z^{-1})^2 X(z)=1  
$$

所以：  
$$
\boxed{B=1}  
$$

#### 第 3 步：求 (A)（关键）

对上式求导（对 $(z^{-1})$ 或 $(z)$，教材略有差异，结果一致）：

更简单的**考试技巧**：
👉 **用代数法反推**（比求导稳）

 **假设：**  
$$
\frac{1}{(1-\frac12 z^{-1})^2}

\frac{A}{1-\frac12 z^{-1}}+\frac{1}{(1-\frac12 z^{-1})^2}  
$$

移项：  
$$ 
\frac{1-A(1-\frac12 z^{-1})-1}{(1-\frac12 z^{-1})^2}=0  
$$

对任意 (z) 成立 ⇒  $A=0$
### 最终结果

$$
\boxed{  
\frac{1}{(1-\frac12 z^{-1})^2}

\frac{1}{(1-\frac12 z^{-1})^2}  
}  
$$

也就是说：  
**没有一阶项，全在二阶项上**（这在纯平方分母时很常见）。

### 五、对应的逆 Z 变换（你只要记一个）

这是一个**非常重要的结论**：

$$
\boxed{  
\frac{1}{(1-a z^{-1})^2}  
;\xleftrightarrow{Z};  
(n+1)a^n u[n]  
\quad (\text{ROC }|z|>|a|)  
}  
$$

📌 这是期末 **直接给分的表项**。


### 六、再看一个“混合型”例子（最像期末）

$$
X(z)=\frac{1+z^{-1}}{(1-\frac12 z^{-1})^2}  
$$

#### 第 1 步：设

$$
X(z)=\frac{A}{1-\frac12 z^{-1}}+\frac{B}{(1-\frac12 z^{-1})^2}  
$$

#### 第 2 步：通分对比（最快）

$$
1+z^{-1}=A(1-\tfrac12 z^{-1})+B  
$$

比较常数项与 (z^{-1}) 项：  
$$
\begin{cases}  
A+B=1 \  
-\tfrac12 A=1  
\end{cases}  
\Rightarrow  
A=-2,\ B=3  
$$

---

#### 第 3 步：写时域（ROC 在外）

$$
\boxed{  
x[n]=-2\left(\tfrac12\right)^n u[n]  
+3(n+1)\left(\tfrac12\right)^n u[n]  
}  
$$


### 七、期末记忆版总结（你可以直接背）

> - 重根极点 ⇒ 展开时要补齐阶次
> - 普通遮盖法 ❌
> - 用待定系数 / 求导法
> -$((1-a z^{-1})^{-2} \leftrightarrow (n+1)a^n u[n])$

---
## 7. 离散 LTI 系统与系统函数 $H(z)$

### 7.1 系统函数的定义
在零初始条件下：
$$H(z)=\frac{Y(z)}{X(z)}=Z\{h[n]\}$$

### 7.2 从差分方程到 $H(z)$（必会模板）
例：
$$y[n]-0.5y[n-1]=x[n]$$
取 Z 变换：
$$Y(z)-0.5 z^{-1}Y(z)=X(z)$$
整理：
$$H(z)=\frac{Y(z)}{X(z)}=\frac{1}{1-0.5 z^{-1}}$$

### 7.3 因果性与稳定性（ROC 视角）
- 因果（右边 $h[n]$）：ROC 在最外侧（包含 $\infty$）
- 稳定（BIBO）：ROC 必须包含单位圆 $|z|=1$
- **因果 + 稳定 ⇒ 所有极点都在单位圆内**

---

## 8. 极点零点与频率响应（看图就能判）

### 8.1 频率响应
$$H(e^{j\omega})=H(z)\big|_{z=e^{j\omega}}$$

### 8.2 “距离乘积”公式（极零图直觉的来源）
若 $H(z)=K\frac{\prod(z-z_k)}{\prod(z-p_m)}$，则在单位圆上
$$|H(e^{j\omega})|=|K|\frac{\prod|e^{j\omega}-z_k|}{\prod|e^{j\omega}-p_m|}$$

结论（必背）：
- 单位圆点靠近**零点** → 分子变小 → **幅度下降/陷波**
- 单位圆点靠近**极点** → 分母变小 → **幅度上升/共振峰**
- **角度**决定影响发生在哪个频率（$\omega$），**半径**决定影响强弱（越靠近单位圆越强）

### 8.3 快速判断低通/高通（考试稳法）
计算端点：
- $\omega=0 \Rightarrow z=1$
- $\omega=\pi \Rightarrow z=-1$

比较 $|H(1)|$ 与 $|H(-1)|$：
- 若 $|H(1)|\gg |H(-1)|$：低通倾向
- 若 $|H(1)|\ll |H(-1)|$：高通倾向

### 8.4 经典二阶陷波结构（你学过的那题）
$$H(z)=\frac{1-2\cos(\omega_0)z^{-1}+z^{-2}}{1-2r\cos(\omega_0)z^{-1}+r^2 z^{-2}},\quad 0<r<1$$
- 零点：$z=e^{\pm j\omega_0}$（单位圆上）→ $\omega_0$ 处陷波（幅度为 0）
- 极点：$z=r e^{\pm j\omega_0}$（同角度，单位圆内）→ 控制陷波带宽  
  $r\to 1^-$：陷波更窄更尖

---

## 9. FIR 与线性相位（期末必考）

### 9.1 FIR / IIR 区分
- FIR：冲激响应有限长；$H(z)$ 分母为 1（或只有原点极点对应纯延迟）
- IIR：冲激响应无限长；分母非 1（有非零极点）

### 9.2 线性相位条件（严格线性相位）
FIR 且冲激响应满足对称/反对称：
- 对称：$h[n]=h[N-n]$
- 反对称：$h[n]=-h[N-n]$

则频率响应可写为
$$H(e^{j\omega})=e^{-j\omega N/2}A(\omega)$$
因此相位为线性：
$$\angle H(e^{j\omega})=-\omega N/2$$

### 9.3 群延迟（最易错点）
长度 $L$ 与阶数 $N$：
$$N=L-1$$
群延迟：
$$\tau=\frac{N}{2}=\frac{L-1}{2}$$
- 若 $L$ 为奇数 → $\tau$ 为整数
- 若 $L$ 为偶数 → $\tau$ 为半整数

---

## 10. FIR 设计：窗函数法（Window Method）（期末终章）

### 10.1 为什么需要窗函数
理想滤波器的冲激响应 $h_d[n]$ 通常是无限长（例如 sinc），不可实现。  
窗函数法：
$$h[n]=h_d[n]\cdot w[n]$$
时域相乘 ⇔ 频域卷积 → 引入过渡带与旁瓣。

### 10.2 主瓣与旁瓣的权衡（必背）
- 主瓣宽度：决定过渡带宽（越窄越“陡”）
- 旁瓣高度：决定阻带衰减（越低越“干净”）

**不能同时做到主瓣最窄且旁瓣最低**：这是窗法固有权衡。

### 10.3 常见窗函数（会选 + 会写理由）
- 矩形窗：主瓣最窄，但旁瓣高（阻带差）
- Hamming 窗：综合折衷好（常用默认选择）
- Blackman 窗：旁瓣更低（阻带更干净）但主瓣更宽（过渡带更宽）

### 10.4 设计步骤（低通为例）
1) 选指标：截止频率 $\omega_c$、长度 $L$（或阶数 $N$）  
2) 写理想频响 $H_d(e^{j\omega})$  
3) 得到理想冲激响应 $h_d[n]$（常见为 sinc 形式，中心对齐 $n=N/2$）  
4) 选窗 $w[n]$（通常对称）  
5) $h[n]=h_d[n]w[n]$（对称 → 线性相位）  
6) 写一句“理由”：选窗是为了控制旁瓣/主瓣权衡

### 10.5 长度增加的影响（常考判断题）
增加 $L$（同一种窗）通常：
- 主瓣变窄（过渡带变窄）
- 旁瓣高度主要由窗类型决定（不随 $L$ 大幅改变），但旁瓣“更密”

---

## 11. 期末做题清单（照着检查不丢分）

### 11.1 计算题（Z 变换 / 逆 Z）
- 是否写了 ROC？
- 是否把 $z^{+n}$ 和 $z^{-n}$ 写反？
- 是否时移方向正确（$x[n-n_0]\leftrightarrow z^{-n_0}X(z)$）？
- 逆 Z 时是否用 ROC 判右/左序列？

### 11.2 系统题（差分方程 / 系统函数）
- 是否明确“零初始条件”？
- 是否正确得到 $H(z)=Y/X$？
- 因果/稳定判断是否用 ROC 与单位圆？

### 11.3 极零图与滤波类型
- 记住 $z=1\leftrightarrow\omega=0$，$z=-1\leftrightarrow\omega=\pi$
- 靠近零点抑制、靠近极点增强
- 单位圆上零点 → 对应频率幅度为 0（陷波）

---

## 12. 高频错误合集（你要刻意避免）
1) 忘写 ROC  
2) 把 $\delta[n-2]$ 写成 $z^{+2}$（应为 $z^{-2}$）  
3) 把群延迟写成 $L/2$（应为 $(L-1)/2$）  
4) 把因果稳定判据混用：**稳定看单位圆、因果看 ROC 外侧**  
5) 终值定理对发散/振荡序列硬用

---
