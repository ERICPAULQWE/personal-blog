## —— Z 变换 · ROC · 逆 Z · 离散 LTI 系统 · 极点零点 · 频响 · FIR 线性相位 · 窗函数法

> **使用方式（强烈建议）**  
> 1) 第一次通读：按目录顺序看，建立结构  
> 2) 第二次刷题：只看【典型例题】与【易错点】  
> 3) 考前 1 天：只看【保命清单】+ 每章【速记卡片】  
>
> 记号约定：序列 $x[n]$；Z 变换 $X(z)$；频响 $H(e^{j\omega})$（单位圆 $z=e^{j\omega}$）；默认“零初始条件”。

---
## 目录
- [第 1 章 Z 变换与 ROC](#第-1-章-z-变换与-roc)
- [第 2 章 常用 Z 变换对与快速计算](#第-2-章-常用-z-变换对与快速计算)
- [第 3 章 Z 变换性质（刷题加速器）](#第-3-章-z-变换性质刷题加速器)
- [第 4 章 初值定理与终值定理](#第-4-章-初值定理与终值定理)
- [第 5 章 逆 Z 变换（查表/部分分式/重根）](#第-5-章-逆-z-变换查表部分分式重根)
- [第 6 章 离散 LTI 系统与系统函数 $H(z)$](#第-6-章-离散-lti-系统与系统函数-hz)
- [第 7 章 极点零点与频率响应（幅频直觉）](#第-7-章-极点零点与频率响应幅频直觉)
- [第 8 章 二阶陷波器结构（$r,\omega_0$）](#第-8-章-二阶陷波器结构-romega_0)
- [第 9 章 FIR 线性相位与群延迟](#第-9-章-fir-线性相位与群延迟)
- [第 10 章 窗函数法设计 FIR（会选窗会写理由）](#第-10-章-窗函数法设计-fir会选窗会写理由)
- [期末保命清单（10 条）](#期末保命清单10-条)
- [附：期末题型“下笔模板”](#附期末题型下笔模板)

---

# 第 1 章 Z 变换与 ROC

## 1.1 Z 变换定义（双边）
$$
X(z)=\sum_{n=-\infty}^{\infty} x[n]\,z^{-n}
$$

**为什么是 $z^{-n}$（考试一句话）**：  
采用 $z^{-n}$ 使得**时移**在 Z 域对应简单乘法（$x[n-n_0]\leftrightarrow z^{-n_0}X(z)$），从而差分方程可化为代数方程。

## 1.2 ROC（收敛域）定义与地位
ROC = 使级数
$$
\sum_{n=-\infty}^{\infty} x[n]z^{-n}
$$
收敛的 $z$ 的集合。

> **高频扣分点**：写 Z 变换时若不写 ROC，很多题无法唯一确定 $x[n]$，会扣分或判不完整。

## 1.3 ROC 三条铁律（必背）
1) **ROC 不包含任何极点**  
2) 右边序列（因果/右支撑）→ ROC 在外侧（包含 $\infty$）  
3) 左边序列（反因果/左支撑）→ ROC 在内侧（包含 $0$）  
4) 双边序列 → ROC 是环形区域

## 1.4 典型例题：同一个 $X(z)$，不同 ROC
已知
$$
X(z)=\frac{1}{1-\frac12 z^{-1}}
$$

- 若 ROC：$|z|>\frac12$（外侧）  
  $$
  x[n]=\left(\frac12\right)^n u[n]
  $$

- 若 ROC：$|z|<\frac12$（内侧）  
  $$
  x[n]=-\left(\frac12\right)^n u[-n-1]
  $$

**考试点评**：此题核心不是算式，而是“ROC 决定序列方向”。

## 1.5 易错点清单
- 把 $z^{-n}$ 写成 $z^n$  
- 把 $\delta[n-2]$ 对应写成 $z^{+2}$（应为 $z^{-2}$）  
- 只写 $X(z)$ 不写 ROC（无限长序列必扣）

## 1.6 自检练习（写结论即可）
1) ROC 为 $|z|>2$ 的序列属于右边/左边/双边？  
2) ROC 为 $0.5<|z|<2$ 属于哪类？  
3) 为什么 ROC 不能包含极点？

---

# 第 2 章 常用 Z 变换对与快速计算

> 这一章决定你计算题能否“看到就写”。

## 2.1 冲激与移位冲激
- $\delta[n]\leftrightarrow 1$  
- $\delta[n-n_0]\leftrightarrow z^{-n_0}$

推导（写一行就够）：
$$
\sum_{n=-\infty}^{\infty}\delta[n-n_0]z^{-n}=z^{-n_0}
$$

## 2.2 阶跃
$$
u[n]\leftrightarrow \frac{1}{1-z^{-1}},\quad \text{ROC: }|z|>1
$$

**推导骨架（期末常见）**：
$$
\sum_{n=0}^{\infty}z^{-n}=\frac{1}{1-z^{-1}},\quad |z|>1
$$

## 2.3 右边指数（最常考母式）
$$
a^n u[n]\leftrightarrow \frac{1}{1-a z^{-1}},\quad \text{ROC: }|z|>|a|
$$

## 2.4 左边指数（陷阱）
$$
-a^n u[-n-1]\leftrightarrow \frac{1}{1-a z^{-1}},\quad \text{ROC: }|z|<|a|
$$

## 2.5 有限长矩形序列（构造题神器）
$$
u[n]-u[n-N]\leftrightarrow \frac{1-z^{-N}}{1-z^{-1}}
$$

## 2.6 速记卡片（考前背这 5 行）
- $\delta[n]\leftrightarrow 1$  
- $\delta[n-n_0]\leftrightarrow z^{-n_0}$  
- $u[n]\leftrightarrow \frac{1}{1-z^{-1}},\ |z|>1$  
- $a^n u[n]\leftrightarrow \frac{1}{1-a z^{-1}},\ |z|>|a|$  
- 同一个 $\frac{1}{1-a z^{-1}}$：ROC 外 → 右边；ROC 内 → 左边

---

# 第 3 章 Z 变换性质（刷题加速器）


## 3.1 线性
$$
a x_1[n]+b x_2[n]\leftrightarrow aX_1(z)+bX_2(z)
$$



## 3.2 时移（超级常考）
$$
x[n-n_0]\leftrightarrow z^{-n_0}X(z)
$$

典型对偶：
$$
\frac{z^{-1}}{1-a z^{-1}}\leftrightarrow a^{n-1}u[n-1]
$$

## 3.3 指数加权（变量代换）
$$
a^n x[n]\leftrightarrow X\!\left(\frac{z}{a}\right)
$$

**它是什么意思（必须会说）**：把 $X(z)$ 里所有 $z$ 替换为 $z/a$。不是乘 $a$，不是 $X(az)$。

## 3.4 卷积定理（系统题核心）
若 $y[n]=x[n]*h[n]$，则
$$
Y(z)=X(z)H(z)
$$

## 3.5 典型例题：快速算 $u[n-2]$ 的 Z 变换
$$
u[n]\leftrightarrow \frac{1}{1-z^{-1}},\ |z|>1
$$
时移 2：
$$
u[n-2]\leftrightarrow z^{-2}\frac{1}{1-z^{-1}},\ |z|>1
$$

---

# 第 4 章 初值定理与终值定理

## 4.1 初值定理（常用且稳）
$$
x[0]=\lim_{z\to\infty}X(z)
$$

例：
$$
X(z)=\frac{2}{1-\frac12 z^{-1}}
\Rightarrow x[0]=2
$$

## 4.2 终值定理（必须先检查条件）
若 $\lim_{n\to\infty}x[n]$ 存在，并满足稳定相关条件，则
$$
\lim_{n\to\infty}x[n]=\lim_{z\to 1}(1-z^{-1})X(z)
$$

**不适用的两类常见情况**：
- 发散：$2^n u[n]$（极限不存在）
- 持续振荡：$\cos(\omega n)$（极限不存在）

---

# 第 5 章 逆 Z 变换（查表/部分分式/重根）

## 5.1 三种方法（优先级）
1) 识别/查表（最快）  
2) 部分分式展开（最常考）  
3) 幂级数（理解 ROC）

## 5.2 识别法：母式 + ROC
看到
$$
\frac{1}{1-a z^{-1}}
$$
立刻写：
- $|z|>|a|$：$a^n u[n]$  
- $|z|<|a|$：$-a^n u[-n-1]$

## 5.3 部分分式：简单极点（遮盖法）
例：
$$
X(z)=\frac{1}{(1-0.5z^{-1})(1-0.2z^{-1})},\quad |z|>0.5
$$
设
$$
X(z)=\frac{A}{1-0.5z^{-1}}+\frac{B}{1-0.2z^{-1}}
$$
遮盖法：
$$
A=\left.\frac{1}{1-0.2z^{-1}}\right|_{z=0.5}=\frac{1}{1-0.2/0.5}=\frac{5}{3}
$$
$$
B=\left.\frac{1}{1-0.5z^{-1}}\right|_{z=0.2}=\frac{1}{1-0.5/0.2}=-\frac{2}{3}
$$
逆 Z（外侧 ROC → 右边序列）：
$$
x[n]=\frac{5}{3}(0.5)^n u[n]-\frac{2}{3}(0.2)^n u[n]
$$

## 5.4 重根极点（必须补齐阶次）
关键表项：
$$
\frac{1}{(1-a z^{-1})^2}\leftrightarrow (n+1)a^n u[n]\quad (|z|>|a|)
$$

例：
$$
X(z)=\frac{1}{(1-0.5z^{-1})^2},\ |z|>0.5
\Rightarrow x[n]=(n+1)(0.5)^n u[n]
$$

---

# 第 6 章 离散 LTI 系统与系统函数 $H(z)$

## 6.1 系统函数定义
零初始条件下：
$$
H(z)=\frac{Y(z)}{X(z)}=Z\{h[n]\}
$$

## 6.2 差分方程 → $H(z)$（必会模板）
例：
$$
y[n]-0.7y[n-1]=x[n]
$$
取 Z 变换并整理：
$$
Y(z)(1-0.7z^{-1})=X(z)
\Rightarrow H(z)=\frac{1}{1-0.7z^{-1}}
$$


## 6.3 因果性与稳定性（判分点）
- 因果：ROC 在最外侧（包含 $\infty$）  
- 稳定（BIBO）：ROC 包含单位圆 $|z|=1$  
- 因果 + 稳定：所有极点在单位圆内

# 第 7 章 极点零点与频率响应（幅频直觉）

## 7.1 频率响应定义
$$
H(e^{j\omega})=H(z)\big|_{z=e^{j\omega}}
$$

---

## 7.2 幅度的“距离乘积”公式（看图秒判的根）
若 $z_k$ 为零点，$p_m$ 为极点：
$$
|H(e^{j\omega})|=|K|\frac{\prod_k |e^{j\omega}-z_k|}{\prod_m |e^{j\omega}-p_m|}
$$

**四条铁律**：  
1) 单位圆靠近零点 → 幅度下降（抑制/陷波）  
2) 单位圆靠近极点 → 幅度上升（共振/尖峰）  
3) 角度决定影响频率（$\omega$）  
4) 半径决定强弱（越贴近单位圆越强）

---

## 7.3 低通/高通的稳妥判断法（端点法）
- $\omega=0\Rightarrow z=1$  
- $\omega=\pi\Rightarrow z=-1$

比较 $|H(1)|$ 与 $|H(-1)|$：
- $|H(1)|\gg |H(-1)|$：低通倾向  
- $|H(1)|\ll |H(-1)|$：高通倾向

---

# 第 8 章 二阶陷波器结构 ($r,\omega_0$)

$$
H(z)=\frac{1-2\cos(\omega_0)z^{-1}+z^{-2}}{1-2r\cos(\omega_0)z^{-1}+r^2 z^{-2}},\quad 0<r<1
$$

- 分子因式分解：
  $$
  (1-e^{j\omega_0}z^{-1})(1-e^{-j\omega_0}z^{-1})
  $$
  零点：$z=e^{\pm j\omega_0}$（单位圆上）→ $\omega_0$ 处幅度为 0

- 分母因式分解：
  $$
  (1-re^{j\omega_0}z^{-1})(1-re^{-j\omega_0}z^{-1})
  $$
  极点：$z=re^{\pm j\omega_0}$（同角度，单位圆内）

**参数意义**：$r\to 1^-$ 时陷波越窄越尖（Q 值大）。

---

# 第 9 章 FIR 线性相位与群延迟

## 9.1 FIR vs IIR
- FIR：冲激响应有限长；$H(z)$ 分母为 1（或仅原点极点对应纯延时）  
- IIR：冲激响应无限长；分母非 1（有非零极点）

---

## 9.2 线性相位条件（严格线性相位）
FIR 且：
- 对称：$h[n]=h[N-n]$  
- 反对称：$h[n]=-h[N-n]$

则：
$$
H(e^{j\omega})=e^{-j\omega N/2}A(\omega)
\Rightarrow \angle H(e^{j\omega})=-\omega N/2
$$

---

## 9.3 群延迟（最易错）
长度 $L$ 与阶数 $N$：
$$
N=L-1
$$
群延迟：
$$
\tau=\frac{N}{2}=\frac{L-1}{2}
$$
- $L$ 奇数 → $\tau$ 整数  
- $L$ 偶数 → $\tau$ 半整数

---

# 第 10 章 窗函数法设计 FIR（会选窗会写理由）

## 10.1 核心思想
理想滤波器的冲激响应通常无限长（如 sinc），不可实现。  
窗函数法：
$$
h[n]=h_d[n]\cdot w[n]
$$
时域相乘 ⇔ 频域卷积 → 出现过渡带与旁瓣。

---

## 10.2 主瓣/旁瓣权衡（必背）
- 主瓣宽度：决定过渡带宽（越窄越陡）  
- 旁瓣高度：决定阻带衰减（越低越干净）

**不能同时最窄主瓣+最低旁瓣**，必须折衷。

---

## 10.3 常见窗与写理由模板
- 矩形窗：主瓣窄但旁瓣高（阻带差）  
- Hamming：综合折衷好（通用首选）  
- Blackman：旁瓣更低（阻带更干净）但主瓣更宽（过渡带更宽）

**考试理由句（可直接抄）**：  
“选择 Hamming 窗是因为其在主瓣宽度与旁瓣衰减之间折衷较好，适合一般滤波需求。”

---

## 10.4 长度 $L$ 增加的影响（判断题常考）
同一种窗下，增加 $L$：
- 主瓣变窄（过渡带变窄）  
- 旁瓣高度主要由窗类型决定（不随 $L$ 大幅改变），但旁瓣更密

---

# 期末保命清单（10 条）
1) **写 Z 变换必须写 ROC**（无限长序列尤其）  
2) 逆 Z 必须结合 ROC 判右/左序列  
3) $\delta[n-n_0]\leftrightarrow z^{-n_0}$（别写反号）  
4) 时移：$x[n-n_0]\leftrightarrow z^{-n_0}X(z)$（减号向右）  
5) 稳定看：ROC 是否包含单位圆  
6) 因果看：ROC 是否在最外侧（含 $\infty$）  
7) $z=1\leftrightarrow \omega=0$，$z=-1\leftrightarrow \omega=\pi$  
8) 单位圆零点 → 对应频点幅度为 0（陷波）  
9) 极点靠近单位圆 → 对应频点出现峰（越近越尖）  
10) 群延迟 $\tau=\frac{L-1}{2}$，不是 $L/2$

---

# 附：期末题型“下笔模板”

## A. 求 Z 变换（给出 ROC）
1) 写定义或套表  
2) 写出 $X(z)$  
3) **写 ROC**（右边：外侧；左边：内侧；双边：环形）

## B. 求逆 Z（给出 ROC）
1) 先做部分分式  
2) 每一项匹配母式 $\frac{1}{1-a z^{-1}}$ 或重根项  
3) 用 ROC 决定 $u[n]$ 还是 $u[-n-1]$

## C. 差分方程 → $H(z)$ → 因果/稳定
1) Z 变换，写 $z^{-1}Y(z)$  
2) 提取 $Y(z)$ 得 $H(z)=Y/X$  
3) 找极点，结合因果/稳定给 ROC

## D. 极零图 → 判断滤波类型
1) 看 $z=1$（低频）与 $z=-1$（高频）  
2) 零点压低，极点增强  
3) 必要时算 $|H(1)|,|H(-1)|$ 作稳妥结论

---

